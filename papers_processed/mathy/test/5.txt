GaussianProcessOptimizationintheBanditSetting:NoRegretandExperimentalDesignNiranjanSrinivasCaliforniaInstituteofTechnologyniranjan@caltech.eduAndreasKrauseCaliforniaInstituteofTechnologykrausea@caltech.eduShamM.KakadeUniversityofPennsylvaniaskakade@wharton.upenn.eduMatthiasSeegerSaarlandUniversitymseeger@mmci.uni-saarland.deAbstractManyapplicationsrequireoptimizinganun-known,noisyfunctionthatisexpensivetoevaluate.Weformalizethistaskasamulti-armedbanditproblem,wherethepayofffunctioniseithersampledfromaGaussianprocess(GP)orhaslowRKHSnorm.Weresolvetheimpor-tantopenproblemofderivingregretboundsforthissetting,whichimplynovelconvergenceratesforGPoptimization.WeanalyzeGP-UCB,anintuitiveupper-confidencebasedalgorithm,andbounditscumulativeregretintermsofmaximalinformationgain,establishinganovelconnectionbetweenGPoptimizationandexperimentalde-sign.Moreover,byboundingthelatterintermsofoperatorspectra,weobtainexplicitsublinearregretboundsformanycommonlyusedcovari-ancefunctions.Insomeimportantcases,ourboundshavesurprisinglyweakdependenceonthedimensionality.Inourexperimentsonrealsensordata,GP-UCBcomparesfavorably(alsoseeAuer2002;Danietal.2007;Abernethyetal.2008;Rusmevichientong&Tsitsiklis2008),explicitlydependentonthedimensionality.IntheGPsetting,thechallengeistocharacterizecomplexityinadiffer-entmanner,throughpropertiesofthe2.1.GaussianProcessesandRKHSâ€™sGaussianProcesses.Someassumptionsonfarerequiredtoguaranteeno-regret.Whilerigidparamet-ricassumptionssuchaslinearitymaynotholdinprac-tice,acertaindegreeofsmoothnessisoftenwarranted.Inourtionoptimization.Forthelatter,weonlyneedtoiden-tifypointsxwheref(x)islarge,inordertoconcen-tratesamplingthereasrapidlyaspossible,thusexploitourknowledgeaboutmaxima.Infact,theEDrule010203040010203040152025Temperature(C)(a)Temperaturedataâˆ’6âˆ’4âˆ’20246âˆ’5âˆ’4âˆ’3âˆ’2âˆ’1012345(b)Iterationtâˆ’6fromaGPpriorandthatthenoiseisN(0,Ïƒ2)withknownvarianceÏƒ2.WenowanalyzeGP-UCBinanagnosticsetting,wherefisanarbitraryfunctionfromtheRKHScorrespondingtokernelk(x,x0).Moreover,weallowthenoisevariablesÎµttobeanar-bitrarymartingaledifferencesequence(meaningthatE[Îµt|Îµ<t]=0foralltâˆˆN),uniformlyboundedbyÏƒ.NotethatwestillrunthesameGP-UCBalgorithm,whosepriorandnoisemodelaremisspecifiedinthiscase.OurfollowingresultshowsthatGP-UCBattainssublinearregretevenintheagnosticsetting.Theorem3LetÎ´âˆˆ(0,1).AssumethatthetrueunderlyingfliesintheRKHSHk(D)correspondingtothekernelk(x,x0),andthatthenoiseÎµthaszeromeanconditionedonthehistoryandisboundedbyÏƒalmostsurely.Inparticular,assumekfk2kâ‰¤BandletÎ²t=2B+300Î³t5101520051015EigenvaluerankEigenvalueIndependentMatern(Î½=2.5)SquaredexponentialLinear(d=4)1020304050050100150200250TBoundonÎ³TLinear(d=4)IndependentMaternSquaredexponentialFigure3.Spectraldecay(left)andinformationgainbound(right)forindependent(diagonal),linear,squaredexponentialandMateÌrnkernels(Î½=2.5.)withequaltrace.Finitedimensionallinearkernelshavetheformk(x,x0)=xTx0.GPswith00.20.40.60.81âˆ’4âˆ’20246(a)BayesianLinearRegression00.20.40.60.81âˆ’2âˆ’1012(b)SquaredExponential00.20.40.60.81âˆ’2âˆ’101analysisofthemultiarmedbanditproblem.Mach.Learn.,47(2-3):235â€“256,2002.Brochu,E.,Cora,M.,anddeFreitas,N.AtutorialonBayesianoptimizationofexpensivecostfunctions,withapplicationtoactiveusermodelingandhierarchicalre-inforcementlearning.InTR-2009-23,ProofFixtâ‰¥1andxâˆˆD.Conditionedonytâˆ’1=(y1,...,ytâˆ’1),{x1,...,xtâˆ’1}aredeterministic,andf(x)âˆ¼tintheanalysis.Essentially,weusethistoobtainavalidconfidenceintervalonxâˆ—.Thefollowinglemmaprovidesaconfidenceboundforthesesubsets.Lemma5.6PickÎ´âˆˆ(0,1)andsetÎ²t=statesthatifderivativesuptofourthorderexistsfor(x,x0)7â†’k(x,x0),thenfisalmostsurelycon-tinuouslydifferentiable,withâˆ‚f/(âˆ‚xj)distributedasGaussianprocessesagain.Moreover,thereProofWehavethatmin{r,Î±}â‰¤(Î±/log(1+Î±))log(1+r).ThestatementfollowsfromLemma5.3.ThenextlemmaboundsthegrowthofZT.Itisfor-mulatedintermsofnormalizedquantities:eonthestepsizesofourmartingale.|Mt|=2|eÎµt|Etâˆ’1|eÂµtâˆ’1âˆ’ef(xt)|1+eÏƒ2tâˆ’1â‰¤2|eÎµt|Etâˆ’1Î²1/2teÏƒtâˆ’11+eÏƒ2tâˆ’1â‰¤2|eÎµt|Etâˆ’1Î²1/2tmin{eÏƒtâˆ’1,1/2},(12)wherethefirstinequalityfollowsfromthedefinitionofEt.Moreover,r/(1+r2)â‰¤min{r,1/2}forrâ‰¥0.Therefore,|Mt|â‰¤Î²1/2T,since|eÎµt|â‰¤1andÎ²tinnonde-creasing.Next,weboundthesumoftheconditionalvariancesofthemartingale:VT:=XTt=1Var(Mt|M1...Mtâˆ’1)â‰¤XTt=14|eÎµt|2Etâˆ’1Î²tmin{eÏƒ2tâˆ’1,1/4}â‰¤4Î²TXTt=1Etâˆ’1min{eÏƒ2tâˆ’1,1/4}|eÎµt|â‰¤1â‰¤9Î²TÎ³T.Inthelastline,weusedLemma7.1withÎ±=1/4,not-ingthat8Î±/log(1+Î±)â‰¤9.Sincewehaveestablishedthatthesumofconditionalvariances,VT,isalwaysboundedby9Î²TÎ³T,wecanapplyTheorem7withpa-rametersa=Î²T+1/2,b=Î²1/2T+1andv=9Î²TÎ³TtogetPrXTt=1Mtâ‰¥Î²T+1/2=PrXTt=1Mtâ‰¥Î²T+1/2andVTâ‰¤9Î²TÎ³Tâ‰¤expâˆ’(Î²T+1/2)22(9Î²TÎ³T)+23(Î²T+1/2)Î²1/2T+1!=expâˆ’Î²T+172Î³T+43Î²1/2T+1!â‰¤max(expâˆ’Î²T+1144Î³T,expâˆ’3Î²1/2T+18!).NotethatourchoiceofÎ²T+1satisfies:maxn144Î³Tlog(T2/Î´),(8/3)log(T2/Î´)2oâ‰¤Î²T+1.Therefore,thepreviousprobabilityisboundedbyÎ´/T2,whereasthelastinequalityfollowsfromthedef-initionofÎ²T+1.Withafinalapplicationoftheunionbound:PrXTt=1Mtâ‰¥Î²T+1/2forsomeTâ‰¤XTâ‰¥1PrXTt=1Mtâ‰¥Î²T+1/2â‰¤XTâ‰¥2Î´/T2â‰¤Î´(Ï€2/6âˆ’1)â‰¤Î´,completingtheproofofLemma7.3.C.BoundsonInformationGainInthissection,weshowhowtoboundÎ³T,themax-imuminformationgainafterTrounds,forcompactDâŠ‚Rd(assumptionsofTheorem2)andseveralcom-monlyusedcovariancefunctions.Inthissection,weassume4thatk(x,x)=1forallxâˆˆD.Theplanofattackisasfollows.First,wenotethattheargumentofÎ³T,I(yA;fA)isasubmodularfunction,soÎ³Tcanbeboundedbythevalueobtainedbygreedymaximization.Next,weuseadiscretizationDTâŠ‚DwithnT=|DT|=TÏ„withnearestneighbourdistanceo(1),considerthekernelmatrixKDTâˆˆRnTÃ—nT,andboundÎ³Tbyanexpressioninvolvingtheeigenvalues{Î»Ì‚t}ofthismatrix,whichisdonebyafurtherre-laxationofthegreedyprocedure.Finally,weboundthisempiricalexpressionintermsofthekernelopera-toreigenvaluesofkw.r.t.theuniformdistributiononD.AsymptoticexpressionsforthelatterarereviewedinSeegeretal.(2008),whichweplugintoobtainourresults.AkeystepinthisargumentistoensuretheexistenceofadiscretizationDT,forwhichtailsoftheempiricalspectrumcanbeboundedbytailsoftheprocessspectrum.Wewillinvoketheprobabilisticmethodforthat.C.1.GreedyMaximizationandDiscretizationInthissection,wefixTâˆˆNandassumetheexistenceofadiscretizationDTâŠ‚D,nT=|DT|ontheorderofTÏ„,suchthat:âˆ€xâˆˆDâˆƒ[x]TâˆˆDT:kxâˆ’[x]Tk=O(Tâˆ’Ï„/d).(13)WecomebacktothechoiceofDTbelow.WerestricttheinformationgaintosubsetsAâŠ‚DT:Î³ÌƒT=maxAâŠ‚DT,|A|=TI(yA;fA).Ofcourse,Î³ÌƒTâ‰¤Î³T,butwecanboundtheslack.4Withoutlossingenerality.Weusethisassumptionbelowtoensurethatnâˆ’1TtrKDT=Rk(x,x)dx.Ifk(x,x)isnotconstant,thisisapproximatelytruebythelawoflargenumbers,Lemma7.4UndertheassumptionsofTheorem2,theinformationgainFT({xt})=(1/2)log|I+Ïƒâˆ’2K{xt}|isuniformlyLipschitz-continuousineachcomponentxtâˆˆD.ProofTheassumptionsofTheorem2implythatthekernelK(x,x0)iscontinuouslydifferentiable.TheresultfollowsfromthefactthatFT({xt})iscontinuouslydifferentiableinthekernelmatrixK{xt}.Lemma7.5LetDTbeadiscretizationofDsuchthat(13)holds.UndertheassumptionsofTheorem2,wehavethat0â‰¤Î³Tâˆ’Î³ÌƒT=O(T1âˆ’Ï„/d).ProofFixTâˆˆN,andletA={x1,...,xT}beamaximizerforÎ³T.Considerneighbours[xt]TâˆˆDTaccordingto(13),[A]T={[xt]T}.Then,0â‰¤Î³Tâˆ’Î³ÌƒTâ‰¤Î³Tâˆ’I(y[A]T;f[A]T)=FT(A)âˆ’FT([A]T),whereFT({xt})=(1/2)log|I+Ïƒâˆ’2K{xt}|.ByLemma7.4,FTisuniformlyLipschitz-continuousineachcomponent,sothat|Î³Tâˆ’I(y[A]T;f[A]T)|=O(Tmaxtkxtâˆ’[xt]Tk)=O(T1âˆ’Ï„/d)by(13)andthemeanvaluetheorem.WeconcentrateonÎ³ÌƒTinthesequel.LetKDT=[k(x,x0)]x,x0âˆˆDTbethekernelmatrixovertheen-tireDT,andKDT=UÎ›Ì‚UTitseigendecomposi-tion,withÎ»Ì‚1â‰¥Î»Ì‚2â‰¥Â·Â·Â·â‰¥0andU=[u1u2...]orthonormal.Here,ifT>nT,defineÎ»Ì‚t=0fort=nT+1,...,T.InformationgainmaximizationoverafiniteDTcanbedescribedintermsofasim-plelinear-GaussianmodelovertheunknownfâˆˆRnT,withpriorP(f)=N(0,KDT)andlikelihoodpoten-tialsP(yt|f)=N(vTtf,Ïƒ2)withunit-normfeatures,kvtk=1.Withthefollowinglemma,weupper-boundÎ³ÌƒTbywayoftworelaxations.Lemma7.6ForanyTâ‰¥1,wehavethatÎ³ÌƒTâ‰¤1/21âˆ’eâˆ’1maxm1,...,mTXTt=1log(1+Ïƒâˆ’2mtÎ»Ì‚t),subjecttomtâˆˆN,PtmT=T,whereÎ»Ì‚1â‰¥Î»Ì‚2â‰¥...isthespectrumofthekernelmatrixKDT.Here,ifT>nT,thenmt=0fort>nT.ProofAsshownbyKrause&Guestrin(2005),thefunctionF(A)=I(yA;f)issubmodular.Intheparticularcaseconsideredhere,thiscanbeseenasfollows:F(A)=H(yA)âˆ’H(yA|f),wheretheentropyH(yA)isa(not-necessarilymonotonic)submodularfunctioninA,andsincethenoiseisconditionallyindependentgivenf,H(yA|f)isanadditive(modular)functioninA.Subtractingamodularfunctionpreservessubmodularity,thusF(A)issubmodular.Furthermore,theinformationgainismonotonicinA(i.e.,F(A)â‰¤F(B)wheneverAâŠ†B)(Cover&Thomas,1991).Thus,wecanapplytheresultofNemhauseretal.(1978)5whichguaranteesthatÎ³ÌƒTisupper-boundedby1/(1âˆ’1/e)timesthevaluethegreedymaximizationalgorithmattains.Thelatterchoosesfeaturesoftheformvt=Î´xt=[I{x=xt}]ineachround,xtâˆˆDT.Weupper-boundthegreedymaximumoncemorebyrelaxingtheseconstraintstokvtk=1only.Intheremainderoftheproof,weconcentrateonthisrelaxedgreedyprocedure.Supposethatuptoroundt,itchosev1,...,vtâˆ’1.TheposteriorP(f|ytâˆ’1)hasinversecovariancematrixÎ£âˆ’1tâˆ’1=Kâˆ’1DT+Ïƒâˆ’2Vtâˆ’1VTtâˆ’1,Vtâˆ’1=[v1...vtâˆ’1],andthegreedyprocedureselectsvsotomaximizethevariancevTÎ£tâˆ’1v:theeigenvectorcorrespondingtoÎ£tâˆ’1â€™slargesteigenvalue(bytheRayleigh-Ritztheorem).SinceÎ£0=KDT,thenv1=u1.Moreover,ifallvt0,t0<t,havebeenchosenamongUâ€™scolumns,thenbytheinversecovarianceexpressionjustgiven,KDTandÎ£tâˆ’1havethesameeigenvectors,sothatvtisacolumnofUaswell.Forexample,ifvt=uj,thencomparingÎ£tâˆ’1andÎ£t,alleigenvaluesotherthanthej-thremainthesame,whilethelatterisshrunk.Therefore,afterTroundsoftherelaxedgreedyprocedure:vtâˆˆ{u1,...,umin{T,nT}},t=1,...,T:atmosttheleadingTeigenvectorsofKDTcanhavebeenselected(possiblymultipletimes).Ifmtdenotesthenumberthatthet-thcolumnofUhasbeenselected,weob-tainthetheoremstatementbyafinalboundingstep.C.2.FromEmpiricaltoProcessEigenvaluesThefinalstepwillbetorelatetheempiricalspec-trum{Î»Ì‚t}tothekerneloperatorspectrum.Sincelog(1+Ïƒâˆ’2mtÎ»Ì‚t)â‰¤Ïƒâˆ’2mtÎ»Ì‚tinTheorem7.6,wewillmainlybeinterestedinrelatingthetailsumsofthespectra.LetÂµ(x)=V(D)âˆ’1I{xâˆˆD}betheuniformdistributiononD,V(D)=RxâˆˆDdx,andassumethatkiscontinuous.NotethatRk(x,x)Âµ(x)dx=1byourassumptionk(x,x)=1,sothatkisHilbert-5WhiletheresultofNemhauseretal.(1978)isstatedintermsoffinitesets,itextendstoinfinitesetsaslongasthegreedyselectioncanSchmidtonL2(Âµ).Then,Mercerâ€™stheorem(Wahba,1990)statesthatthecorrespondingkerneloperatorhasadiscreteeigenspectrum{(Î»s,Ï†s(Â·))},andk(x,x0)=Xsâ‰¥1Î»sÏ†s(x)Ï†s(x0),whereÎ»1â‰¥Î»2â‰¥Â·Â·Â·â‰¥0,andEÂµ[Ï†s(x)Ï†t(x)]=Î´s,t.Moreover,Psâ‰¥1Î»2s<âˆž,andtheexpan-sionofkconvergesabsolutelyanduniformlyonDÃ—D.NotethatPsâ‰¥1Î»s=Psâ‰¥1Î»sEÂµ[Ï†s(x)2]=RK(x,x)Âµ(x)dx=1.InordertoproceedfromThe-orem7.6,wehavetopickadiscretizationDTforwhich(13)holds,andforwhichPt>Tâˆ—Î»Ì‚tisnotmuchlargerthanPt>Tâˆ—Î»t.Withthefollowinglemma,wedeter-minesizesnTforwhichsuchdiscretizationsexist.Lemma7.7FixTâˆˆN,Î´>0andÎµ>0.ThereexistsadiscretizationDTâŠ‚DofsizenT=V(D)(Îµ/âˆšd)âˆ’d[log(1/Î´)+dlog(âˆšd/Îµ)+logV(D)]whichfulfilsthefollowingrequirements:â€¢Îµ-denseness:ForanyxâˆˆD,thereexists[x]TâˆˆDTsuchthatkxâˆ’[x]Tkâ‰¤Îµ.â€¢Ifspec(KDT)={Î»Ì‚1â‰¥Î»Ì‚2â‰¥...},thenforanyTâˆ—=1,...,nT:nâˆ’1TXTâˆ—t=1Î»Ì‚tâ‰¥XTâˆ—t=1Î»tâˆ’Î´.ProofFirst,ifwedrawnTsamplesxÌƒjâˆ¼Âµ(x)in-dependentlyatrandom,thenDT={xÌƒj}isÎµ-densewithprobabilityâ‰¥1âˆ’Î´.Namely,coverDwithN=V(D)(Îµ/âˆšd)âˆ’dhypercubesofsidelengthÎµ/âˆšd,withinwhichthemaximumEuclideandistanceisÎµ.Theprobabilityofnothittingatleastonecellisupper-boundedbyN(1âˆ’1/N)nT.Sincelog(1âˆ’1/N)â‰¤âˆ’1/N,thisisupper-boundedbyÎ´ifnTâ‰¥Nlog(N/Î´).Now,letS=nâˆ’1TPTâˆ—t=1Î»Ì‚t.Shawe-Tayloretal.(2005)showthatE[S]â‰¥PTâˆ—t=1Î»t.IfCistheevent{DTisÎµâˆ’dense},thenPr(C)â‰¥1âˆ’Î´.SinceSâ‰¤nâˆ’1TtrKDT=1inanycase,wehavethatE[S|C]â‰¥E[S]âˆ’Pr(Cc)â‰¥PTâˆ—t=1Î»tâˆ’Î´.Bytheprobabilisticmethod,theremustexistsomeDTforwhichCandthelatterinequalityholds.Thefollowinglemma,theequivalentofTheorem4inthecontexthere,isadirectconsequenceofLemma7.6.Lemma7.8LetDTbesomediscretizationofD,nT=|DT|.Then,foranyTâˆ—=1,...,min{T,nT}:Î³ÌƒTâ‰¤1/21âˆ’eâˆ’1maxr=1,...,TTâˆ—log(rnT/Ïƒ2)+(Tâˆ’r)Ïƒâˆ’2XnTt=Tâˆ—+1Î»Ì‚t.ProofWesplittherighthandsideinLemma7.6att=Tâˆ—.Letr=Ptâ‰¤Tâˆ—mt.Fortâ‰¤Tâˆ—:log(1+mtÎ»Ì‚t/Ïƒ2)â‰¤log(rnT/Ïƒ2),sinceÎ»Ì‚tâ‰¤nT.Fort>Tâˆ—:log(1+mtÎ»Ì‚t/Ïƒ2)â‰¤mtÎ»Ì‚t/Ïƒ2â‰¤(Tâˆ’r)Î»Ì‚t/Ïƒ2.Thethere,thesamedecayrateholdsforÎ»sw.r.t.uniformÂµ(x),whileconstantsmightchange.Inhindsight,itturnsoutthatÏ„=distheoptimalchoiceforthediscretizationsize,renderingthesecondterminThe-orem5tobeO(1),whichissubdominantandwillbeneglectedinthesequel.WehavethatÎ»sâ‰¤cBs1/dwithB<1.Followingtheiranalysis,Bk(Tâˆ—)â‰¤c(d!)Î±âˆ’deâˆ’Î²Xdâˆ’1j=0(j!)âˆ’1Î²j,whereÎ±=âˆ’logB,Î²=Î±T1/dâˆ—.Therefore,Bk(Tâˆ—)=O(eâˆ’Î²Î²dâˆ’1),Î²=Î±T1/dâˆ—.WehavetopickTâˆ—suchthateâˆ’Î²isnotmuchlargerthan(TnT)âˆ’1.SupposethatTâˆ—=[log(TnT)/Î±]d,sothateâˆ’Î²=(TnT)âˆ’1,Î²=log(TnT).Theboundbe-comesmaxr=1,...,TTâˆ—log(rnT/Ïƒ2)+Ïƒâˆ’2(1âˆ’r/T)(C5Î²dâˆ’1+C4(logT))withnT=C4Td(logT).Thefirstpartdominates,sothatr=TandÎ³T=O([log(Td+1(logT))]d+1)=O((logT)d+1).ThisshouldbecomparedwithE[I(yT;fT)]=O((logT)d+1)givenbySeegeretal.(2008),wherethextaredrawnindependentlyfromaGaussianbasedistribution.AtleastrestrictedtoacompactsetD,weobtainthesameexpressiontoleadingorderformax{xt}I(yT;fT).MateÌrnKernelsForMateÌrnkernelskwithroughnessparameterÎ½,Bk(Tâˆ—)isgivenbySeegeretal.(2008)fortheuni-formbasedistributionÂµ(x)onD.Namely,Î»sâ‰¤csâˆ’(2Î½+d)/dforalmostallsâˆˆN,andBk(Tâˆ—)=O(T1âˆ’(2Î½+d)/dâˆ—).TomatchtermsintheÎ³ÌƒTbound,wechooseTâˆ—=(TnT)d/(2Î½+d)(log(TnT))Îº(Îºchosenbelow),sothattheboundbecomesmaxr=1,...,TTâˆ—log(rnT/Ïƒ2)+Ïƒâˆ’2(1âˆ’r/T)Ã—(C5Tâˆ—(log(TnT))âˆ’Îº(2Î½+d)/d+C4(logT))+O(T1âˆ’Ï„/d)withnT=C4TÏ„(logT).ForÎº=âˆ’d/(2Î½+d),weob-tainthatthemaximumoverrisO(Tâˆ—log(TnT))=O(T(Ï„+1)d/(2Î½+d)(logT)).Finally,wechooseÏ„=2Î½d/(2Î½+d(d+1))tomatchthistermwithO(T1âˆ’Ï„/d).Pluggingthisin,wehaveÎ³T=O(T1âˆ’2Î·(logT)),Î·=Î½2Î½+d(d+1).TogetherwithTheorem2(forÎ½>2),wehavethatRT=Oâˆ—(T1âˆ’Î·)(suppressinglogfac-tors):foranyÎ½>2andanydimensiond,theGP-UCBalgorithmisguaranteedtobeno-regretinthiscasewitharbitrarilyhighprobability.HowdoesthisboundcomparetotheboundonE[I(yT;fT)]givenbySeegeretal.(2008)?Here,Î³T=O(Td(d+1)/(2Î½+d(d+1))(logT)),whileE[I(yT;fT)]=O(Td/(2Î½+d)(logT)2Î½/(2Î½+d)).LinearKernelForlinearkernelsk(x,x0)=xTx0,xâˆˆRdwithkxkâ‰¤1,wecanboundÎ³Tdirectly.LetXT=[x1...,xT]âˆˆRdÃ—Twithallkxtkâ‰¤1.Now,log|I+Ïƒâˆ’2XTTXT|=log|I+Ïƒâˆ’2XTXTT|â‰¤log|I+Ïƒâˆ’2D|withD=diagdiagâˆ’1(XTXTT),byHadamardâ€™s