MatrixCompletionfromaFewEntriesRaghunandanH.Keshavan∗,AndreaMontanari∗†,andSewoongOh∗March17,2009AbstractLetMbearandomnα×nmatrixofrankr≪n,andassumeForjustificationoftheseassumptionsandbackgroundontheuseoflowrankmatricesininformationretrieval,wereferto[BDJ99].Sinceweareinterestedinverylargedatasets,weshallfocusonthelimitm,n→∞withm/n=αboundedawayfrom0and∞.WefurtherassumethatthefactorsU,Vareunstructured.ThisnotionisformalizedbytheincoherenceconditionintroducedbyCandésandRecht[CR08],anddefinedinSection2.InparticulartheincoherenceconditionissatisfiedwithhighprobabilityifM=UΣVTwithUandVuniformlyrandommatriceswithUTU=m1andVTV=n1.Alternatively,incoherenceholdsiftheentriesofUandVarei.i.d.boundedrandomvariables.Outofthem×nentriesofM,asubsetE⊆[m]×[n](theuser/moviepairsforwhicharatingisavailable)isrevealed.WeletMEbethem×nmatrixthatcontainstherevealedentriesofM,andisfilledwith0’sintheotherpositionsMEi,j=Mi,jif(i,j)∈E,0otherwise.(2)ThesetEwillbeuniformlyrandomgivenitssize|E|.1.2AlgorithmAnaivealgorithmconsistsofthefollowingprojectionoperation.Projection.Computethesingularvaluedecomposition(SVD)ofME(withσ1≥σ2≥···≥0)ME=min(m,n)Xi=1σixiyTi,(3)andreturnthematrixTr(ME)=(mn/|E|)Pri=1σixiyTiobtainedbysettingto0allbuttherlargestsingularvalues.Noticethat,apartfromtherescalingfactor(mn/|E|),Tr(ME)istheorthogonalprojectionofMEontothesetofrank-rmatrices.TherescalingfactorcompensatesthesmalleraveragesizeoftheentriesofMEwithrespecttoM.Itturnsoutthat,if|E|=Θ(n),thisalgorithmperformsverypoorly.ThereasonisthatthematrixMEcontainscolumnsandrowswithΘ(logn/loglogn)non-zero(revealed)entries.ThelargestsingularvaluesofMEareoforderΘ(plogn/loglogn).Thecorrespondingsingularvectorsarehighlyconcentratedonhigh-weightcolumnorrowindices(respectively,forleftandrightsingularvectors).Suchsingularvectorsareanartifactofthehigh-weightcolumns/rowsanddonotprovideusefulinformationaboutthehiddenentriesofM.Thismotivatesthedefinitionofthefollowingoperation(hereafterthedegreeofacolumnorofarowisthenumberofitsrevealedentries).Trimming.SettozeroallcolumnsinMEwithdegreelargerthat2|E|/n.Setto0allrowswithdegreelargerthan2|E|/m.Figure1showsthesingularvaluedistributionsofMEandfMEforarandomrank-3matrixM.Thesurpriseisthattrimming(whichamountsto‘throwingoutinformation’)makestheunderlyingrank-3structuremuchmoreapparent.Thiseffectbecomesevenmoreimportantwhenthenumberofrevealedentriesperrow/columnfollowsaheavytaildistribution,asforrealdata.Interms0102030405060051015202530354005101520253035404505101520253035σ4σ3σ2squareerrorfromO(nr)revealedentries.WedefinetherelativerootmeansquareerrorasRMSE≡1mnr||M−Tr(fME)||2F1/2.(6)wherewedenoteby||A||FtheFrobeniusnormofmatrixA.Noticethatthefactor(1/mn)correspondstotheusualnormalizationbythenumberofentries.Thefactor(1/r)isinsteadnecessarybecause(asdescribedinSection2),thetypicalsizeoftheentriesofMis√r.Theorem1.1.AssumeMtobearankr≤n1/2matrixthatsatisfiestheincoherenceconditionA2(inparticular,thisisthecaseforrandomorthogonalmatricesU,V).Thenwithhighprobability1mnr||M−Tr(fME)||Inthecaseofcollaborativefiltering,weareinterestedinfindingamatrixMofminimumrankthatmatchestheknownentries{Mij:(i,j)∈E}.Eachknownentrythusprovidesanaffineconstraint.CandèsandRecht[CR08]introducedtheincoherentmodelforM.Withinthismodel,theyprovedthat,ifEisrandom,theconvexrelaxationcorrectlyreconstructsMaslongas|E|≥Crn6/5logn.Ontheotherhand,fromapurelyinformationtheoreticpointof2IncoherencepropertyandsomenotationsThematrixMtobereconstructedtakestheform(1)whereU∈Rm×r,V∈Rn×r.WewriteU=[u1,u2,...,ur]andV=[v1,v2,...,vr]forthecolumnsofthetwofactors,with||ui||=√m,||vi||=√nanduTiuj=0,vTivj=0fori6=j(thereisnolossofgeneralityinthis,sincenormalizationscanbeadsorbedbyredefiningΣ).WeshallfurtherwriteΣ=diag(Σ1,...,Σr)withΣ1≥Σ2≥···≥Σr≥0.ThematricesU,VandΣwillbesaidtobeincoherentiftheysatisfythefollowingproperties:A1.Thereexistsaconstantµ0>0suchthatforalli∈[m],j∈[n]wehavePrk=1U2i,k≤µ0r,Prk=1V2i,k≤µ0r.A2.Thereexistsµ1suchthat|Prk=1Ui,kΣkVj,k|≤µ1r1/2.Apartfromdifferenceinnormalization,theseassumptionscoincidewiththeonesin[CR08].IntheproofofTheorem1.1,weonlyrequirethesecondincoherenceassumptionA2.Inthefollowing,wheneverwewritethatapropertyAholdswithhighprobability(w.h.p.),wemeanthatthereexistsafunctionf(n)=f(n;α,µ1)suchthatP(A)≥1−f(n)andf(n)→0forµ1boundedawayfrom0and∞.Inthecaseofexactcompletion(i.e.intheproofofTheorem1.2)f(·)canalsodependonµ0,Σmin,Σmax,andf(n)→0forµ0,Σmin,Σmaxboundedawayfrom0and∞.ProbabilityistakenwithrespecttotheuniformlyrandomsubsetE⊆[m]×[n].Itisconvenienttoworkwithamodelinwhicheachentryisrevealedindependentlywithprobabilityǫ/√mn.Since,withhighprobability|E|∈[ǫ√αn−A√nlogn,ǫ√αn−A√nlogn],anyguaranteeonthealgorithmperformancesthatholdswithinonemodel,holdswithintheothermodelaswellifweallowforavanishingshiftinǫ.Finally,wewilluseC,C′etc.todenotegenericconstantsthatdependuniquelyonα,µ1and,whenprovingTheorem1.2,µ0,Σmin,Σmax.Givenavectorx∈Rn,||x||willdenoteitsEuclideannorm.ForamatrixX∈Rn×n′,||X||FisitsFrobeniusnorm,and||X||2itsoperatornorm(i.e.||X||2=supu6=0||Xu||/||u||).Thestandardscalarproductbetweenvectorsormatriceswillsometimesbeindicatedbyhx,yiorhX,Yi,respectively.Finally,weusethestandardcombinatoricsnotation[N]={1,2,...,N}todenotethesetoffirstNintegers.3ProofofTheorem1.1andtechnicalresultsAsexplainedintheprevioussection,thecrucialideaistoconsiderthesingularvaluedecompositionofthetrimmedmatrixfMEinsteadoftheoriginalmatrixME,asinEq.(3).Weshallthenredefine{σi},{xi},{yi},bylettingfME=min(m,n)Xi=1σixiyTi.(9)Here||xi||=||yi||=1,xTixj=yTiyj=0fori6=jandσ1≥σ2≥···≥0.WewillproveTheorem1.1bycontrollingtheoperatornormofM−Tr(fME).Theorem3.1.ThereexistsC(α)<∞suchthat,withhighprobability,1√mnM−Tr(fME)2≤CThisresultisprovedlaterinthissection.TheproofofTheorem1.1isadirectapplicationtheofabovetheorem.Proof.(Theorem1.1)SinceM−Tr(fME)hasrankatmost2r,itimmediatelyfollowsthat1√mnrM−Tr(fME)F≤√2r1√mnrM−Tr(fME)2≤Crǫ1/2,whichimpliesthethesis.ToproveTheorem3.1,wewillusefollowingkeytechnicalresults.Lemma3.2.ThereexistsaconstantC>0suchthat,withhighprobabilityxTǫ√mnM−fMEy≤C√rǫ,(11)foranyx∈Rmandy∈Rnsuchthat||x||=||y||=1.TheproofofthislemmaisgiveninSection4.Thenextlemma,whichisadirectconsequenceofLemma3.2,relatesthesingularvaluesofthetrimmedmatrixfUsingEq.(13)withHtheorthogonalcomplementofspan(v1,...,vq−1),wehave,byLemma3.2,σq≤maxy∈H,||y||=1fMEy≤ǫ√mnmaxy∈H,||y||=1My+maxy∈H,||y||=||x||=1xTfME−ǫ√mnMy≤ǫΣq+C√rǫInordertogetalowerbound,weuseEq.(14)withH=span(v1,...,vq).ByLemma3.2wehaveσq≥miny∈H,||y||=1fMEy≥ǫ√mnminy∈H,||y||=1My−maxy∈H,||y||=||x||=1xTfME−ǫ√mnMy≥ǫΣ4.1BoundingthecontributionoflightcouplesLetusdefinethesubsetofrowandcolumnindiceswhichhavenotbeentrimmedasAlandAr:Al={i∈[m]:deg(i)≤2ǫ√ForA=(Al,Ar),letMAbethematrixobtainedfromMbysettingtozerothoseentrieswhoserowindexisnotinAl,andthosewhosecolumnindexnotinAr.DefinethepotentialcontributionofthelightcouplesaijandindependentrandomvariablesZijasaij=(xiMAijyjif|xiMAijyj|≤(rǫ/mn)1/2,0otherwise,Zij=ai,jw.p.ǫ/√mn,0w.p.1−ǫ/√mn,LetZ1=Pi,jZijsothatZ=Z1−ǫ√mnxTMy.NotethatPi,ja2ij≤Pi,jxiMAijyj2≤µ21r.Fixλ=(mn/4rǫ)1/2sothat|λai,j|≤1/2,whenceeλaij−1≤λaij+2(λaij)2.ItthenfollowsthatE[eλZ]=expnǫ√mnXi,jλai,j+2Xi,j(λai,j)2−λǫ√mnxTMyo≤expnλE[Z]+2rǫµ21λ2nα1/2o.ThethesisfollowsbyChernoffboundP(Z>a)≤e−λaE[eλZ]aftersimplecalculus.NotethatP(−Z>L√rǫ)canalsobeboundedanalogously.Wecannowfinishtheupperboundonthelightcouplescontribution.ConsidertheerroreventEq.(16).UsingRemark4.2,wecanapplyunionboundoverTmandTntoEq.(17)toobtainP{H(E,A)}≤220∆n+me−(C1−2µ21−µ1)α1/2n/2+1n3,IfC1isalargeenoughconstant,thefirsttermisofordere−Θ(n)(for,say,ǫ≥r)thusfinishingtheproof.4.2BoundingthecontributionofheavycouplesLetQbeanm×nmatrixwithQijForthereader’sconvenience,aproofofthisfactisproposedinAppendixC.Theanalogousresultin[FO05](fortheadjacencymatrixofanon-bipartitegraph)isprovedtoholdonlywithprobabilitylargerthan1−e−Cǫ.Thestrongerstatementquotedherecanbeprovedusingconcentrationofmeasureinequalities.Thelastremarkimpliesthatforallx∈Tm,y∈TnandforlargeenoughCthecontributionofheavycouplesis,w.h.p.,boundedbyC2√rǫforsomeC2<∞.5MinimizationonGrassmannmanifoldsandproofofTheorem1.2ThefunctionF(X,Y)definedinEq.(4)andtobeminimizedinthelastpartofthealgorithmcannaturallybeviewedasdefinedonGrassmannmanifolds.Herewerecallfrom[EAS99]afewimportantfactsonthegeometryofGrassmannmanifoldandrelatedoptimizationalgorithms.WethenproveTheorem1.2.TechnicalcalculationsaredeferredtosectionSections6,7,andtotheappendices.Werecallthat,fortheproofofTheorem1.2,itisassumedthatΣmin,Σmaxareboundedawayfrom0and∞.Constants(denotedbyC,C′,...)dependimplicitlyonΣmin,Σmax.Finally,throughoutthissection,weusethenotationX(i)∈Rrtorefertothei-throwofthematrixX∈Rm×norX∈Rn×r.5.1GeometryoftheGrassmannmanifoldDenotebyO(d)theorthogonalgroupofd×dmatrices.TheGrassmannmanifoldisdefinedasthequotientG(n,r)≃O(n)/O(r)×O(n−r).Inotherwords,apointinthemanifoldistheequivalenceclassofann×rorthogonalmatrixA[A]={AQ:Q∈O(r)}.(18)Forconsistencywiththerestofthepaper,wewillassumethenormalizationATA=n1.TorepresentapointinG(n,r),wewilluseanexplicitrepresentativeofthisform.Moreabstractly,G(n,r)isthemanifoldofr-dimensionalsubspacesofRn.ItiseasytoseethatF(X,Y)dependsonthematricesX,Yonlythroughtheirequivalenceclasses[X],[Y].WewillthereforeinterpretitasafunctiondefinedonthemanifoldM(m,n)≡G(m,r)×G(n,r):F:M(m,n)→R,(19)([X],[Y])7→F(X,Y).(20)Inthefollowing,apointinthismanifoldwillberepresentedasapairx=(X,Y),withXann×rorthogonalmatrixandYanm×rorthogonalmatrix.BoldfacesymbolswillbereservedforelementsofM(m,n)orofitstangentspace,andweshalluseu=(U,V)forthepointcorrespondingtothematrixM=UΣVTtobereconstructed.Givenx=(X,Y)∈M(m,n),thetangentspaceatxisdenotedbyTxandcanbeidentifiedwiththevectorspaceofmatrixpairsw=(W,Z),W∈Rm×r,Z∈Rn×rsuchthatWTX=ZTY=0.The‘canonical’RiemannmetricontheGrassmannmanifoldcorrespondstotheusualscalarproducthW,W′i≡Tr(WTW′).TheinducedscalarproductonTxbetweenw=(W,Z)andw′=(W′,Z′)ishw,w′i=hW,W′i+hZ,Z′i.ThismetricinducesacanonicalnotionofdistanceonM(m,n)whichwedenotebyd(x1,x2)(geodesicorarc-lengthdistance).Ifxwherethearc-lengthdistancesd(X1,X2),d(Y1,Y2)ontheGrassmannmanifoldcanbedefinedex-plicitlyasfollows.Letcosθ=(cosθ1,...,cosθr),θi∈[−π/2,π/2]bethesingularvaluesofXT1X2/n.Thend(X1,X2)=||θ||2.(22)Theθi’sarecalledthe‘principalangles’betweenthesubspacesspannedbythecolumnsofX1andX2.Itisusefultointroducetwoequivalentnotionsofdistance:dc(X1,X2)=1√nminQ1,Q2∈O(r)||X1Q1−X2Q2||F(chordaldistance),(23)dp(X1,X2)=1√2n||X1XT1−X2XT2||F(projectiondistance).(24)NoticethatdcanddpdonotdependonthespecificrepresentativesX1,X2,butonlyontheequiv-alenceclasses[X1]and[X2].DistancesonM(m,n)aredefinedthroughPythagoreantheorem,e.g.dc(x1,x2)=pdc(X1,X5.3AlgorithmAtthispointthegradientdescentalgorithmisfullyspecified.IttakesasinputthefactorsofTr(fME),tobedenotedasx0=(X0,Y0),andminimizesaregularizedcostfunctioneF(X,Y)=F(X,Y)+ρG(X,Y)(33)≡F(X,Y)+ρmXi=1G1||X(i)||22µ0r!+ρnXj=1(ii)Indeed,thelineminimizationinstruction5(whichmightappearcomplextoimplement)canbereplacedbyastandardstepselectionprocedure,suchastheonein[Arm66].(iii)Similarly,thereisnoneedtoknowtheactualvalueofµ0intheregularizationterm.Onecanstartwithµ0=1andthenrepeattheoptimizationdoublingitateachstep.(iv)TheHessianofFcanbecomputedexplicitlyaswell.Thisopensthewaytoquadraticallyconvergentminimizationalgorithms(e.g.theNewtonmethod).5.4ProofofTheorem1.2TheproofofTheorem1.2breaksdownintwolemmas.Thefirstoneimpliesthat,inasufficientlysmallneighborhoodofu,thefunctionx7→F(x)iswellapproximatedbyaparabola.Lemma5.3.Assumeǫ≥Amax{rlogn,r2}withAlargeenough.ThenthereexistsconstantsC1,C2,δ>0(independentofm,n,ǫandr)suchthat,withhighprobabilityC1nǫd(x,u)2+||S−Σ||2F≤F(x)≤C2nǫd(x,u)2(38)forallx∈M(m,n)∩K(3µ0)suchthatd(x,u)≤δ(whereS∈Rr×risthematrixrealizingtheminimuminEq.(4)).The6ProofofLemma5.3WewillmakeuseofthefollowingLemma.Lemma6.1.Assumeǫ=AlognwithAlargeenough.ThenthereexistsC>0suchthatwithhighprobabilityX(i,j)∈ExiwhereinweusedCauchy-Schwarzinequalitytoarguethat(1/2)(A+B)2≥(A2/4)−B2anddefinedA2≡X(i,j)∈E(U(S−Σ)VT+USZT+WSVT)2ij,B2≡X(i,j)∈E(WSZT)2ij.Wewillshowthat,withhighprobabilityA2≥Cnǫ||S−Σ||2F+Cnǫd(x,u)2andB2≤(C/100)nǫ(1+||S−Σ||2FUpperboundonB.ByLemma6.1wehaveB2≤σmax(S)2Xa,bX(i,j)∈EW2iaZ2jb(47)≤Cǫnσmax(S)2Xi,j||W(i)||2||Z(j)||2+Cσmax(S)2√ǫXa,bXi||W(i)||4!1/2Xj||Z(j)||41/2(48)≤Cǫnσmax(S)2Xi,j||W(i)||2isobtainedintermsofthesingularvaluedecompositionofWandZ.IfweletW=LΘRT,weobtaincW=−URΘsinΘRT+LΘcosΘRT.(52)AnanalogousexpressionholdsforbZ.SinceLTU=0,wehave||cW||2F=n||ΘsinΘ||2F+n||ΘcosΘ||2F=n||θ||2.Hence||bw||2=nd(x,u)2.Inordertoprovethethesis,itisthereforesufficienttoshowthathgradeF(x),bwi≥Cnǫd(x,u)2.InthefollowingwewillindeedshowthathgradF(x),bwi≥Cnǫd(x,u)2,andhgradG(x),bwi≥0.Asapreliminaryremark,wenoticethatbw∈K((3π2/2+96/π2)µ0).Indeed||cW(i)||2≤2||ΘsinΘRTU(i)||2+2||ΘcosΘL(i)||2≤π22||U(i)||2+2||W(i)||2,(53)Byassumptionwehave||U(i)||2≤3µ0randweproved||W(i)||2≤48µ0r/π2intheprevioussection.7.1LowerAnalogously||cW−W||2F=nrXi=a[2θ2a−2θ2acosθa]≤n||θ||4≤nd(u,x)4(65)Thelastinequalityimpliesinparticular||UTcW||F=||UT(W−cW)||F≤nd(u,x)2.(66)SimilarboundsholdofcourseforZ,bZ,Z(forinstancewehave||VTbZ||F≤nd(u,x)2).Finally,weshalluserepeatedlythefactthat||S−Σ||2F≤Cd(x,u)2,whichfollowsfromLemma5.3.Thisinturnsimpliesσmax(S)≤Σmax+Cd(x,u)2,(67)σmin(S)≥Σmin−Cd(x,u)2.(68)WecannowboundthevarioustermsonEq.(54).LowerboundonA.UsingTheorem4.1in[CR08]weobtain,withhighprobabilityforanyξ>0:A≥ǫnh(USZT+WSVInordertoestimatethesecondfactorinEq.(75),wefirstnoticethat||PE(WSbZT+cWSZT)||2F≤2||PE(WSbZT)||2F+2||PE(cWSZT)||2Fandthenboundeachofthetwotermsinthesameway.Con-sider,tobedefinite,thefirstone:||PE(WSbZT)||2F=X(ij)∈E(WSbZT)2ij≤σmax(S)2rXa,b=1X(ij)∈EW2iabZ2jb.AtthispointwecanapplyLemmathesameargumentasafterEq.(47).Boundingσmax(S)2andusingthefactthatbothW,bZ∈K(Cµ0)weget||PE(WSbZT)||2F=Cnǫmax(r/√ǫ,δ2)d(x,u)2.PuttingtogetherEqs.(79)and(80)wefinallygetB1=Cnǫmax(r1/2/ǫ1/4,δ)d(x,u)2,whichissmallerthanA/100forδ,r/√ǫsmallenough.UpperboundonB2.WehaveB2≤||PE(USbZT+cWSVT)||7.2LowerboundongradG(x)BythedefinitionofGinEq.(34),wehavehgradG(x),bwi=1µ0rmXi=1G′1||X(i)||22µ0r!hX(i),cW(i)i+1µ0rnXj=1G′1||Y(i)||22µ0r!hY(i),bZ(i)i.(86)Itisthereforesufficienttoshowthatif||X(i)||2>2µ0r,thenhX(i),cW(i)i>0,andif||Y(j)||2>2µ0r,thenhY(j),bZ(j)i>0.Wewilljustconsiderthefirststatement,thesecondbeingcompletelysymmetrical.Fromtheexplicitexpressions(43)and(52)wegetX(i)=RncosΘRTU(i)+sinΘL(i)o,(87)cW(i)=RnΘcosΘL(i)−ΘsinΘRTU(i)o.(88)Fromthefirstexpressionitfollowsthat||sinΘL(i)||2≤||X(i)||2+||cosΘRTU(i)||2≤3µ0r.(89)Ontheotherhand,bytakingthedifferenceBProofofRemark4.5Theexpectationofthecontributionoflightcouples,wheneachedgeisindependentlyrevealedwithprobabilityǫ/√mn,isE[Z]=ǫ√mnX(i,j)∈LxiMAijywherethesecondinequalityfollowsfromthedefinitionofheavycouplesandthelastinequalityisduetoincoherenceconditionA2.Hencesummingtwocontributions,weget|E[Z]|≤µ1+µ21√rǫ.BygroupingthesummationintoAi’sandBj’s,wegetX(u,v):|xuyv|≥C√ǫnQuv|xuyv|≤X(i,j):2i+j≥4C√αǫ1.σi,j≤1:ByEqs.(97)and(98),wehavePαiβjσi,j≤(2/∆)4=O(1).2.2i>√ǫ2j:BytheboundeddegreepropertyinEq.(94),wehaveei,j≤ai2ǫ/√α,whichimpliesthatei,j/µi,j≤2n/bj.Forafixediwehave,Pjβjσi,jI(2i>√ǫ2j)≤2√ǫPDProofofremarks5.1and5.2Proof.(Remark5.1.)Letθ=(θ1,...,θp),θi∈[−π/2,π/2]betheprincipalanglesbetweentheplanesspannedbythecolumnsofX1andX2.Itisknownthatdc(X1,X2)=||2sin(θ/2)||2anddp(X1,X2)=||sinθ||2.Thethesisfollowsfromtheelementaryinequalities1πα≤√2sin(α/2)≤sinα≤2sin(α/2)(103)validforα∈[0,π/2].Proof.(Remark5.2.)Westartbyobservingthatdp(V,Y)=1√nminA∈Rr×r||V−YA||F.(104)Indeed[Ber92]M.W.Berry,Largescalesparsesingularvaluecomputations,InternationalJournalofSupercomputerApplications6(1992),13–49.[CCS08]J-FCai,E.J.Candès,andZ.Shen,Asingularvaluethresholdingalgorithmformatrixcompletion,arXiv:0810.3286,2008.[CR08]E.J.