                  JOURNAL OF THE
                  AMERICAN MATHEMATICAL SOCIETY
                  Volume 21, Number 1, January 2008, Pages 1â€“21
                  S 0894-0347(07)00573-5
                  Article electronically published on August 9, 2007
                              EUCLIDEAN DISTORTION AND THE SPARSEST CUT
                                          SANJEEV ARORA, JAMES R. LEE, AND ASSAF NAOR
                                                                     1. Introduction
                       Bi-Lipschitz embeddings of ï¬nite metric spaces, a topic originally studied in geo-
                  metric analysis and Banach space theory, became an integral part of theoretical
                  computer science following work of Linial, London, and Rabinovich [29]. They
                  presented an algorithmic version of a result of Bourgain [8] which shows that ev-
                  ery n-point metric space embeds into L2 with distortion O(log n). This geometric
                  viewpoint oï¬€ers a way to understand the approximation ratios achieved by lin-
                  ear programming (LP) and semideï¬nite programming (SDP) relaxations for cut
                  problems [29, 6]. It soon became apparent that further progress in understand-
                  ing SDP relaxations would involve improving Bourgainâ€™s general bound of O(log n)
                  for n-point metric spaces of negative type. For instance, the approximation ratio
                  achieved by a well-known SDP relaxation for the general Sparsest Cut problem is
                  known to coincide exactly with the best possible distortion bound achievable for
                  the embedding of n-point metrics of negative type into L1 â€”a striking connection
                  between pure mathematics and algorithm design.
                       Further progress on these problems required new insights into the structure of
                  metric spaces of negative type and the design of more sophisticated and ï¬‚exible
                  embedding methods for ï¬nite metrics. Coincidentally, signiï¬cant progress was
                  made recently on both these fronts. Arora, Rao and Vazirani [5] proved a new
                  structural
                       âˆš           theorem about metric spaces of negative type and used it to design an
                  O( log n)-approximation algorithm for the uniform case of the Sparsest Cut prob-
                  lem. Krauthgamer, Lee, Mendel and Naor [22] introduced a new embedding method
                  called measured descent which uniï¬ed and strengthened many existing embedding
                  techniques, and they used it to solve a number of open problems in the ï¬eld.
                       These breakthroughs indeed resulted in improved embeddings for negative type
                  metrics; Chawla, Gupta, and RaÌˆcke [11] used the structural theorem of [5] (specif-
                  ically, its stronger form due to Lee [24]), in conjunction with measured descent
                  to show that every n-point metric of negative type embeds into L2 with distor-
                  tion O(log n)3/4 . In the present work, we show how one can achieve distortion
                       Received by the editors August 8, 2005.
                       2000 Mathematics Subject Classiï¬cation. Primary 51F99, 46B07, 68W25.
                       Key words and phrases. Bi-Lipschitz embeddings, metrics of negative type, approximation
                  algorithms.
                       The ï¬rst author was supported by a David and Lucile Packard Fellowship and NSF grant
                  CCR-0205594.
                       The second author was supported by NSF grant CCR-0121555 and an NSF Graduate Research
                  Fellowship.
                       The last author was supported by NSF grants CCF-0635078 and DMS-0528387.
                                                                                                   2007
                                                                                                   c       American Mathematical Society
                                                                                 1
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                  2                          SANJEEV ARORA, JAMES R. LEE, AND ASSAF NAOR
                       âˆš                                                                                                   âˆš
                  O( log n Â· log log n). This almost matches the 35-year-old lower bound of log n
                  from Enï¬‚o [14]. Our methods use the results of [5, 24, 11] essentially as a â€œblack
                  box,â€ together with an enhancement of the measured descent technique. âˆš
                       Recall that a metric space (X, d) is said to be of negative type if (X, d) is
                  isometric to a subset of Euclidean space. In particular, it is well known that L1
                  is of negative type. (We also remind the reader that L2 is isometrically equivalent
                  to a subset of L1 .) The parameter c2 (X), known as the Euclidean distortion of
                  X, is the least distortion with which X embeds into Hilbert space, i.e. it is the
                  minimum of distortion(f ) = f Lip Â· f âˆ’1 Lip over all bijections f : X â†’ L2 .
                  The mathematical investigation of the problem we study here goes back to the
                  work of Enï¬‚o [14], who           âˆš showed    that the Euclidean distortion of the Hamming cube
                  â„¦d = {0, 1}d equals d = log2 |â„¦d |. The following natural question is folklore
                  in geometric and functional analysis: â€œIs the discrete d-dimensional hypercube the
                  most non-Euclidean 2d -point subset of L1 ?â€
                       A positive answer to this question               âˆš would imply that any n-point subset of L1
                  embeds in L2 with distortion O( log n). In fact, motivated by F. Johnâ€™s theo-
                  rem in convex geometry (see [34]), Johnson and Lindenstrauss [20] asked âˆšin 1983
                  whether every n-point metric space embeds into L2 with distortion O( log n).
                  Here, the analogy between ï¬nite dimensional normed spaces and ï¬nite metric spaces
                  is not complete: Bourgain [8] has shown that for any n-point metric space X,
                  c2 (X) = O(log n), and this result is existentially optimal [29, 6]. By now we under-
                  stand that ï¬nite metric spaces (namely expander graphs) can exhibit an isoperi-
                  metric proï¬le which no Euclidean space can achieve, and this is the reason for the
                  discrepancy with Johnâ€™s theorem. However, it is known                             âˆš (see [22]) that several nat-
                  ural restricted classes of metrics do adhere to the O( log n) Euclidean distortion
                  suggested by Johnâ€™s theorem. Arguably, for applications in theoretical computer
                  science, the most important restricted class of metrics are those of negative type;
                  yet improvements over Bourgainâ€™s theorem for such metrics have long resisted the
                  attempts of mathematicians and computer scientists.
                       The present paper is devoted to proving that up to iterated logarithmic factors,
                  the answer to the above question is positive. This yields a general tool for the
                  rounding of certain classes of semi-deï¬nite programs. As a result, we obtain the
                  best known polynomial time algorithm for the approximation of the Sparsest Cut
                  problem with general demands, improving over the previous bounds due to [11]
                  and the preceding works [29] and [6] (which yield an O(log n) approximation).
                  This problem is described in Section 1.1. We now state our main result. In the case
                  of metrics of negative type (and not just L1 metrics), it answers positively (up to
                  iterated logarithms) a well known conjecture in theoretical computer science and
                  metric geometry (stated explicitly by Goemans in [17]).
                  Theorem 1.1. Let (X, d) be an n-point metric space of negative type. Then
                                                                                                   
                                                           c2 (X) = O           log n Â· log log n .
                  Related work. Until recently, there was little solid evidence behind the conjecture                    âˆš
                  that any n-point subset of L1 embeds in Hilbert space with distortion O( log n).
                  In the paper [25], Lee, Mendel and Naor show that                             âˆš any n-point subset of L1 em-
                  beds into Hilbert space with âˆš                 average distortion O( log n). Arora, Rao, and Vazi-
                  rani [5] have shown that O( log n) distortion is achievable using a diï¬€erent no-
                  tion of average distortion, which turns out to be more relevant for bounding the
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                                             EUCLIDEAN DISTORTION AND THE SPARSEST CUT                                            3
                  actual distortion. As described above, combining their result with the measured
                  descent technique of Krauthgamer, Lee, Mendel and Naor [22], Chawla, Gupta, and
                  RaÌˆcke [11] have recently proved that for any n-point metric space X of negative
                  type, c2 (X) = O(log n)3/4 . It was conjectured [31, pg. 379] that n-point metrics
                  of negative type embed into L1 with distortion O(1). Recently, Khot and Vish-
                  noi [21] have obtained a lower bound of â„¦(log log n)Î´ , for some universal constant
                  Î´ > 0. This lower bound has been improved by Krauthgamer and Rabani [23] to
                  â„¦(log log n).
                       Our results also suggest that the dimension reduction lower bound of Brinkman
                  and Charikar [9] (see also [26]) is tight for certain distortions. They show that
                  embedding certain n-point subsets of L1 into d1 with distortion D requires that
                                    2
                  d â‰¥ nâ„¦(1/D ) . Theorem 1.1, together with theorems of Johnson and Lindenstrauss
                  [20] and Figiel, Lindenstrauss, and Milman [16], yields an embedding of every n-
                                                         O(log n)                               âˆš
                  point subset of L1 into 1                         with distortion O( log n Â· log log n).
                  1.1. Algorithmic application: The Sparsest Cut problem with general
                  demands. In this section, we brieï¬‚y describe an application of Theorem 1.1 to
                  the Sparsest Cut problem with general demands (and its relation to the multi-
                  commodity ï¬‚ow problem). This is a fundamental NP-hard combinatorial optimiza-
                  tion problemâ€”we refer the interested reader to the articles [28, 2, 29, 6], the sur-
                  vey [39], and Chapter 21 of the book [40] for additional information on Sparsest
                  Cut, and its applications to the design of approximation algorithms.
                       Let G = (V, E) be a graph (network), with a capacity C(e) â‰¥ 0 associated to
                  every edge e âˆˆ E. Assume that we are given k pairs of vertices (s1 , t1 ), ..., (sk , tk ) âˆˆ
                  V Ã— V and D1 , . . . , Dk â‰¥ 1. We think of the si as sources, the ti as targets, and
                  the value Di as the demand of the terminal pair (si , ti ) for some commodity Îºi .
                  The problem is said to have uniform demands if every pair u, v âˆˆ V occurs as some
                  (si , ti ) pair with Di = 1.
                       In the MaxFlow problem the objective is to maximize the fraction Î» of the
                  demand that can be shipped simultaneously for all the commodities, subject to the
                  capacity constraints. Denote this maximum by Î»âˆ— . A trivial upper bound on Î»âˆ— is
                  the cut ratio. Given any subset S âŠ† V , we write
                                                                 
                                                                     uvâˆˆE C(uv) Â· |1S (u) âˆ’ 1S (v)|
                                                   Î¦(S) =              k
                                                                                                            ,
                                                                        i=1 Di Â· |1S (si ) âˆ’ 1S (ti )|
                  where 1S is the characteristic function of S. The value Î¦âˆ— = minSâŠ†V Î¦(S) is
                  the minimum over all cuts (partitions) of V , of the ratio between the total ca-
                  pacity crossing the cut and the total demand crossing the cut. In the case of a
                  single commodity (i.e. k = 1) the classical MaxFlow-MinCut theorem states that
                  Î»âˆ— = Î¦âˆ— , but in general this is no longer the case. It is known [28, 29, 6] that
                  Î¦âˆ— = O(log k)Î»âˆ— . This result is perhaps the ï¬rst striking application of metric em-
                  beddings in combinatorial optimization (speciï¬cally, it uses Bourgainâ€™s embedding
                  theorem [8]).
                       Computing Î¦âˆ— is NP-hard [32]. Moreover, ï¬nding a cut for which Î¦âˆ— is (approx-
                  imately) attained is a basic step in approximation algorithms for several NP-hard
                                                                                                              âˆ—
                  problems [28, 2, 39]. The best known algorithm for computing Î¦âˆš                               in the case of uni-
                  form demands is due to [5], where an approximation ratio of O( log n) is achieved.
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                  4                          SANJEEV ARORA, JAMES R. LEE, AND ASSAF NAOR
                  In the case of non-uniform demands, an approximation ratio of O(log k)3/4 is ob-
                  tained in [11]. Here, as an application of Theorem 1.1, we prove the following
                  theorem:
                  Theorem 1.2. Using the above notation, there exists a polynomial-time algorithm
                  which produces a subset S âŠ† V for which
                                                                                                 
                                                         Î¦(S) = O             log k Â· log log k Î¦âˆ— .
                  Structure of the paper. This paper is organized as follows. In Section 2 we
                  present an informal overview of the ideas involved in the proof of Theorem 1.1.
                  Section 3 is devoted to various preliminaries on the geometry of metrics of nega-
                  tive type. Theorem 1.1 is proved in Section 4, and the algorithm of Theorem 1.2
                  is described and analyzed in Section 5. We end with Section 6, which contains
                  additional remarks and open problems.
                                             2. Overview of the proof of Theorem 1.1
                  Remarks on notation. When we write E  F for two expressions E and F , we
                  intend this to mean that there exists some  > 0 such that E â‰¥ F , where  is
                  intended to be a universal constant, independent of the variables or parameters on
                  which E and F depend.
                       We will often work with Hilbert spaces of the following form: If H is a Hilbert
                  space and (â„¦, Âµ) is a probability space, we use L2 (H, â„¦, Âµ) to denote                     the Hilbert
                  space of H-valued random variables Z with norm ||Z||L2 (H,â„¦,Âµ) = E ||Z||2H . When
                  H, â„¦ are clear from the context, we simply write L2 (Âµ) and denote || Â· ||H by || Â· ||2 .
                       Our proof of Theorem 1.1 has little to do with metrics of negative type; the
                  connection to such spaces comes through the techniques of [5, 24, 11] and is laid
                  out in Section 3. Instead, we present a general theorem about gluing together
                  various maps from ï¬nite metric spaces into Hilbert spaces (and, more generally, Lp
                  spaces for p âˆˆ [1, âˆ)). Our starting point is the following type of ensemble.
                       Let (X, d) be an n-point metric space. Suppose that for every Ï„ â‰¥ 0 and every
                  subset S âŠ† X there exists a 1-Lipschitz map Ï•S,Ï„ : X â†’ L2 with
                                                                                                   Ï„
                  (1)                                    ||Ï•S,Ï„ (x) âˆ’ Ï•S,Ï„ (y)||2 â‰¥ 
                                                                                                 log |S|
                                                                                                    
                  whenever x, y âˆˆ S and d(x, y) âˆˆ [Ï„, 2Ï„ ]. In general, log |S| could be a diï¬€erent
                  function of |S|, but we restrict ourselves here for simplicity. Additionally, let us
                  temporarily deï¬ne Ï•Ï„ = Ï•X,Ï„ for every Ï„ â‰¥ 0 so that for the maps {Ï•Ï„ }, condition
                  (1) holds for all x, y âˆˆ X and |S| = n. The problem we are now confronted with
                  is how to combine the ensemble of maps {Ï•S,Ï„ } together to obtain a genuinely
                  bi-Lipschitz map.
                       There is an obvious approach which comes to mind: Let R âŠ† Z be such that for
                  all x, y âˆˆ X, there exists k âˆˆ R such that d(x, y) âˆˆ [2k , 2k+1 ]. Nowâˆšdeï¬ne the map
                                                    
                  Ï• : X â†’ L2 by Ï• = kâˆˆR Ï•2k . Clearly we have both ||Ï•||Lip â‰¤ R and, for all
                  x, y âˆˆ X,
                                                                                          d(x, y)
                                                              ||Ï•(x) âˆ’ Ï•(y)||2 â‰¥ âˆš                   ;
                                                                                         2 log n
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                                             EUCLIDEAN DISTORTION AND THE SPARSEST CUT                                           5
                                                          âˆš
                  hence distortion(Ï•) = O( R log n). Trivially, we can choose R so that |R| â‰¤ n2 .
                  A slightly more delicate argument yields such an R with |R| â‰¤ O(n).                            âˆš       Unfortu-
                  nately, we are searching for a bound of the form distortion(Ï•) â‰ˆ log n, making
                  this construction useless.
                       Nevertheless, the key to a better gluing of the given ensemble does lie in the
                  delicate interplay between the distributions of distances in X and the number of
                  points in various regions of the space. The technique of measured descent from [22]
                  relies essentially on two facts about ï¬nite metric spaces. First, the identity
                                                                 |B(x, Î± Â· 2k )|
                  (2)                                       log                      = O(log n log Î±)
                                                                     |B(x, 2k )|
                                                       kâˆˆZ
                  for any number Î± â‰¥ 2. (In [22], a ï¬xed constant value of Î± was used, but for us the
                  quantitative dependence is crucial, as we will have Î± depending on n.) This gives
                  a simple bound on the rate that a ï¬nite metric space can expand over all its scales
                  and is implicitly used in earlier works under the name of â€œregion growingâ€ [28, 15].
                       For the purposes of this description, we will state the second fact less concretely.
                  Basically, in certain settings, one can think of the ratio |B(x, Î±Ï„ )|/|B(x, Ï„ )| as the
                  â€œlocal cardinality of the spaceâ€ around x at scale Ï„ . As an example, if X = Rd ,
                  B(x, Â·) represents a Euclidean ball, and | Â· | is the Lebesgue measure, then this ratio
                  approximates the number of Ï„ -net points that can be packed inside a ball of radius
                  Î±Ï„ . Later, it will become necessary to randomly partition X into pieces of diameter
                  at most 2Ï„ while ensuring that pairs x, y âˆˆ X with d(x, y)                                Ï„ are usually in the
                  same component of the partition (see Section 3.1 on padded decomposability). It
                  is known [10, 15] that the properties of such partitions near x depend on the local
                  value log |B(x,2Ï„       )|
                                  |B(x,Ï„ )| .
                       Following [22], this relationship is used in [24] to prove (roughly) that, given the
                  maps âˆš {Ï•Ï„ }Ï„ â‰¥0 deï¬ned above, there exists a map Ï• : X â†’ L2 such that ||Ï•||Lip â‰¤
                  O( log n) and, for x, y âˆˆ X with d(x, y) âˆˆ [2k , 2k+1 ],
                                                                                
                                                                |B(x, 2k+1 )|                                     d(x, y)
                  (3) ||Ï•(x) âˆ’ Ï•(y)||2                    log                      ||Ï•2k (x) âˆ’ Ï•2k (y)|| +                    .
                                                                  |B(x, 2k )|                                 log |B(x,2k+1 )|
                                                                                                                   |B(x,2k )|
                                                                                                 (I)                (II)
                  The contribution (II) comes from random partitioning and Raoâ€™s                               âˆš technique [38]
                  and is valid for any metric space X. Observing that (I)  d(x, y)/ log n and using
                  AM-GM in (3), one arrives at the lower bound
                                                                                          d(x, y)
                                                              ||Ï•(x) âˆ’ Ï•(y)||2                    1 ;
                                                                                         (log n) 4
                                                                   3
                  hence distortion(Ï•) â‰¤ O(log n) 4 . While                âˆš     not obvious at present, the identity (2) is
                  what allows [24] to get the leading Â· factor in (3) while keeping ||Ï•||Lip small (see
                  Theorem 4.5).                                                    âˆš
                       In order to get the distortion near O( log n), we have to dispense with the
                  contribution (II) which is not derived from the ensemble {Ï•S,Ï„ }. Instead, we would
                  like to pass from the ensemble {Ï•S,Ï„ } to a family of maps {Ï•ÌƒÏ„ : X â†’ L2 } for which
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                  6                          SANJEEV ARORA, JAMES R. LEE, AND ASSAF NAOR
                  the contribution of (I) in (3) is replaced by
                                                                                             d(x, y)
                  (4)                               ||Ï•Ìƒ2k (x) âˆ’ Ï•Ìƒ2k (y)||2                                .
                                                                                          log |B(x,2
                                                                                                       k+1 )|
                                                                                                 |B(x,2 )|
                                                                                                        k
                  Clearly this would ï¬nish the proof. Roughly, the construction of Ï•Ìƒ2k proceeds as
                  follows. We ï¬rst randomly partition X into components of diameter about 2k Î±
                  for some appropriately chosen Î± = Î±(n). Writing the random partition as X =
                  C1 âˆªC2 âˆªÂ· Â· Â·âˆªCm , we then derive subsets CÌƒi âŠ† Ci by randomly sampling points from
                  each Ci . Then, we use an appropriately constructed (random) partition of unity
                  to glue the collection of maps {Ï•CÌƒi ,2k }m                   i=1 together. To ensure that the resulting
                  map still has ||Ï•Ìƒ2k ||Lip â‰¤ O(1), the partition of unity is constructed carefully using
                  properties of the random partition (this bears some resemblance to the technique
                  of [27] for extending Lipschitz functions).
                       The key to the proof is the way in which the random samples CÌƒi are chosen. We
                  have to maintain the property that CÌƒi is a â€œgood representativeâ€ of Ci at scale 2k
                  (i.e. we need that, on average, CÌƒi is 2k -dense in Ci ). On the other hand, we need
                  to maintain the invariant that if x âˆˆ Ci , then
                                                                                   |B(x, Î±2k )|
                                                                log |CÌƒi | â‰ˆ log                   ,
                                                                                    |B(x, 2k )|
                  so that we can achieve a bound similar to (4) (recall that the quality of the map
                  Ï•S,Ï„ depends on |S| = |CÌƒi |). Unfortunately, this is impossible since for distinct
                  x, x âˆˆ Ci , the above ratios can be quite diï¬€erent. Instead, we have a number of
                  phases, one for each estimate of the possible ratio (see the proof of Theorem 1.1).
                  For this to work, we have to give up on achieving (4) exactly, and instead we weave
                  together the inter-scale (Lemma 4.4) gluing of (3) with                            âˆš the intra-scale (Theorem
                  4.5) gluing of (4) to obtain a nearly tight bound of O( log n Â· log log n).
                                                           3. Single scale embeddings
                       In this section we present Theorem 3.1 and derive from it Lemma 3.5, which
                  is one of the main tools used in the proof of the Main Theorem (1.1). It is a
                  concatenation of the result of Arora, Rao, and Vazirani [5], its strengthening by
                  Lee [24], and the â€œreweightingâ€ method of Chawla, Gupta, and RaÌˆcke [11], who
                                                                                                                 3
                  use it in conjunction with [22] to achieve distortion O (log n) 4 . For the sake of
                  completeness, we present below a sketch of the proof of Theorem 3.1. Complete
                  details can be found in the full version of [24], where a more general result is
                  proved; the statement actually holds for metric spaces which are quasisymmetrically
                  equivalent to subsets of Hilbert space and not only for those of negative type.
                  (See [19] for the deï¬nition of quasisymmetry; the relevance of such maps to the
                  techniques of [5] was ï¬rst pointed out in [36].)
                  Theorem 3.1. There exist constants C â‰¥ 1 and 0 < p < 12 such that for every
                  n-point metric space (Y, d) of negative type and every âˆ† > 0, the following holds.
                  There exists a distribution Âµ over subsets U âŠ† Y such that for every x, y âˆˆ Y with
                  d(x, y) â‰¥ 16    âˆ†
                                     ,
                                                                                                        
                                                                                                 âˆ†
                                                Âµ U : y âˆˆ U and d(x, U ) â‰¥ âˆš                                â‰¥ p.
                                                                                            C log n
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                                             EUCLIDEAN DISTORTION AND THE SPARSEST CUT                                       7
                  Proof (sketch). Let g : Y â†’ 2 be such that
                                                                d(x, y) = ||g(x) âˆ’ g(y)||22
                                                                                                                          âˆš
                  for all x, y âˆˆ Y . By [33], there exists a map T : 2 â†’ 2 such that ||T (z)||2 â‰¤ âˆ†
                  for all z âˆˆ 2 and
                                                            1          ||T (z) âˆ’ T (z  )||2
                                                                â‰¤           âˆš                      â‰¤1
                                                            2       min{ âˆ†, ||z âˆ’ z  ||2 }
                  for all z, z  âˆˆ 2 . As in [24], we let f : Y â†’ Rn âˆ¼                        = span(f (Y )) be the map given
                  by f = T       â—¦ g. Then f is a bi-Lipschitz embedding (with distortion 2) of the metric
                  space (Y, min{âˆ†, d}) into the Euclidean ball of radius âˆ†.
                       Let 0 < Ïƒ < 1 be some constant. The basic idea is to choose a random u âˆˆ S nâˆ’1
                  and deï¬ne
                                                                                                   âˆš
                                                                                                âˆ’Ïƒ
                                                        Lu      = {x âˆˆ Y : x, u â‰¤               âˆš âˆ† },
                                                                                                    n
                                                                                                  âˆš
                                                        Ru      = {x âˆˆ Y : x, u â‰¥             Ïƒâˆš âˆ†
                                                                                                   n
                                                                                                      }.
                  One then prunes the          âˆš sets by iteratively removing any pairs of nodes x âˆˆ Lu , y âˆˆ Ru
                  with d(x, y) â‰¤ âˆ†/ log n. In the end, one is left with two sets Lu , Ru . The main
                  result of [5, 24] is that with high probability (over the choice of u), the number of
                  pairs pruned from Lu Ã— Ru is not too large.
                       Let Sâˆ† = {(x, y) âˆˆ Y Ã— Y : d(x, y) â‰¥ 16                       âˆ†
                                                                                        }. The reweighting idea of [11] is to
                  apply the above procedure to a weighted version of the point set as follows. Let
                  w : Y Ã— Y â†’ Z+ be an integer-valued weight function on pairs, with w(x, y) =
                  w(y, x), w(x, x) = 0, and w(x, y) > 0 only if (x, y) âˆˆ Sâˆ† . This weight function
                   be viewed as yielding a new set of points where each point x is replaced by
                  can
                      yâˆˆY w(x, y) copies, with w(x, y) of them corresponding to the pair (x, y). One
                  could think of applying the above procedure on this new point set; note that the
                  pruning procedure above may remove some or all copies of x. Then, as observed
                  in [11], the theorems of [5, 24] imply that with high probability, after the pruning,
                  we still have
                                                                                       
                                                                           w(x, y)           w(x, y).
                                                           xâˆˆLu ,yâˆˆRu                  x,y
                       The distribution Âµ mentioned in the statement of the theorem is deï¬ned using
                  a family of O(log n) weight functions described below. Sampling from Âµ consists of
                  picking a weight function from this family and a random direction u âˆˆ S nâˆ’1 and
                  then forming sets Lu , Ru as above using the weight function. Let us call these sets
                  Lu (w), Ru (w). One then outputs the set U of all points x for which any â€œcopyâ€
                  falls into Lu (w).
                       Now we deï¬ne the family of weight functions. The initial weight function has
                  w0 (x, y) = n4 for all (x, y) âˆˆ Sâˆ† . Given wk , obtain wk+1 as follows. If
                                                                                                        
                                             Âµ u âˆˆ S nâˆ’1 : (x, y) âˆˆ Lu (wk ) Ã— Ru (wk ) â‰¥ 0.1,
                  we set wk+1 (x, y) = wk (x, y). Otherwise, we set wk+1 (x, y) = 2 Â· wk (x, y). A simple
                  argument from [11] shows that by repeating this O(log n) times, we obtain O(log n)
                  weight functions such that for every pair (x, y) âˆˆ Sâˆ† the following is true: If one
                  picks a random weight function w and a random direction u âˆˆ S nâˆ’1 , then with
                  constant probability we have (x, y) âˆˆ Lu (w) Ã— Ru (w).                                                  
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                  8                          SANJEEV ARORA, JAMES R. LEE, AND ASSAF NAOR
                  3.1. Padded decomposability and random zero sets. Theorem 3.1 is the only
                  way the negative type property will be used in what follows. It is therefore helpful
                  to introduce it as an abstract property of metric spaces. Let (X, d) be an n-point
                  metric space.
                  Deï¬nition 3.2 (Random zero-sets). Given âˆ†, Î¶ > 0, and p âˆˆ (0, 1), we say that
                  X admits a random zero set at scale âˆ† which is Î¶-spreading with probability p if
                  there is a distribution Âµ over subsets Z âŠ† X such that for every x, y âˆˆ X with
                  d(x, y) â‰¥ âˆ†,                                                                         
                                                                                                    âˆ†
                                                 Âµ Z âŠ† X : y âˆˆ Z and d(x, Z) â‰¥                              â‰¥ p.
                                                                                                     Î¶
                  We denote by Î¶(X; p) the least Î¶ > 0 such that for every âˆ† > 0, X admits a random
                  zero set at scale âˆ† which is Î¶-spreading with probability p. Finally, given k â‰¤ n,
                  we deï¬ne
                                                                 Î¶k (X; p) = max Î¶(Y ; p).
                                                                                 Y âŠ†X
                                                                                |Y |â‰¤k
                       With this deï¬nition, Theorem 3.1 implies that there exists a universal constant
                  p âˆˆâˆš(0, 1) such that for every n-point metric space (X, d) of negative type, Î¶(X; p) =
                  O( log n).
                       We now recall the related notion of padded decomposability. Given a partition
                  P of X and x âˆˆ X, we denote by P (x) âˆˆ P the unique element of P to which x
                  belongs. In what follows we sometimes refer to P (x) as the cluster of x.
                  Deï¬nition 3.3 (Decomposition bundle, modulus of padded decomposability). Fol-
                  lowing [22], we say that {Pâˆ† }âˆ†>0 is an Î±-padded decomposition bundle of a metric
                  space X if for every âˆ† > 0, Pâˆ† is a random partition of X (whose distribution we
                  denote by Î½) with the following properties:
                        (1) For all P âˆˆ supp(Î½) and all C âˆˆ P we have that diam(C) < âˆ†.
                        (2) For every x âˆˆ X we have that
                                                                                                      1
                                                           Î½{P : B(x, âˆ†/Î±) âŠ† P (x)} â‰¥ .
                                                                                                      2
                  The modulus of padded decomposability of X, denoted Î±X , is deï¬ned as the largest
                  constant Î± > 0 such that X admits an Î±-padded decomposition bundle.
                       As observed in [22], the results of [30, 7] imply that Î±X = O(log |X|), and this
                  will be used in the ensuing arguments. The following useful fact relates the notions
                  of padded decomposability and random zero sets. Its proof is motivated by an
                  argument of Rao [38].
                  Fact 3.4. Î¶(X; 1/8) â‰¤ Î±X .
                  Proof. Fix âˆ† > 0 and let P be a partition of X into subsets of diameter less than
                  âˆ†. Given x âˆˆ X, we denote by Ï€P (x) the largest radius r for which B(x, r) âŠ† P (x).
                  Let {ÎµC }CâˆˆP be i.i.d. symmetric {0, 1}-valued Bernoulli random variables. Let ZP
                  be a random subset of X given by
                                                                                  
                                                                    ZP =                   C .
                                                                             CâˆˆP : ÎµC =0
                       If x, y âˆˆ X satisfy d(x, y) â‰¥ âˆ†, then P (x) = P (y). It follows that
                                                                                                         1
                                                       Pr[y âˆˆ ZP âˆ§ d(x, ZP ) â‰¥ Ï€P (x)] â‰¥ .
                                                                                                         4
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                                             EUCLIDEAN DISTORTION AND THE SPARSEST CUT                                    9
                  By the deï¬nition of Î±X , there exists a distribution over partitions P of X into
                  subsets of diameter less than âˆ† such that for every x âˆˆ X with probability at least
                  1/2, Ï€P (x) â‰¥ âˆ†/Î±X . The required result now follows by considering the random
                  zero set ZP .                                                                                           
                       We end this section with the following simple lemma, which shows that the
                  existence of random zero sets implies the existence of embeddings into L2 which
                  are bi-Lipschitz on a ï¬xed distance scale.
                  Lemma 3.5 (Random zero sets yield single scale embeddings). For every ï¬nite
                  metric space X, every S âŠ† X, every p âˆˆ (0, 1), and every Ï„ > 0, there exists a
                  1-Lipschitz mapping Ï• : X â†’ L2 such that for every x, y âˆˆ S with d(x, y) â‰¥ Ï„ ,
                                                                                             âˆš
                                                                                            Ï„ p
                                                               Ï•(x) âˆ’ Ï•(y)2 â‰¥                     .
                                                                                          Î¶(S; p)
                  Proof. By the deï¬nition of Î¶(S, p) there exists a distribution Âµ over subsets Z âŠ† S
                  such that for every x, y âˆˆ S with d(x, y) â‰¥ Ï„ ,
                                                                                                           
                                                                                                     Ï„
                                              Âµ Z âŠ† S : y âˆˆ Z and d(x, Z) â‰¥                                   â‰¥ p.
                                                                                                 Î¶(S; p)
                  Deï¬ne Ï• : X â†’ L2 (Âµ) by Ï•(x) = d(x, Z). Clearly Ï• is 1-Lipschitz. Moreover, for
                  every x, y âˆˆ S with d(x, y) â‰¥ Ï„ ,
                                                                                                                    2
                                                                                                2              Ï„
                               Ï•(x) âˆ’ Ï•(y)2L2 (Âµ) = EÂµ [d(x, Z) âˆ’ d(y, Z)] â‰¥ p Â·                                      .
                                                                                                             Î¶(S; p)
                                                                                                                          
                                                             4. Proof of Theorem 1.1
                       The primary result of this section is the following theorem.
                  Theorem 4.1. Let (X, d) be an n-point metric space. Suppose there exist constants
                  C > 0 and 12 â‰¤ Îµ â‰¤ 1 such that for every Ï„ â‰¥ 0 and every subset S âŠ† X there exists
                  a 1-Lipschitz map Ï•S,Ï„ : X â†’ L2 with
                                                                                                   Ï„
                                                        ||Ï•S,Ï„ (x) âˆ’ Ï•S,Ï„ (y)||2 â‰¥
                                                                                            C(log |S|)Îµ
                  whenever x, y âˆˆ S and d(x, y) âˆˆ [Ï„, 6Ï„ ]. Then c2 (X) â‰¤ O(1) Â· C(log n)Îµ log log n.
                       Theorem 4.1 implies Theorem 1.1. Indeed, if X is an n-point metric space
                  such that for some p âˆˆ (0, 1), Îµ âˆˆ [1/2, 1], and C > 0, we have for every k â‰¤ n,
                  Î¶k (X; p) â‰¤ C(log k)Îµ , then Theorem 4.1 together with Lemma 3.5 implies that
                                                                                                      
                                                                             C(log n)Îµ log log n
                                                         c2 (X) = O                   âˆš                   .
                                                                                          p
                  Theorem 1.1 follows since by Theorem 3.1 we know that for some universal constant
                  p âˆˆâˆš(0, 1), if X is a metric space of negative type, then for all k, Î¶k (X; p) =
                  O log n .
                       The proof of Theorem 4.1 will be broken down into several steps. In what follows
                  we ï¬x a ï¬nite metric space X.
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                  10                          SANJEEV ARORA, JAMES R. LEE, AND ASSAF NAOR
                  Lemma 4.2 (Extending to neighborhoods). Let S âŠ† X, Ï„ â‰¥ 0, and assume that
                  there exists a 1-Lipschitz map Ï• : X â†’ L2 satisfying
                                                                                               Ï„
                                                                    ||Ï•(x) âˆ’ Ï•(y)||2 â‰¥
                                                                                              L
                  for x, y âˆˆ S, d(x, y) âˆˆ [Ï„ /2, 3Ï„ ] and some L â‰¥ 2. Then there is a 1-Lipschitz map
                  h : X â†’ L2 with
                                                                                              Ï„
                                                                   ||h(x) âˆ’ h(y)||2 â‰¥
                                                                                             9L
                  whenever d(x, S) â‰¤ 6L           Ï„
                                                      , y âˆˆ X, and d(x, y) âˆˆ [Ï„, 2Ï„ ].
                  Proof. Deï¬ne g : X â†’ R by g(x) = d(x, S), and set h = âˆš12 (Ï• âŠ• g). If d(y, S) > 3L                                   Ï„
                                                                                                                                         ,
                  then
                                                         1                              1                                   1      Ï„
                          ||h(x) âˆ’ h(y)||2 â‰¥ âˆš ||g(x) âˆ’ g(y)||2 â‰¥ âˆš (d(y, S) âˆ’ d(x, S)) â‰¥ âˆš Â·                                        .
                                                          2                              2                                    2   6L
                  Otherwise, let x , y  âˆˆ S be such that d(x, x ) â‰¤ 6L                   Ï„
                                                                                                , d(y, y  ) â‰¤ 3L Ï„
                                                                                                                    , and observe that
                                                                     Ï„      Ï„                    Ï„       Ï„        Ï„       
                                  d(x , y  ) âˆˆ d(x, y) âˆ’                âˆ’     , d(x, y) +           +         âŠ†       , 3Ï„ .
                                                                    6L 3L                        6L 3L                2
                  Using our assumptions on Ï•, we have
                                                                                                       Ï„         Ï„         Ï„
                                 ||Ï•(x) âˆ’ Ï•(y)||2 â‰¥ ||Ï•(x ) âˆ’ Ï•(y  )||2 âˆ’ ||Ï•||Lip                         +          â‰¥       ;
                                                                                                        6L 3L               2L
                  hence ||h(x) âˆ’ h(y)||2 â‰¥ âˆš12 Â· 2L               Ï„
                                                                     .                                                                  
                  Lemma 4.3 (Random subsets). Assume that X satisï¬es the conditions of Theo-
                  rem 4.1, and suppose that U âŠ† X and k â‰¥ 2. Deï¬ne
                                                                                                               
                                                                                                       Ï„           
                  (5)                   TÏ„ (U ; k) = x âˆˆ U : |U | â‰¤ k B x,                                         .
                                                                                                 12C(log k)    Îµ
                  Then there exists a 1-Lipschitz map Î³U,k : X â†’ L2 such that
                                                                                                   Ï„
                                                        ||Î³U,k (x) âˆ’ Î³U,k (y)||2 â‰¥
                                                                                           30C(log k)Îµ
                  whenever x âˆˆ TÏ„ (U ; k), y âˆˆ X and d(x, y) âˆˆ [Ï„, 2Ï„ ].
                  Proof. Let S be a uniformly random subset S âŠ† U with |S| = min{|U |, k}. Let
                  hS : X â†’ L2 be the map deï¬ned by hS = âˆš12 (Ï•S,Ï„ /2 âŠ• g) where g(x) = d(x, S).
                  Deï¬ne Î³U,k : X â†’ L2 (L2 , Âµ), where Âµ is the distribution of the random subset S,
                  by Î³U,k (x) = hS (x) (recall that hS (x) is a random element of L2 ). Note that Î³U,k
                  is 1-Lipschitz because the same is true for each hS .
                       Let L = 2C(log |S|)Îµ . Observe that, by the deï¬nition of TÏ„ (U ; k), with proba-
                  bility at least 1/e, we have
                                                          Ï„                                             
                                                                                                 Ï„
                                              S âˆ© B x,                  = S âˆ© B x,                            = âˆ….
                                                               6L                        12C(log k)Îµ
                  Assuming this holds, we see that d(x, S) â‰¤                          Ï„
                                                                                     6L .   Thus by Lemma 4.2,
                                                                                                Ï„
                                                                ||hS (x) âˆ’ hS (y)||2 â‰¥              .
                                                                                               9L
                  It follows that
                                                                                   1      Ï„                Ï„
                                             ||Î³U,k (x) âˆ’ Î³U,k (y)||2 â‰¥ âˆš Â·                    â‰¥                    .
                                                                                    e 9L            30C(log k)Îµ
                                                                                                                                        
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                                             EUCLIDEAN DISTORTION AND THE SPARSEST CUT                                           11
                       In what follows we shall use the fact that for every Ï„ > 0 there exists a mapping
                  GÏ„ : L2 â†’ L2 such that for every x, y âˆˆ L2 ,
                                                           GÏ„ (x)2 = GÏ„ (y)2 = Ï„                and
                  (6)               1
                                    2 min{Ï„, x âˆ’ y2 } â‰¤ GÏ„ (x) âˆ’ GÏ„ (y)2 â‰¤ min{Ï„, x âˆ’ y2 }.
                  The existence of GÏ„ is precisely Lemma 5.2 in [33]. As in [24], we will use the map
                  GÏ„ to control the Lipschitz constant of various functions under partitions of unity.
                       For K â‰¥ 1 and Ï„ â‰¥ 0, deï¬ne
                                                                                                                   
                                                                                                             Ï„         
                                  SÏ„ (K) = x âˆˆ X : |B (x, 8Ï„ Î±X )| â‰¤ K B x,                                            .
                                                                                                      12C(log K)   Îµ
                  Thus SÏ„ (K) can be viewed as the set of points in X with controlled â€œvolume growthâ€
                  at scale â‰ˆ Ï„ . These sets will play a key role in the ensuing arguments.
                  Lemma 4.4 (Localization). Assume that X satisï¬es the conditions of Theorem 4.1.
                  Then for every Ï„ â‰¥ 0, k â‰¥ 1, there exists a 1-Lipschitz map Î›Ï„,k : X â†’ L2 such
                  that for every x âˆˆ SÏ„ (k), y âˆˆ X with d(x, y) âˆˆ [Ï„, 3Ï„ ],
                                                                                                  Ï„
                                                      ||Î›Ï„,k (x) âˆ’ Î›Ï„,k (y)||2 â‰¥                            .
                                                                                         240C(log k)Îµ
                  Proof. Let D = 4Ï„ Î±X and take PD to be a random partition from the Î±X -padded
                  bundle ensured by Deï¬nition 3.3. Deï¬ne a random mapping Ï : X â†’ R by
                                                                                                      
                                                                                d(z, X \ PD (z))
                                                         Ï(z) = min 1,                                    .
                                                                                          Ï„
                  Clearly ÏLip â‰¤ 1/Ï„ . For each U âˆˆ PD , let Î³U,k be the corresponding map from
                  Lemma 4.3. Finally, deï¬ne a random map Î›Ï„,k : X â†’ L2 by
                                                             Î›Ï„,k (z) = 12 Ï(z) Â· Î³   PD (z),k (z),
                  where for f : X â†’ L2 we write f = GÏ„ â—¦ f , where GÏ„ is as in (6).
                       We claim that Î›Ï„,k Lip â‰¤ 1. Indeed, ï¬x u, v âˆˆ X. If PD (u) = PD (v) = U , then
                             ||Î›Ï„,k (u) âˆ’ Î›Ï„,k (v)||2
                                    â‰¤ 12 |Ï(u) âˆ’ Ï(v)| Â· ||       Î³PD (u),k (u)||2 + 12 ||  Î³U,k (u) âˆ’ Î³  U,k (v)||2 Â· |Ï(v)|
                                    â‰¤ 12 (Ï„ ||Ï||Lip + ||     Î³U,k ||Lip ) d(u, v)
                                    â‰¤ d(u, v).
                  Otherwise, assume that PD (u) = PD (v). In particular,
                                            d(u, v) â‰¥ max{d(u, X \ PD (u)), d(v, X \ PD (v))}.
                  It follows that
                               ||Î›Ï„,k (u) âˆ’ Î›Ï„,k (v)||2           â‰¤ ||Î›Ï„,k (u)||2 + ||Î›Ï„,k (v)||2
                                                                         d(u, X \ PD (u))                d(v, X \ PD (v))
                                                                  â‰¤                              Â·Ï„ +                       Â·Ï„
                                                                                 2Ï„                             2Ï„
                                                                  â‰¤ d(u, v).
                       Now suppose that x âˆˆ SÏ„ (k), y âˆˆ X, and d(x, y) âˆˆ [Ï„, 3Ï„ ]. Observe that since
                  diam(PD (x)) â‰¤ D, we have PD (x) âŠ† B(x, 2D). It follows that since x âˆˆ SÏ„ (k), we
                  have x âˆˆ TÏ„ (PD (x); k) (recall equation (5)). Moreover, using the deï¬ning property
                  of the Î±X -padded bundle, with probability at least 12 , we have d(x, X \PD (x)) â‰¥ 5Ï„ .
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                  12                         SANJEEV ARORA, JAMES R. LEE, AND ASSAF NAOR
                  Since we are assuming that d(x, y) â‰¤ 3Ï„ , this implies that Ï(x) = Ï(y) = 1. It
                  follows that
                           E ||Î›Ï„,k (x) âˆ’ Î›Ï„,k (y)||2             â‰¥                Î³PD (x),k (x) âˆ’ Î³
                                                                         2 Â· 2 E ||
                                                                         1 1
                                                                                                       PD (x),k (y)||2
                                                                                                                           
                                                                  â‰¥      8 E min ||Î³PD (x),k (x) âˆ’ Î³PD (x),k (y)||2 , Ï„
                                                                         1
                                                                                Ï„
                                                                  â‰¥                        .
                                                                         240C(log k)Îµ
                  Denoting by (â„¦, Âµ) the probability space on which Î›Ï„,k is deï¬ned, we can think of
                  Î›Ï„,k as a mapping of X into the Hilbert space L2 (L2 , Âµ) which has the required
                  properties.                                                                                                       
                       The following theorem is a generalization of the Gluing Lemma in [24]. In
                  particular, it is important for us that part (2) treat x and y symmetrically, unlike
                  in [24].
                  Theorem 4.5 (Inter-scale gluing). Given any n-point metric space (X, d) and
                  constants A, B â‰¥ 1, and for every m âˆˆ Z, a 1-Lipschitz map Ï†m : X â†’ L2 , there
                  exists a map Ï• : X â†’ L2 which satisï¬es the following.
                                                  
                        (1) ||Ï•||Lip â‰¤ O( log n log(AB)).
                        (2) For every x, y âˆˆ X we have
                                                                                                 m                           
                                                                    |B(x, 2m+1 A)|                    2
                  ||Ï•(x)âˆ’Ï•(y)||2 â‰¥ max                         log                          Â· min          , ||Ï†m (x) âˆ’ Ï†m (y)||2    .
                                              mâˆˆZ                    |B(x, 2m /B)|                     B
                  Proof. Let Ï : X â†’ R+ be any 2B-Lipschitz map with Ï â‰¡ 1 on [1/B, 2A] and
                  Ï â‰¡ 0 outside [1/2B, 4A]. For x âˆˆ X and t â‰¥ 0, deï¬ne
                                                         R(x, t) = sup{R : |B(x, R)| â‰¤ 2t },
                  and observe that R(Â·, t) is 1-Lipschitz for every value of t. Furthermore, for each
                  m âˆˆ Z, deï¬ne
                                                                                               
                                                                                     R(x, t)
                                                                 Ïm,t (x) = Ï                     .
                                                                                        2m
                  Write Ï†m = G2m /B â—¦ Ï†m , where G2m /B is as in (6). Now, for each t âˆˆ {1, 2, . . . ,
                  log2 n}, deï¬ne Ïˆt : X â†’ 2 (L2 ),
                                                                           
                                                             Ïˆt (x) =           Ïm,t (x) Â· Ï†m (x).
                                                                           mâˆˆZ
                  Finally, let Ï• = Ïˆ1 âŠ• Ïˆ2 âŠ• Â· Â· Â· âŠ• Ïˆlog2 n .
                       First, we bound ||Ïˆt ||Lip as follows.
                                                                  
                        ||Ïˆt (x) âˆ’ Ïˆt (y)||22 =                                 ||Ïm,t (x)Ï†m (x) âˆ’ Ïm,t (y)Ï†m (y)||22 .
                                                                  mâˆˆZ
                                                        Ïm,t (x)+Ïm,t (y)>0
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                                             EUCLIDEAN DISTORTION AND THE SPARSEST CUT                                               13
                  The number of non-zero summands above is at most O(log A+log B). Furthermore,
                  each summand can be bounded as follows.
                                ||Ïm,t (x)Ï†m (x) âˆ’ Ïm,t (y)Ï†m (y)||2
                                       â‰¤ ||Ï†m (x)||2 |Ïm,t (x) âˆ’ Ïm,t (y)| + ||Ï†m (x) âˆ’ Ï†m (y)||2 |Ïm,t (y)|
                                                                                    
                                                                2m
                                       â‰¤ ||Ïm,t ||Lip Â·               + ||Ï†m ||Lip d(x, y)
                                                                 B
                                       â‰¤ 4 d(x, y).
                                                                                                             
                  Thus ||Ïˆt ||Lip â‰¤ O( log(AB)). It follows that ||Ï•||Lip â‰¤ O( log n log(AB)), as
                  claimed.
                       It remains to prove the lower bound. To this end, ï¬x m âˆˆ Z, x, y âˆˆ X and
                  observe that if Ïm,t (x) = 1, then
                      ||Ïˆt (x) âˆ’ Ïˆt (y)||2          â‰¥ Ï†m (x) âˆ’ Ï†m (y)||2 âˆ’ (1 âˆ’ Ïm,t (y)) Â· Ï†m (y)2
                                                                      m                                 
                                                            1           2                                    2m
                  (7)                               â‰¥          min           , ||Ï†m (x) âˆ’ Ï†m (y)||2 âˆ’             Â· (1 âˆ’ Ïm,t (y)).
                                                            2            B                                    B
                  On the other hand
                         ||Ïˆt (x) âˆ’ Ïˆt (y)||2           â‰¥ Ï†m (x) âˆ’ Ïm,t (y)Ï†m (y)2
                                                                                                            2m
                  (8)                                   â‰¥ Ï†m (x)2 âˆ’ Ïm,t (y)Ï†m (y)2 =                    Â· (1 âˆ’ Ïm,t (y)).
                                                                                                            B
                  Averaging (7) and (8), we get that
                                                                                                              
                                                                      1           2m
                  (9)                ||Ïˆt (x) âˆ’ Ïˆt (y)||2 â‰¥             min          , ||Ï†m (x) âˆ’ Ï†m (y)||2 .
                                                                      4           B
                  Hence it suï¬ƒces to count the number of values of t for which Ïm,t (x) = 1. By our
                  deï¬nitions we have that
                                                                  2m
                                     Ïm,t (x) = 1 â‡â‡’                    â‰¤ R(x, t) â‰¤ 2m+1 A
                                                                   B
                                                         â‡â‡’ t âˆˆ [log |B(x, 2m /B)|, log |B(x, 2m+1 A)|].
                                                                                                                 
                                                                                                                       |B(x,2m+1 A)|
                  This completes the proof since the lower bound (9) holds for log                                      |B(x,2m /B)|
                  values of t.                                                                                                       
                       We also present the following base case which is a variant of Bourgainâ€™s argu-
                  ment [8].
                  Claim 4.6 (Small ratios). Let X be an n-point metric âˆš                               space, and let Î» â‰¥ 1. Then
                  there exists a map F : X â†’ L2 with F Lip = O( log n) and such that the
                  following holds. For each Ï„ > 0, deï¬ne the subset
                                               JÎ» (Ï„ ) = {x âˆˆ X : |B(x, Ï„ /2)| â‰¤ Î»|B(x, Ï„ /4)|} .
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                  14                         SANJEEV ARORA, JAMES R. LEE, AND ASSAF NAOR
                  Then for every x, y âˆˆ X with x âˆˆ JÎ» (Ï„ ) and d(x, y) â‰¥ Ï„ , we have
                                                                ||F (x) âˆ’ F (y)||2 â‰¥ (Î»)Ï„,
                  where (Î») > 0 is a constant depending only on Î».
                  Proof. For each t âˆˆ {1, 2, . . . , log n}, let Wt âŠ† X be a random subset which
                  contains each point of X independently with probability 2âˆ’t . Let gt (x) = d(x, Wt ),
                  and consider the random map f = g1 âŠ• Â· Â· Â· âŠ• glog n âˆˆ n2 . Finally, we deï¬ne
                  F : X â†’ L2 (n2 , Âµ) by F (x) = f (x), where Âµ is the distribution                           âˆš        which the
                                                                                                                       over
                  random subsets {Wt } are deï¬ned. Observe that F Lip â‰¤ O log n .
                       Fix x, y âˆˆ X such that d(x, y) â‰¥ Ï„ and x âˆˆ JÎ» (Ï„ ). Let t âˆˆ N be such that
                  2t â‰¤ |B(x, Ï„ /2)| â‰¤ 2t+1 . Let Efar be the event {d(x, Wt ) â‰¥ Ï„ /2} and let Eclose
                                                                                                         y
                  be the event {d(x, Wt ) â‰¤ Ï„ /4}. Also, deï¬ne the event Eclose                                 = {d(y, Wt ) < Ï„ /2}.
                                                                                                                y
                  Observe that each of the events Eclose , Efar are independent of Eclose                             since the former
                  events depend only on Wt âˆ© B â—¦ (x, Ï„ /2), and the latter on Wt âˆ© B â—¦ (y, Ï„ /2), where
                  B â—¦ (Â·, Â·) denotes an open ball in X. It follows that
                  F (x) âˆ’ F (y)2L2 (Âµ)
                                                   2
                     = EÂµ f (x) âˆ’ f (y)2
                                                   2
                     â‰¥ EÂµ |gt (x) âˆ’ gt (y)|2
                                                                                           2                                       Ï„ 2
                                 y                                                 1 Ï„                     y
                     â‰¥   Pr(Eclose    ) Â· min Pr(Efar ), Pr(Eclose ) Â·                   Â·       + Pr(Â¬Eclose     ) Â· Pr(Eclose ) Â·
                                                                                     2 4                                              4
                     â‰¥ (Î»)Ï„ 2 .
                  The ï¬nal inequality holds true because x âˆˆ JÎ» (Ï„ ) implies that each of Pr(Efar ) and
                  Pr(Eclose ) can be bounded from below by some  (Î») > 0.                                                             
                       We are now in position to conclude the proof of Theorem 4.1
                  Proof of Theorem 4.1. We claim that for every K âˆˆ [2, n] there exists a map fK :
                  X â†’ L2 which satisï¬es the following.
                                                     âˆš
                        (1) ||fK ||Lip â‰¤ O( log n Â· log log n).
                        (2) For every m âˆˆ Z and x âˆˆ S2m (K), y âˆˆ X we have
                                                                                                           
                                                                              |B(x, 2m+3 Î±X )|                        22m
                               ||fK (x) âˆ’ fK (y)||22  log                                                    Â·                .
                                                                        |B(x, 2m /[12C(log K)Îµ ])|              C 2 (log K)2Îµ
                  Indeed, fK is obtained from an application of Theorem 4.5 to the mappings
                  {Î›2m ,K }mâˆˆZ from Lemma 4.4 with A = 4Î±X and B = 12C(log K)Îµ (and using
                  the fact that Î±X = O(log n)).
                       Observe    that for every m âˆˆ Z, S2m (n) = X. Hence, deï¬ning K0 = n and
                  Kj+1 =            Kj , as long as Kj â‰¥ 4, we obtain mappings f0 , . . . , fj : X â†’ L2
                  satisfying the following.
                                                   âˆš
                        (1) fj Lip â‰¤ O( log n Â· log log n).
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                                             EUCLIDEAN DISTORTION AND THE SPARSEST CUT                                            15
                        (2) For all x âˆˆ S2m (Kj ) \ S2m (Kj+1 ) and y âˆˆ X such that d(x, y) âˆˆ [2m , 2m+1 ]
                                we have
                                                                                                           
                                                                             |B(x, 2m+3 Î±X )|                       22m
                           ||fj (x) âˆ’ fj (y)||22                log                                          Â· 2
                                                                       |B(x, 2 /[12C(log Kj ) ])|
                                                                                m                      Îµ        C (log Kj )2Îµ
                                                                                                              
                                                                               |B(x, 2m+3 Î±X )|                     d(x, y)2
                  (10)                                          log                                             Â· 2
                                                                       |B(x, 2 /[12C(log Kj+1 ) ])|
                                                                                m                         Îµ       C (log Kj )2Îµ
                                                                                    d(x, y)2
                  (11)                                   log Kj+1  Â· 2
                                                                                C (log Kj )2Îµ
                                                                     d(x, y)2
                  (12)                                                              ,
                                                               C 2 (log Kj )2Îµâˆ’1
                  where in (10) we used the fact that Kj+1 â‰¤ Kj and d(x, y) â‰¤ 2m+1 , in (11)                               we used
                  the fact that x âˆˆ       / S2m (Kj+1 ), and in (12) we used the fact that Kj+1 = Kj â‰¥ 2.
                       This procedure ends after N steps, where N â‰¤ O(log log n). Every x âˆˆ S2m (KN )
                  satisï¬es
                                                      |B(x, 2m+3 Î±X )| â‰¤ 4|B(x, 2m /[12C])|.
                  In particular, using the notation of Claim 4.6, x âˆˆ J4 (2m ). ByâˆšClaim 4.6, there is a
                  mapping fN +1 : X â†’ L2 which is Lipschitz with constant O( log n) and for every
                  x, y âˆˆ S2m (KN ) âŠ† J4 (2m ), fN +1 (x) âˆ’ fN +1 (y)2  d(x, y).
                       Consider the map
                                                                                
                                                                                N +1
                                                                           Î¦=          fj ,
                                                                                j=0
                                                                           âˆš                      
                  which is Lipschitz with constant O log n Â· log log n . For every x, y âˆˆ X choose
                  m âˆˆ Z such that d(x, y) âˆˆ [2m , 2m+1 ]. If x, y âˆˆ S2m (KN ), then
                                          Î¦(x) âˆ’ Î¦(y)2 â‰¥ fN +1 (x) âˆ’ fN +1 (y)2  d(x, y).
                  Otherwise, without loss of generality there is j âˆˆ {0, . . . , N âˆ’ 1} such that x âˆˆ
                  S2m (Kj ) \ S2m (Kj+1 ), in which case by (12)
                                                                                                 d(x, y)             d(x, y)
                          Î¦(x) âˆ’ Î¦(y)2 â‰¥ fj+1 (x) âˆ’ fj+1 (y)2                                           1  â‰¥             1 .
                                                                                            C(log Kj     )Îµâˆ’ 2    C(log n)Îµâˆ’ 2
                                                                                                                                  
                                   5. The sparsest cut problem with general demands
                       This section is devoted to the proof of Theorem 1.2. Our argument follows the
                  well known approach for deducing the algorithmic Theorem 1.2 from the embedding
                  result contained in Theorem 1.1 (see e.g. [29, 6, 17]).
                  5.1. Computing the Euclidean distortion. In this section, we remark that
                  the maps used to prove Theorem 1.1 have a certain â€œauto-extendabilityâ€ property
                  which will be used in the next section. We also recall that it is possible to ï¬nd
                  near-optimal Euclidean embeddings using semi-deï¬nite programming [29].
                  Corollary 5.1. Let (Y, d) be an arbitrary metric space, and ï¬x a k-point sub-
                  set X âŠ† Y . If the space (X, d) is a metric of negative type, then there exists a
                  1-Lipschitz
                      âˆš             map f : Y â†’ L2 such that the map f |X : X â†’ L2 has distortion
                  O log k Â· log log k .
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                  16                         SANJEEV ARORA, JAMES R. LEE, AND ASSAF NAOR
                  Proof. We observe that the maps used to prove Theorem 1.1, i.e. those produced in
                  Lemma 3.5 and Claim 4.6, are of FreÌchet-type. In other words, there is a probability
                  space (â„¦, Âµ) over subsets AÏ‰ âŠ† X for Ï‰ âˆˆ â„¦, and we obtain a maps Ï•S,Ï„ : X â†’
                  L2 (Âµ) given by Ï•S,Ï„ (x)(Ï‰) = d(x, AÏ‰ ). We can then deï¬ne the extension Ï•S,Ï„ :
                  Y â†’ L2 (Âµ) by
                                                                  Ï•S,Ï„ (y)(Ï‰) = d(y, AÏ‰ ).
                  Thus by extending the ensemble of maps {Ï•S,Ï„ } to the larger space Y before the
                  application of Theorem 4.1, we can ensure that the ï¬nal embedding is 1-Lipschitz
                  on Y .                                                                                           
                       Now we suppose that (Y, d) is an n-point metric space and X âŠ† Y is a k-point
                  subset.
                  Claim 5.2. There exists a polynomial-time algorithm (in terms of n) which, given
                  X and Y , computes a map f : Y â†’ L2 such that f |X has minimal distortion among
                  all 1-Lipschitz maps f .
                  Proof. We give a semi-deï¬nite program computing the optimal f , which can be
                  solved within an arbitrarily small error in polynomial time using the methods of [18].
                                                              SDP (5.1)
                                           max                Îµ
                                             s.t.             xu âˆˆ R n                                  âˆ€u âˆˆ Y,
                                                              xu âˆ’ xv 22 â‰¤ d(u, v)2                   âˆ€u, v âˆˆ Y,
                                                              xu âˆ’ xv 22 â‰¥ Îµ d(u, v)2                 âˆ€u, v âˆˆ X.
                                                                                                                   
                  5.2. The Sparsest Cut. Let V be an n-point set with two symmetric weights on
                  pairs wN , wD : V Ã— V â†’ R+ (i.e. wN (x, y) = wN (y, x) and wD (x, y) = wD (y, x)).
                  For a subset S âŠ† V , we deï¬ne the sparsity of S by
                                                                             
                                                                                uâˆˆS,vâˆˆV \S wN (u, v)
                                                       Î¦wN ,wD (S) =                                       ,
                                                                                uâˆˆS,vâˆˆV \S wD (u, v)
                  and we let Î¦âˆ— (V, wN , wD ) = minSâŠ†V Î¦wN ,wD (S). (The set V is usually thought of
                  as the vertex set of a graph with wN (u, v) supported only on edges (u, v), but this
                  is unnecessary since we allow arbitrary weight functions.)
                       Computing the value of Î¦âˆ— (V, wN , wD ) is NP-hard [32]. The following semi-
                  deï¬nite program is well known to be a relaxation of Î¦âˆ— (V, wN , wD ) (see e.g. [17]).
                                                        SDP (5.2)
                                                        
                                                            u,vâˆˆV wN (u, v) xu âˆ’ xv 2
                                                                                                2
                                             min
                                                        u âˆˆ R                   âˆ€u âˆˆ V
                                                                  n
                                              s.t. x
                                                            u,vâˆˆV wD (u, v) xu âˆ’ xv 2 = 1,
                                                                                                2
                                                        xu âˆ’ xv 2 â‰¤ xu âˆ’ xw 2 + xw âˆ’ xv 22
                                                                       2                    2
                                                                                 âˆ€u, v, w âˆˆ V.
                  Furthermore, an optimal solution to this SDP can be computed in polynomial
                  time [18, 17].
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                                                EUCLIDEAN DISTORTION AND THE SPARSEST CUT                                          17
                  The algorithm. We now give our algorithm for rounding SDP (5.2). Suppose
                  that the weight function wD is supported only on pairs u, v for which u, v âˆˆ U âŠ† V ,
                  and let k = |U |. Denote M = 20 log n.
                        (1) Solve SDP (5.2), yielding a solution {xu }uâˆˆV âŠ† Rn .
                        (2) Consider the metric space (V, d) given by d(u, v) = xu âˆ’ xv 22 .
                        (3) Applying SDP (5.1) to U and (V, d) (where Y = V and X = U ), compute
                                the optimal map f : V â†’ Rn .
                        (4) Choose Î²1 , . . . , Î²M âˆˆ {âˆ’1, +1}n independently and uniformly at random.
                        (5) For each 1 â‰¤ i â‰¤ M , arrange the points of V as v1i , . . . , vni so that
                                               Î²i , f (vji ) â‰¤ Î²i , f (vj+1 i
                                                                                   ) for each 1 â‰¤ j â‰¤ n âˆ’ 1.
                        (6) Output the sparsest of the M n cuts
                               ({v1i , . . . , vmi
                                                   }, {vm+1
                                                          i
                                                               , . . . , vni }),      1 â‰¤ m â‰¤ n âˆ’ 1, 1 â‰¤ i â‰¤ M.
                  Claim 5.3. With constant probability over the choice of Î²1 , . . . , Î²M , the cut (S,
                  V \ S) returned by the algorithm has
                                                                                            
                  (13)                        Î¦wN ,wD (S) â‰¤ O                 log k log log k Î¦âˆ— (V, wN , wD ).
                  Proof. Let S âŠ† Rn be the image of V under the map f . Consider the map g : S â†’
                   1 given by g(x) = (Î²1 , x, . . . , Î²M , x). It is well known (see, e.g. [1, 34]) that,
                  M
                  with constant probability over the choice of {Î²i }M                        i=1 âŠ† S
                                                                                                        nâˆ’1
                                                                                                             , g has distortion O(1)
                  (where S is equipped with the Euclidean metric). In this case, we claim that (13)
                  holds.
                       To see this, let S1 , S2 , . . . , SM n âŠ† V be the M n cuts which are tested in line (6).
                  It is a standard fact [29, 13] that there exist constants Î±1 , Î±2 , . . . , Î±M n â‰¥ 0 such
                  that for every x, y âˆˆ V ,
                                                                                          
                                                                                          Mn
                                                      ||g(f (x)) âˆ’ g(f (y))||1 =              Î±i ÏSi (x, y),
                                                                                          i=1
                  where ÏSi (x, y) = 1 if x and y are on opposite sides of the cut (Si , V \ Si ) and
                  ÏSi (x, y) = 0 otherwise.
                       Assume (by scaling) that g â—¦ f : Yâˆšâ†’ M                      1 is 1-Lipschitz.
                                                                                                            Let Î› be the distortion
                  of g â—¦ f . By Corollary 5.1, Î› = O log k log log k . Recalling that wD (u, v) > 0
                  only when u, v âˆˆ U ,
                                                                      
                                                                          u,vâˆˆV wN (u, v)xu âˆ’ xv 2
                                                                                                           2
                                     âˆ—
                                   Î¦ (V, wN , wD ) â‰¥ 
                                                                          u,vâˆˆU wD (u, v)xu âˆ’ xv 2
                                                                                                           2
                                                                         
                                                                      1 u,vâˆˆV wN (u, v) ||g(f (u)) âˆ’ g(f (v))||1
                                                               â‰¥          
                                                                      Î› u,vâˆˆU wD (u, v) ||g(f (u)) âˆ’ g(f (v))||1
                                                                         M n 
                                                                      1 i=1 Î±i u,vâˆˆV wN (u, v)ÏSi (u, v)
                                                               =           n 
                                                                      Î› M     i=1 Î±i    u,vâˆˆU wD (u, v)ÏSi (u, v)
                                                                                 
                                                                      1            u,vâˆˆV wN (u, v)ÏSi (u, v)
                                                               â‰¥          min 
                                                                      Î› i          u,vâˆˆU wD (u, v)ÏSi (u, v)
                                                                      Î¦wN ,wD (S)
                                                               =                      .
                                                                              Î›
                  This completes the proof.                                                                                        
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                  18                         SANJEEV ARORA, JAMES R. LEE, AND ASSAF NAOR
                                                              6. Concluding remarks
                                                                            âˆš
                            â€¢   There are two factors of O( log log n) which keep                         âˆš our bound from being
                                optimal up to a constant factor. One factor of log log n arises because
                                Theorem 4.5 is applied with A, B âˆ¼ polylog(n). The need for such values
                                arises out of a certain non-locality property which seems inherent to the
                                method of proof in [5]. We remark that achieving A = O(1) is probably
                                possible, and it seems that B is the diï¬ƒcult factor.
                                    The other factor arises because, in proving Theorem 1.1, we invoke The-
                                orem 4.5 for O(log log n) diï¬€erent values of the parameter K. It is likely
                                removable by a more technical induction, but we chose to present the sim-
                                pler proof.
                            â€¢   The embedding constructed here is not a FreÌchet embedding, i.e. an em-
                                bedding whose coordinates are multiples of distance functions from subsets
                                of X. However, with more work it is possible to obtain FreÌchet embeddings
                                with the same distortion guaranteeâ€”this is achieved in [4].
                            â€¢   It is an interesting open problem to understand the exact distortion required
                                to embed n-point negative type metrics into L1 . As mentioned, the best-
                                known lowerbound is â„¦(log log n) [21, 23]. We also note that assuming a
                                strong form of the Unique Games Conjecture is true, the general Sparsest
                                Cut problem is hard to approximate within a factor of â„¦ (log log n) [12,                  âˆš 21].
                            â€¢   For the uniform case of Sparsest Cut, it is possible to achieve a O( log n)
                                approximation in quadratic time without solving an SDP [3]. Whether such
                                an algorithm exists for the general case is an open problem.
                            â€¢   There is no asymptotic advantage in embedding n-point negative type met-
                                rics into Lp for some p âˆˆ (1, âˆ), p = 2 (observe that since L2 is isometric
                                to a subset of Lp for all p â‰¥ 1, our embedding into Hilbert space is auto-
                                matically also an embedding into Lp ). Indeed, for 1 < p < 2 it is shown
                                in [26] that there  are arbitrarily large n-point subsets of L1 that require
                                distortion â„¦( (p âˆ’ 1) log n) in any embedding into Lp . For 2 < p < âˆ
                                it follows from [37, 35] that there are arbitrarily                    large n-point subsets of
                                                                                                            log n
                                L1 whose minimal distortion into Lp is 1 + Î˜                                  p   (the dependence
                                on n follows from [37], and the optimal dependence on p follows from the
                                results of [35]). Thus, up to multiplicative constants depending on p (and
                                the double logarithmic factor in Theorem 1.1), our result is optimal for all
                                p âˆˆ (1, âˆ).
                            â€¢ Let (X, dX ), (Y, dY ) be metric spaces and Î· : [0, âˆ) â†’ [0, âˆ) a strictly
                                increasing function. A one-to-one mapping f : X â†’ Y is called a qua-
                                sisymmetric embedding with modulus Î· if for every x, a, b âˆˆ X such that
                                x = b,
                                                                                                     
                                                          dY (f (x), f (a))              dX (x, a)
                                                                                â‰¤Î·                       .
                                                          dY (f (x), f (b))              dX (x, b)
                                We refer to [19] for an account of the theory of quasisymmetric embed-
                                dings. Observe that metrics of negative type embed quasisymmetrically
                                into Hilbert space. It turns out that our embedding result generalizes to
                                any n-point metric space which embeds quasisymmetrically into Hilbert
                                space. Indeed, if (X, d) embeds quasisymmetrically into L2 with modulus
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                                             EUCLIDEAN DISTORTION AND THE SPARSEST CUT                              19
                                Î·, then, as shown in the full version of [24], there exists constants       âˆš p = p(Î·)
                                and C = C(Î·), depending only on Î·, such that Î¶(X; p) â‰¤ C log n.
                                                                 Acknowledgements
                       We thank Satish Rao for useful discussions.
                                                                         References
                   [1] D. Achlioptas. Database-friendly random projections: Johnson-Lindenstrauss with binary
                         coins. J. Comput. System Sci., 66(4):671â€“687, 2003. Special issue on PODS 2001 (Santa
                         Barbara, CA). MR2005771 (2004h:68027)
                   [2] A. Agrawal, P. Klein, R. Ravi, and S. Rao. Approximation through multicommodity ï¬‚ow. In
                         31st Annual Symposium on Foundations of Computer Science, pages 726â€“737. IEEE Com-
                         puter Soc., Los Alamitos, CA, 1990. MR1150728 (92j:90031)
                                                                            âˆš
                   [3] S. Arora, E. Hazan, and S. Kale. O( log n) approximation to SPARSEST CUT in OÌƒ(n2 )
                         time. In 45th Annual Syposium on Foundations of Computer Science, pages 238â€“247. IEEE
                         Computer Society, 2004.
                   [4] S. Arora, J. R. Lee, and A. Naor. FreÌchet embeddings of negative type metrics. Preprint,
                         2005.
                   [5] S. Arora, S. Rao, and U. Vazirani. Expander ï¬‚ows, geometric embeddings, and graph par-
                         titionings. In 36th Annual Symposium on the Theory of Computing, pages 222â€“231, 2004.
                         MR2121604 (2005j:68081)
                   [6] Y. Aumann and Y. Rabani. An O(log k) approximate min-cut max-ï¬‚ow theorem and ap-
                         proximation algorithm. SIAM J. Comput., 27(1):291â€“301 (electronic), 1998. MR1614825
                         (99d:05078)
                   [7] Y. Bartal. Probabilistic approximations of metric space and its algorithmic application. In
                         37th Annual Symposium on Foundations of Computer Science, pages 183â€“193, Oct. 1996.
                         MR1450616
                   [8] J. Bourgain. On Lipschitz embedding of ï¬nite metric spaces in Hilbert space. Israel J. Math.,
                         52(1-2):46â€“52, 1985. MR815600 (87b:46017)
                   [9] B. Brinkman and M. Charikar. On the impossibility of dimension reduction in 1 . In Pro-
                         ceedings of the 44th Annual IEEE Conference on Foundations of Computer Science, pages
                         514â€“523, 2003.
                  [10] G. Calinescu, H. Karloï¬€, and Y. Rabani. Approximation algorithms for the 0-extension prob-
                         lem. In Proceedings of the 12th Annual ACM-SIAM Symposium on Discrete Algorithms,
                         pages 8â€“16, Philadelphia, PA, 2001. MR1958386
                  [11] S. Chawla, A. Gupta, and H. RaÌˆcke. Embeddings of negative-type metrics and an improved
                         approximation to generalized sparsest cut. In Proceedings of the 16th Annual ACM-SIAM
                         Symposium on Discrete Algorithms, pages 102â€“111, Vancouver, 2005.
                  [12] S. Chawla, R. Krauthgamer, R. Kumar, Y. Rabani, and D. Sivakumar. On embeddability
                         of negative type metrics into 1 . In Proceedings of the 20th Annual IEEE Conference on
                         Computational Complexity, pages 144â€“153, 2005.
                  [13] M. M. Deza and M. Laurent. Geometry of cuts and metrics, volume 15 of Algorithms and
                         Combinatorics. Springer-Verlag, Berlin, 1997. MR1460488 (98g:52001)
                  [14] P. Enï¬‚o. On the nonexistence of uniform homeomorphisms between Lp -spaces. Ark. Mat.,
                         8:103â€“105, 1969. MR0271719 (42:6600)
                  [15] J. Fakcharoenphol, S. Rao, and K. Talwar. A tight bound on approximating arbitrary metrics
                         by tree metrics. In Proceedings of the 35th Annual ACM Symposium on Theory of Computing,
                         pages 448â€“455, 2003. MR2120458 (2005j:68142)
                  [16] T. Figiel, J. Lindenstrauss, and V. D. Milman. The dimension of almost spherical sections of
                         convex bodies. Acta Math., 139(1-2):53â€“94, 1977. MR0445274 (56:3618)
                  [17] M. X. Goemans. Semideï¬nite programming and combinatorial optimization. Mathematical
                         Programming, 49:143â€“161, 1997. MR1464765 (98g:90028)
                  [18] M. GroÌˆtschel, L. L. LovaÌsz, and A. Schrijver. The ellipsoid method and its consequences in
                         combinatorial optimization. Combinatorica, 1:169â€“197, 1981. MR625550 (84a:90044)
                  [19] J. Heinonen. Lectures on analysis on metric spaces. Universitext. Springer-Verlag, New York,
                         2001. MR1800917 (2002c:30028)
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                  20                         SANJEEV ARORA, JAMES R. LEE, AND ASSAF NAOR
                  [20] W. B. Johnson and J. Lindenstrauss. Extensions of Lipschitz mappings into a Hilbert space.
                         In Conference in modern analysis and probability (New Haven, Conn., 1982), pages 189â€“206.
                         Amer. Math. Soc., Providence, RI, 1984. MR737400 (86a:46018)
                  [21] S. Khot and N. Vishnoi. The unique games conjecture, integrality gap for cut problems and
                         embeddability of negative type metrics into 1 . In Proceedings of the 46th Annual IEEE
                         Conference on Foundations of Computer Science, pages 53â€“62, 2005.
                  [22] R. Krauthgamer, J. R. Lee, M. Mendel, and A. Naor. Measured descent: a new embed-
                         ding method for ï¬nite metrics. Geom. Funct. Anal., 15(4):839â€“858, 2005. MR2221152
                         (2007f:68249)
                  [23] R. Krauthgamer and Y. Rabani. Improved lower bounds for embeddings into l1 . In Proceed-
                         ings of the 17th annual ACM-SIAM symposium on Discrete algorithm, pages 1010â€“1017.
                         ACM Press, 2006.
                  [24] J. R. Lee. On distance scales, embeddings, and eï¬ƒcient relaxations of the cut cone. In Proceed-
                         ings of the 16th Annual ACM-SIAM Symposium on Discrete Algorithms, pages 92â€“101, Van-
                         couver, 2005. Available at http://www.cs.washington.edu/homes/jrl/papers/soda05-full.pdf.
                  [25] J. R. Lee, M. Mendel, and A. Naor. Metric structures in L1 : dimension, snowï¬‚akes, and
                         average distortion. European J. Combin., 26(8):1180â€“1190, 2005. MR2163751 (2006g:46012)
                  [26] J. R. Lee and A. Naor. Embedding the diamond graph in Lp and dimension reduction in L1 .
                         Geom. Funct. Anal., 14(4):745â€“747, 2004. MR2084978 (2005g:46035)
                  [27] J. R. Lee and A. Naor. Extending Lipschitz functions via random metric partitions. Invent.
                         Math., 160(1):59â€“95, 2005. MR2129708 (2006c:54013)
                  [28] T. Leighton and S. Rao. Multicommodity max-ï¬‚ow min-cut theorems and their use in de-
                         signing approximation algorithms. J. ACM, 46(6):787â€“832, 1999. MR1753034 (2001e:05125)
                  [29] N. Linial, E. London, and Y. Rabinovich. The geometry of graphs and some of its algorithmic
                         applications. Combinatorica, 15(2):215â€“245, 1995. MR1337355 (96e:05158)
                  [30] N. Linial and M. Saks. Low diameter graph decompositions. Combinatorica, 13(4):441â€“454,
                         1993. MR1262920 (95d:05123)
                  [31] J. MatousÌŒek. Lectures on discrete geometry, volume 212 of Graduate Texts in Mathematics.
                         Springer-Verlag, New York, 2002. MR1899299 (2003f:52011)
                  [32] D. W. Matula and F. Shahrokhi. The maximum concurrent ï¬‚ow problem. J. ACM, 37(2):318â€“
                         334, 1990. MR1072261 (91j:90029)
                  [33] M. Mendel and A. Naor. Euclidean quotients of ï¬nite metric spaces. Adv. Math., 189(2):451â€“
                         494, 2004. MR2101227 (2005h:54031)
                  [34] V. D. Milman and G. Schechtman. Asymptotic theory of ï¬nite-dimensional normed spaces,
                         volume 1200 of Lecture Notes in Mathematics. Springer-Verlag, Berlin, 1986. With an ap-
                         pendix by M. Gromov. MR856576 (87m:46038)
                  [35] A. Naor, Y. Peres, O. Schramm, and S. Sheï¬ƒeld. Markov chains in smooth Banach spaces
                         and Gromov-hyperbolic metric spaces. Duke Math. J., 134(1):165â€“197, 2006. MR2239346
                  [36] A. Naor, Y. Rabani, and A. Sinclair. Quasisymmetric embeddings, the observable diameter,
                         and expansion properties of graphs. J. Funct. Anal., 227(2):273â€“303, 2005. MR2168076
                         (2006j:68092)
                  [37] A. Naor and G. Schechtman. Remarks on non linear type and Pisierâ€™s inequality. J. Reine
                         Angew. Math., 552:213â€“236, 2002. MR1940437 (2003j:46010)
                  [38] S. Rao. Small distortion and volume preserving embeddings for planar and Euclidean metrics.
                         In Proceedings of the 15th Annual Symposium on Computational Geometry, pages 300â€“306,
                         New York, 1999. MR1802217
                  [39] D. B. Shmoys. Cut problems and their application to divide-and-conquer. In Approximation
                         Algorithms for NP-hard Problems (D.S. Hochbaum, ed.), pages 192â€“235. PWS, 1997.
                  [40] V. V. Vazirani. Approximation algorithms. Springer-Verlag, Berlin, 2001. MR1851303
                         (2002h:68001)
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

                                             EUCLIDEAN DISTORTION AND THE SPARSEST CUT                      21
                       Department of Computer Science, Princeton University, 356 Olden Street, Prince-
                  ton, New Jersey 08544-2087
                       E-mail address: arora@cs.princeton.edu
                       Department of Mathematics, University of Washington, Seattle, Washington 98195
                       E-mail address: jrl@cs.washington.edu
                       Courant Institute of Mathematical Sciences, New York University, Warren Weaver
                  Hall 1305, 251 Mercer Street, New York, New York 10012
                       E-mail address: naor@cims.nyu.edu
License or copyright restrictions may apply to redistribution; see https://www.ams.org/journal-terms-of-use

