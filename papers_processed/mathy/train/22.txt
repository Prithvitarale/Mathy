OnProfit-MaximizingEnvy-freePricingVenkatesanGuruswami∗JasonD.Hartline†AnnaR.Karlin∗DavidKempe‡ClaireKenyon§FrankMcSherry†AbstractWestudytheproblemofpricingitemsforsaletoconsumerssoastomaximizetheseller’srevenue.Weassumethatforeachconsumer,weknowthemaximumamounthewouldbewillingtopayforeachbundleofitems,andwanttofindpricingsoftheitemswithcorrespondingallocationsthatmaximizesellerprofitandatthesametimeareenvy-free,whichisanaturalfairnesscriterionrequiringthatconsumersaremaximallyhappywiththeoutcometheyreceivegiventhepricing.Westudythisproblemfortwoimportantclassesofinputs:unitdemandconsumers,whowanttobuyatmostoneitemfromamongaselectionAninterestingspecialcaseofthesepricingproblemscanbeobtainedbyassumingthattheitemsareavailableinunlimitedsupply.Inthisspecialcase,thereisnolimitationonhowmanycopiesofeachitemaresold,andthusanypricingisenvy-freewhentheallocationistogiveeachconsumertheirmostpreferredbundle.Whenwewishtodistinguishtheunlimitedsupplycasefromthegeneralcasewewillrefertothegeneralcaseasthelimitedsupplycase.Aswewillshow,bothoftheseversionsarenotonlyNP-complete,butAPX-hard,evenunderstrongadditionalrestrictions.Wethereforefocusontwokindsofresults:(1)approximationalgorithmswithlogarithmicguaranteesinthegeneralcase,and(2)polynomialorpseudo-polynomialtimealgorithmsforinterestingspecialcases.WegiveanO(logn)approximationalgorithmforthelimitedsupplyunitdemandproblem,andanO(logn+logm)approximationfortheunlimitedsupplysingle-mindedbidderproblem.Furthermore,wedefineandgiveapolynomialtimealgorithmfortheunlimitedsupplypricingovertimevariantoftheunitdemandproblem.Thisproblemmodelsthecasewherethereisasingleitemforsaleatvariouspointsintimeandeachconsumerwantstoacquiretheitemwithinsometimeinterval(e.g.,forbandwidthorairlinetickets).Forthesingle-mindedcase,wedefineandinvestigate,inSection5.2,theTollboothproblemontrees,anditsspecialcase,theHighwayproblemonapath.Intheseproblems,consumersareinterestedinusingagivenpathinthetree(oronthepath),andthesellercanplacetollboothsontheedgesandchargepricesfortheirusage.Theadditionalcombinatorialstructureprovidedbythisrestrictionallowsustogivepolynomialtimealgorithmsforseveralcasesoftheseproblems.Theenvy-freepricingproblemalsohasaroleasalowerboundinthesettingofprofitmaximizingcombinatorialauc-tions.There,customers’valuationsareoftennotknown,andwhatismore,customerswillchoosetomisrepresenttheirvaluationsiftheyfeelthattheycangetabetterdeal.Mech-anismdesignstudiesthedesignoftruthful(orincentive-compatible)auctionswhichmakeitinthecustomers’bestinteresttodisclosetheirtruevaluations.Theperformanceofsuchauctionsisoftenmeasuredincomparisontotheprofitoftheselleroptimalenvy-freepricings[13,12],.InSection4,wewillinvestigatethisconnectionfurther,andpresentalogh-competitivetruthfullimited-supplyunit-demandcom-binatorialauctionforthecasewhereallconsumervaluationsareintherange[1,h].Wenotethatforanyunlimitedsupplycombinatorialpricingproblem(includingthesingle-mindedcase),alogh-competitivetruthfulmechanismistrivial.RelatedWork.Pricingisawell-studiedareaineconomics;however,computationalissuesarenotamajorfocus.Envy-freepricingispartofatrendtowardsunderstandingthealgorithmiccomplexityofcomputing“equilibria”:inanoptimalenvy-freepricing,thesellerdoesnothaveanyincentivetochangepricesandtheconsumersdonothaveanyincentivetodisputetheallocation.Examplesofother,somewhatdifferentworkinthiscategory,canbefoundin[9,10].Aspreviouslydiscussed,thisworkisrelatedtotruthfulauctiondesign,andespeciallythedesignoftruthfulauctionswithworst-caseperformanceguarantees,e.g.,[12,13,11,5,4,18].Ourinteresthereisinsellerprofitmaximization.An-othercommongoalforeconomicallymotivatedalgorithmsandmechanismsisthatofeconomicefficiency:obtaininganoutcomewhichmaximizesthesumoftheutilitiesofallpar-ticipants.Forthesingle-mindedbiddercase,whenthegoalisefficiency,boththepricingproblemandthemechanismdesignproblemhaveapproximatesolutions[19,3].Fortheunit-demandcase,theVickrey-Clarke-Groves(VCG)mech-anism[23,8,14]solvestheprobleminpolynomialtime(seedetailsinSection4),andisbothtruthfulandenvy-free.WenotethatcomputingtheVCGmechanismisNP-hardforgen-eralcombinatorialauctionproblemsincludingthespecialcaseofsingle-mindedbidders.Thegoalofeconomiceffi-ciencyisquitedifferentfrommaximizingthesellerprofit,andtherearesimpleexampleswheretheVCGmechanismisveryfarfrommaximizingthesellerprofit.Forexample,ifnotwoconsumerswantthesameitemthentheVCGmech-anismgivesallitemsawayforfree!Forunit-demandenvy-freepricing,afinal,somewhatinformalconnectionistothenotionofstablematchings.Byintroducingprices,weconstructmatchingsofconsumerstoitemswiththepropertythatnoconsumerpreferstheitemsomeoneelsegetstotheitemtheyget.2PreliminariesWeassumethattherearenconsumers,andasetJofmdistinctitems.Eachitemj∈Jexistsincjcopies(weexplicitlyallowcj=∞),andwedenotethesupplyvectorbyc=(c1,...,cm).Eachconsumerhasavaluationvi(S)foreachbundleS⊆Jofitems,whichmeasureshowmuchreceivingbundleSwouldbe“worth”toconsumeri;wedenotebyVthen×2Jmatrixofvaluations.Forconvenience,weassumethatvi(∅)=0forallconsumersi.Givenapricevectorp=(p1,...,pm),theutilitythatconsumeriderivesfrombundleSisUi(S)=vi(S)−pS,wherepS=Pj∈Spj;itmeasurestheconsumer’s“joy”athavingboughtthebundleSatthegivenprice.Ifconsumeri’sutilityforthebundleSisnon-negative,optionwithutilityUi(∅)=0,wehaveUi(S)≥0forallS∈Di.Usingthisterminology,wecannowdefineenvy-freepricingandallocations,thecentralnotionofthispaper.DEFINITION2.1.1.Anallocation(S1,...,Sn)ofbundlestoconsumersisfeasibleifeachitemjisinatmostcjsetsSi.Noticethatthismayleavesomeitemsunallocated.2.Givenapricingp=(p1,...,pm),anallocation(S1,...,Sn)isenvy-freeifSi∈Diforalli,i.e.,eachconsumerreceivesabundlefromhisdemandset.3.Apricingpisenvy-freeifitadmitsafeasible,envy-freeallocation.Noticethatifthesupplyisunlimitedforallitems,theneverypricevectorisenvy-free,aswecanselectanarbitrarybundleSifromeachdemandsetDi,andobtainafeasibleallocation.DEFINITION2.2.Theenvy-freepricingproblem:Giventheinput(n,m,V,c),computeanenvy-freepricingpandacorrespondingenvy-freeallocation(S1,...,Sn)maximizingthesellerprofitPipS3.2Alogarithmicapproximationalgorithm.Inourfur-therdiscussionoftheunitdemandcase,itwillbehelp-fultothinkofallocationsasmatchingsinbipartitegraphs.Specifically,givenapricevectorp,thedemandgraphisaOuralgorithmwillcomputeWalrasianEquilibriaforseveralappropriatelychosenreserveprices,andoutputtheoneyieldingmaximumrevenueamongthem.Theanalysiswillbebasedonthefollowinglemma.LEMMA3.1.Letπbeamaximumweightedmatchingti<t)whowouldbewillingtobuytheitematpriceqattimet0(i.e.,si≤t0≤tiandvi≥q),wecanexpressap(s,t)=maxq≥p,t0∈(s,t)(aq(s,t0)+aq(t0,t)+q·nt0,q).Anyparticularchoiceofqandt0correspondstosellingtheitematpriceqattimet0,toallconsumerswillingtobuyitthen.Toensureenvy-freeness,thisimposesaconstraintofpricingatleastatqduringthesub-intervalsthattheseconsumerswouldalsobewillingtobuyat.Theoptimalityofthedynamicprogramfollowssimplybylookingatthesellingtimesandpricesoftheoptimumsolutioninnon-decreasingorderofprice.Thecrucialobser-vationisthatweonlyneedtoconsiderapolynomialnum-berofpricesqandtimest0.Forthelatter,wenoticethatitemsonlyneedtobesoldattimessiorti,i.e.,endpointsofconsumers’intervals.Anyothersellingtimecanbeshiftedslightlytotheleftorrightwithoutalteringprofit.Similarly,allsellingpricesarevaluationsvi:iftheitemwereeversoldatapricepnotequaltoavaluation,thenallpricesofpcouldberaisedslightlywithoutlosingcustomersorcreatingenvy.Hence,thedynamicprogrammingtablecontainsonlyO(n3)entriesap(s,t),eachofwhichiscomputedintimeO(n2).Thiscompletestheproof.Wecanextendthisapproachtoapseudo-polynomialtimealgorithmforlimitedsupplyctattimet.Givensandt,letn+t0,qdenotethenumberofcustomerswithsi≤UnitDemandCombinatorialAuctionInput:ValuationmatrixV,where1≤vi(j)≤hforalli,j.1.Pickanintegerkuniformlyatrandomfrom{1,...,bloghc},andletrinanoptimalsolution,thepricesarepd=pdp=1,andpdn=0;theremainderoftheproofstaysunchanged.5.1ALogarithmicApproximationAlgorithmforItemsinUnlimitedSupply.TheprevioushardnessresultshowsthatweareunlikelytofindaPTASforthesingle-mindedbiddercase.However,itisfairlystraightforwardtogetalogarithmicapproximationforsingle-mindedbiddersinthecaseofunlimitedsupply.Ouralgorithmonlyconsiderspric-ingsinwhichallitemsarepricedthesame.Thecandidatepricesareqi=vi/|Si|,foreachcustomeri.Amongthepricingsassigningallitemspriceqi,ouralgorithmsimplyselectstheonegivinglargestprofitandoutputsit.THEOREM5.2.Thisalgorithmisalogn+logmapproxi-mationforenvy-freepricingwhenbiddersaresingle-mindedanditemsareavailableinunlimitedsupply.Proof.Weassumethattheconsumersareorderedsuchthatq1≥q2≥...≥qnPici≤c,of(b·c0+Xi≥1maxb0≥ba(wi,ci,b0)).Here,c0isthecapacityallottedtorequestsoriginatingwithw,and2.Thealgorithmmaintainsatableaj,γ1,...,γk,whereanentryisthemaximumamountofprofitthatcanbeobtainedfromrequestsendingatpositionjorbelow,giventhattheedgesj,j−1,...,j−k+1arepricedatγ1,...,γk,respectively.Tocalculateanentryaj+1,γ1,...,γk,considerallpossiblevaluesofγ0∈{0,...,B},andaddtoaj+1,γ2,...,γk,γ0themaximumprofitforallfeasiblerequestsendingexactlyatj+1withcostassignmentsγ2,...,γk,γ0toedgesj,j−1,