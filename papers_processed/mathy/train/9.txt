MeasuringtheRobustnessofGraphPropertiesYaliWanAmazon.comPaloAlto,CA94301yalwan@amazon.comMarinaMeilaUniversityofWashingtonSeattle,WA98195mmp@stat.washington.eduAbstractInthispaper,weproposeaperturbationframeworktomeasuretherobustnessofgraphproperties.Althoughwhenthegraphissymmetric.WedefineA,d,D,Lasthepropertiesoftheobservedgraph.Theabovequantitieswillbemarkedwithasymbol˜whentheyareperturbed.Thisisconsistentwiththenotationinmatrixperturbationliterature.Todemonstrate,Ãrepresentstheadjacencymatrixoftheperturbedgraph.Intherestofthispaper,weproceedasfollows.InSection2,wedescribeourmethodofbootstrappingandperturbingthenetworks.InSection3,wetalkaboutthegraphpropertiesofinterest.InSection4,wediscussmeasuresforevaluatingrobustnessofgraphproperties.InSection5,wediscussbreakdownpoints.InSection6,wediscussrelatedwork.InSection7,weusebothsyntheticandrealdatasetstoanalyzeourmethods.WeconcludeourfindingsinSection8.2PerturbingthenetworkExistingmethodsofperturbingnetworkscanbefoundinrecentworks[5,3,2,1].Theymostlyinvolveremovingorduplicatingedgesornodesrandomlyandindependentlyinthegraph.[3]randomlyremovesedgesfromthegraph.[5]maintainsthethenumberofverticesandedgesoftheoriginalgraph,andperturbsthegraphbymovingtheedgestotheotherlocations.Ontheotherhand,[2]and[1]bootstrapthenetworkbysubsamplingthenodes.Althoughtheirapproachisstraightforward,theperturbationcannotbewellcontrolled.Firstly,Althoughbothperturbationmethodsseemtobereasonable,theyhavegraph-specificadvantages.Theasymmetricmethodprovidesaverysimplewayforcalculatingagraphpropertylike˜dafterperturbation.Ontheotherhand,itisnotinterestingfortheperturbationofweaklyConnectedComponents(wCC’s),asweshallseeinSection4.Ontheotherhand,thesymmetricmethodmaintainsasymmetricperturbationofadjacencymatrix.IfAij=Aji,thenÃij=Ãjiafterperturbation.However,L̃iscomplicatedreachedacontradiction.E(L̃)<L.Inthesymmetricperturbation,L̃afterperturbingnodetisshowninEquation2.InorderhaveE(L̃ij)=Lij,weneed,E(1−AtjwtTheresultsareshowninFigure1.Weobservethatthebiasissensitivetothechoiceofweightdistribution.Inspecific,thebiasintroducedbyGammadistributionisgrowingexponentiallywithσw,thusnotagoodoption.NoderesamplingandBinarydistributiongeneratesmallestbias.Howevernoderesamplingcanonlyallowtheperturbationstrengthσwtobeasmuchas1,otherwisethetopologyofthegraphischanged.Binarydistributiononlyallowstwochoicesofweight,whichisverylimited.Themixturedistributionsbehavesimilarlyintermsofintroducingbias.Althoughthebiasisnontrivial,thefactthatitisupperboundedandthatwicanbegeneratedinacontinuousmannermakethemgoodcandidatesforperformingperturbationsongraphs.Figure1:E(√w)E(1√w)underasymmetricperturbation.Eachboxplotrepresents100repetitions.WealsoevaluatethebiasintroducedinL̃inthecurrentmethodsincluding[5]and[2].Sincetheymovetheedgesordeletenodes,thebiasdependsonthegraph.WegenerateagraphfromDC-SBMmodel[10]withn=800,wi∼0.5+uniform(0.5,1),andevaluateE(L̃ij)E(Lij).Asareminder,E(L̃ij)E(Lij)=E(√w)E(1√w).InFigure2,weshowthatbothmethodsintroducelargebiascomparetoperturbationstrengthproportionofnodessampledFigure2:Left:thebiasfromthemethodin[5].αindicatesthestrengthofperturbation.Right:thebiasfromthemethodin[2].βindicatestheproprotionofnodesourperturbationmethods.2.2PartialperturbationandfullperturbationInthissectionwediscussedperturbingthegraphbyaddingi.i.dweightstothenodes.Althoughwemakei.i.dassumptiononwi,itcanberelaxed.Inthispaper,Weproposeapairoffunctionsfu(G,w,K)=λK+1(L(G̃))−PKk=1λi(L(G̃)),fl(G,w,K)=PKk=1λk(L(G̃))todescribethenumberofwCC’s.Thereasonweuseflisthat,ifthereareKnumberofCC’s,thenfl=0.Wewouldthenexpectfltobecloseto0forKnumberofwCC’s.WechoosefubecauseweexpectasignificantgapbetweenflandλK+1(L(G̃))forastablenumberofwCC’s.Whenfuisawayfrom0(respectivelyflnear0)thereareexactlyK“weaklyconnected”componentsinG̃.Ifthisholdsforlargeperturbations,thenKcanbeconsideredrobust.TheKtheigengapisdefinedasfe(G̃,w,K)=λK+1(L(G̃))−λK(L(G̃)).ItindicatesKprincipalsubspacewhenfeislargecomparedtotheothereigengaps.NoticethatfunctionfdefinedfornumberofwCC’sandeigengapareonlymeaningfulforundirectedgraphs.Sincetheeigenvaluesisnotveryinterpretableforthedirectedgraphs.4InfluencefunctionsInordertoevaluatethegraphproperties,weconstructthetargetpropertiesasdifferentiablefunctionsf(G,w)andseehowmuchf(G,w)changeswithrespecttothesizeofperturbationofw.Inthissection,wepresenttoolsforquantifyingrobustnesincludingInfluenceFunction(IF)andBreakdownPoints.WefirstlytalkaboutInfluencefunction(IF),whichwasinventedbyHampelin[4].TheimportanceofIFliesinitsinterpretation:itgivesapictureoftheinfinitesimalbehavioroftheasymptoticvalue.Whilenumerousstudieshavebeendoneonmethodsforanalysisofdatasampledfromaknowndistributioni.i.d,therehasnotbeenmuchworkonusingthesetoolstoevaluatetherobustnessofgraphproperties.HerewedefineforaperturbedgraphG̃,IFt=∂f(G,w)∂wtw1:n=1,(13)whichmeasuresthelocalinfluenceofwtonf.4.1InfluencefunctionofWCutProposition2AssumeagraphGwithC,didefinedasusual.Assumenodet∈Ck0.dik=Pj∈CkAij,dki=Pj∈CkAji.Dk0k¬0=Pi∈Ck0,j/∈Ck0Aij.Thenusingasymmetricperturbation,theinfluencefunctionfornodetisIFWCutt(G,C)=dtDkk−dtkDkD2k.(14)Usingsymmetricperturbation.Inthesymmetricperturbation,sincetheperturbationcanbeexplainedasperturbingonenodeatatime,onecaneasilyshowthattheinfluencefunctionissameforperturbingonenodeormultiplenodes.Forsimplicity,weassumeperturbingnodeIFflt=KXi=1∂λi∂wt(27)IFfet=∂λK+1∂wt−∂λK∂wt(28)Unfortunately,asymmetricperturbationisnotveryinterestingforundirectedgraphs,sincethepropertiesremainuntoucheddespitetheperturbation,aswillbeshowninProposition3.ThisisbecausetheeigengapofLisequaltotheeigengapofthetransitionmatrixP=D−1A,andPstaysunchangedaftertheasymmetricperturbation.Thismotivatestheuseofsymmetricperturbation,theresultsofwhichareshowninProposition5.Proposition3Usingasymmetricperturbation,assumeAsymmetricandλkofmultiplicity1.∂λk∂wt|w1:n=1=0.viisthei-thelementofthek-theigenvectorofL.Proof:∂λ̃k∂wt=Xij∂λ̃k∂L̃ij∂L̃ij∂wt=Xijvivj∂L̃ij∂wt(29)SinceL̃ij=1−Aijwi+Ajiwj2√wiwjdidjWethenobtain,∂L̃ij∂wi=−2Aijpwiwjdidj+Aijpwiwjdidj+Ajiqw3jdidj/wi4wiwjdidj(30)Foranundirectedgraph,∂L̃ij∂wi|w1:n=1=0always.Proposition4[7]∂λk∂Lij=Pi,j6=tvivj,whereviisthei-thelementofthek-theigenvectorofL.Proposition5DefineA,d,λk,L,L̃,wasusual.Assumeλkisofmultiplicity1.DefinetransitionmatrixP=D−1A,viisthei-thelementofthek-theigenvectorofL.Insymmetricperturbation,∂λ̃k∂wt|w1:n=1=(1−λk)(Xiv2iPit−v2t)(31)Proof:Afterperformingthesymmetricperturbation,weobtainL̃fromEquation2.Wethencalculatetheinfluencefunction∂L̃ij∂wt|w1:n=1,∂L̃ij∂wt|w1:n=1=−Atj+Ajt4√dtdj(1−Ajtdj)i=t,j6=tAij+Aji4×Ajtdi+Aitdj(didj)3/2i,j6=t0i,j=t(32)Thenwecanderive∂λk∂wt|w1:n=1usingProposition4,∂λ̃k∂wt|w1:n=1=Xij∂λ̃k∂L̃ij∂L̃ij∂wt(33)=Xi,j6=tvivjAij+Aji2×Aitdj+Ajtdi2(didj)3/2−vtnXj=1vj×Atj+A4.3ClusteringClustering,definedasapartitionofnodes,cannotbewrittenasasmoothfunctionofweights,sincetheclusteringcanonlybechangeddiscretely.ThereforewecannotuseIFtomeasuretherobustnessofclustering.However,aclusteringcanbeevaluatedbybreakdownpoints(BP),whichwillbediscussedinthenextsection.5Breakdownpoints(BP)WhileIFmeasureslocalinfinitesimalinfluences,thebreakdownpoint(BP)measurestheglobalreliabilityofthegraphproperties.Itisdevelopedby[4]andwidelyusedinrobuststatisticsliterature.Itinformstherangeofperturbationsthatcanbetoleratedbeforethe“structuralinformationinthedata”islost.SimilarwithInfluencefunction,theuseofBPislimitedbytheassumptionthatthedataisgeneratedi.i.dfromknown7.1DatasetsSyntheticdatasetsThesyntheticdatasetsaregeneratedfromtheDC-SBMmodelwiththenumberofclustersK=5,andthedistributionoftheclustersizesnkn=(0.1,0.2,0.3,0.2,0.2).DC-SBMisdefinedasaclassofnetworkmodelthatAij=wiwjBklwheneveri∈k,j∈l,withB=[Bkl]∈RK×Ksymmetricandnon-negativeandw1,...,wnnon-negativeFigure4:Facebookdatasettheoryoftherecoveryofclustering[13,12,14],itcanbeindicatedthatthegraphpropertiesinthehardergraphswillbelessrobustness.Noticethatintherealdatasets,e.g.Facebook,onemayarguethattheperturbationmaynotbemeaningfulsincetheedgesaregivencontinuousweightsaftertheperturbation,whiletheedgescanonlytakethevalues0and1,e.g,twopeopleareeitherfriendsornot.Itistruethatinreality,thechangeofthiskindofsocialnetworksisrestrictedtoaddingordeletingnodesoredges.Ourperturbationmethodsdoallowfordeletionofnodesandedgeswhentheweightaregeneratednoderesamplingmechanism.Theycanbeviewedasdeletionsfromthegraph.WecanalsoutilizenodeFigure5:Left:easydatasetwithwiDC−SBM∼0.5+0.5×Uniform(0,1).Right:harddatasetwithwiDC−SBM∼0.4+0.6×Uniform(0,1).1strow:Noderesampling.2Androw:Figure6:ThehistogramsofIFWCutforsyntheticdatasets.Left:C.Right:˜C.˜CisexpectedtobelessrobustcomparingtothatofC,sincetherearealreadymorenoisesin˜C.AftercomputingIFWCutforbothCand˜C,weplotthehistogramsinFigure6.WeobservethatinthehistogramforC,IFWCutismoreconcentratedon0withfewerlargeinfluencenodes,thusindicatingarobustclustering.Ontheotherhand,thehistogramfor˜Cindicatestheclusteringbeingsensitive.ThesefindingscorrespondwithourexpectationsandshowthatIFWCutisinformative.Theotherexperimentwedoistoprobewherethesensitivitycomesfromthroughapartialperturbation.Wegeneratesyntheticdatasetwithn=800,andλ1:K=(0,0.2,0.4,0.6,0.8).WealsoperformtheexperimentontheFacebookdataset.WeselectthenodeswithIFWCuti(Ctrue)>0.ThesenodesareconsiderednotwellclusteredbecauseincreasingtheweightsFigure7:Leftcolumn:thechangeofWCutwithrespecttoE(w).Rightcolumn:thechangeofclassificationerrorwithrespectofE(w).Firstrow:syntheticdatset.Secondrow:Facebookdatset.Eachboxplotisconsistof100repetitions.largestfFigure8:Topleft:IF(λ2,w).Leftcolumn:syntheticdatset.Rightcolumn:Facebookdataset.Firstrow:IF(fl).Secondrow:IF(fu).Thirdrow:breakdownpointoffu.Eachboxplotisconsistof100repetitions.Althoughthesemeasuresarewidelyusedintherobuststatisticsliterature,usingthemongraphpropertiesisthefirsttime.Lastbutnottheleast,wearealsoabletoprobethesourceofrobustnessbyquantifyingtheinfluenceofnodesontherobustnessofgraphproperties,whichprovidesadeeperinsightintotheproblem.Ourperturbationframeworkalsohaveitslimitations.Forexample,nonewedgesornodescanbeaddedtothegraphsthroughourperturbationmethods,andthismaynotbenaturalevaluatingthegraphpropertiesinFigure9:Leftcolumn:syntheticdataset.Rightcolumn:Facebookdataset.Firstrow:IF(fe).Secondrow:breakdownpointoffe.Eachboxplotisconsistof100repetitions.References[1]WaqarAli,AnatolEWegner,RobertEandJ.Platt,editors,AdvancesinNeuralInformationProcessingSystems18,pages955–962,Cambridge,MA,2006.MITPress.[10]TaiQinandKarlRohe.Regularizedspectralclusteringunderthedegree-correctedstochasticblockmodel.InAdvancesinNeuralInformationProcessingSystems,pages3120–3128,2013.[11]NicolasVerzelen,EryArias-Castro,etal.Communitydetectioninsparserandomnetworks.TheAnnalsofAppliedProbability,25(6):3465–3510,2015.[12]YaliWanandMarinaMeila.BenchmarkingrecoverytheoremsfortheDC-SBM.InInterna-tionalSymposiumonArtificialIntelligenceandMathematics(ISAIM),2015.[13]YaliWanandMarinaMeila.Aclassofnetworkmodelsrecoverablebyspectralclustering.InDanielLeeandMasashiSugiyama,editors,AdvancesinNeuralInformationProcessingSystems(NIPS),2015.[14]YaliWanandMarinaMeilă.Graphclustering:block-modelsandmodel-freeresults.InAdvancesinNeuralInformationProcessingSystems(NIPS),2016.18