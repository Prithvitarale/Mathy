JMLR:WorkshopandConferenceProceedingsvol35:1–17,2014lil’UCB:AnOptimalExplorationAlgorithmforMulti-ArmedBandits∗KevinJamiesonKGJAMIESON@WISC.EDUMatthewMalloyMMALLOY@WISC.EDURobertNowakNOWAK@ECE.WISC.EDUUniversityofWisconsinSébastienBubeckSBUBECK@PRINCETON.EDUPrincetonUniversityAbstractThepaperproposesanovelupperconfidencebound(UCB)procedureforidentifyingthearmwiththelargestmeaninamulti-armedbanditgameinthefixedconfidencesettingusingasmallJAMIESONMALLOYNOWAKBUBECKactivityprovidingnewupperandlowerbounds.In2002,thesuccessiveeliminationprocedureofEven-Daretal.(2002)wasshowntofindthebestarmwithorderPi6=i∗LIL’UCB:ANOPTIMALEXPLORATIONALGORITHMFORMULTI-ARMEDBANDITSItiseasytoshowthatwithoutthestoppingcondition(andwiththerightδ)ouralgorithmachievesacumulativeregretJAMIESONMALLOYNOWAKBUBECKisanoptimaltest.Inthelimitastincreases,ifthethresholdsarenotatleastp(2/t)loglog(t)thentheLILimpliestheprocedurewillfailwithprobabilityapproaching1/2forsmallvaluesof∆.Settingthethresholdstobejustgreaterthanp(2/t)loglog(t),inthelimit,onecanshowtheexpectednumberofsamplesmustscaleas∆−2loglog∆−2.AstheproofinFarrell(1964)isLIL’UCB:ANOPTIMALEXPLORATIONALGORITHMFORMULTI-ARMEDBANDITSNotethatthealgorithmobtainstheoptimalquerycomplexityofH1log(1/δ)+H3uptocon-stantfactors.Weremarkthatthetheoremholdswithanyvalueofλsatisfying(7).Inspectionof(7)showsthatasδ→0wecanletλtendto2+ββ2.WepointoutthatthesamplecomplexityboundinthetheoremcanJAMIESONMALLOYNOWAKBUBECKThusthefollowinginequalitiesholdtrue(byusingtrivialmanipulationsonthesequence(uk)):P∃t∈{uk+1,...,uk+1−1}LIL’UCB:ANOPTIMALEXPLORATIONALGORITHMFORMULTI-ARMEDBANDITSTheproofreliescruciallyonthefactthattherealizationsfromeacharmareindependentofeachother.ThismeansthatJAMIESONMALLOYNOWAKBUBECKtechniquestoboundthesumofsub-exponentialrandomvariablesonedirectlyobtainsthatPnXi=2(Zi−ai)≥z!≤exp−minLIL’UCB:ANOPTIMALEXPLORATIONALGORITHMFORMULTI-ARMEDBANDITSStep2.Using(8)withω=δi−1weseethat1{Ei(δi−1)}1i−1JAMIESONMALLOYNOWAKBUBECK5.ImplementationandSimulationsInthissectionweinvestigatehowthestateoftheartmethodsforsolvingthebestarmproblembehaveinpractice.BeforedescribingeachofthealgorithmsinLIL’UCB:ANOPTIMALEXPLORATIONALGORITHMFORMULTI-ARMEDBANDITSWedidnotcomparetoPRISMofJamiesonetal.(2013)becausethealgorithmanditsempiricalper-formanceareverysimilartoExponential-GapEliminationsoitsinclusioninthecomparisonwouldprovideverylittleaddedvalue.WeremarkthatthefirstthreealgorithmsrequireO(1)amortizedcomputationpertimestep,thelil’UCBalgorithmsrequireO(log(n))computationpertimestepusingsmartdatastructures4,andLUCB1requiresO(n)computationpertimestep.LUCB1wasnotrunonallproblemsizesduetopoorcomputationalscalingwithrespecttotheproblemsize.Threeproblemscenarioswereconsideredoveravarietyproblemsizes(numberofarms).The“1-sparse”scenariosetsµ1=1/2andµi=0foralli=2,...,nresultinginahardnessofH1=4n.The“α=0.3”and“α=0.6”scenariosconsidern+1armswithµ0=1andµi=1−(i/n)αforalli=1,...,nwithrespectivehardnessesofH1≈3/2nandH1≈6n1.2.Thatis,theα=0.3caseshouldbeaboutashardasthesparsecasewithincreasingproblemsizewhiletheα=0.6isconsiderablymorechallengingandgrowssuperlinearlywiththeproblemsize.SeeJamiesonetal.(2013)foranin-depthstudyoftheαparameterization.Allexperimentswererunwithinputconfidenceδ=0.1.AllrealizationsofthearmswereGaussianrandomvariableswithmeanµiandvariance1/45.EachalgorithmterminatesatsomefinitetimewithhighprobabilitysowefirstconsidertherelativestoppingtimesofeachofthealgorithmsinFigure2.Eachalgorithmwasrunoneachproblemscenarioandproblemsize,repeated50times.ThefirstobservationisthatExponential-GapElimination(+LS)appearstobarelyperformbetterthannonadaptivesamplingwiththeLILstoppingcriterion.Thisconfirmsoursuspicionthattheconstantsinmedianeliminationarejusttoolargetomakethisalgorithmpracticallyrelevant.WhiletheLILstoppingcriterionseemstohavemeasurablyimprovedthelil’UCBalgorithm,ithadnoimpactonthelil’UCBHeuristicvariant(notplotted).Whilelil’UCBHeuristichasnotheoreticalguaranteesofoutputtingthebestarm,weremarkthatoverthecourseofallofourtensofthousandsofexperiments,thealgorithmneverfailedtoterminatewiththebestarm.TheLUCBalgorithm,despitehavingworsetheoreticalguaranteesthanthelil’UCBalgorithm,performssurprisinglywell.WeconjecturethatthisisbecauseUCBstylealgorithmstendtoleantowardsexploitingthetoparmversusfocusingonincreasingthegapbetweenthetoptwoarms,whichisthegoalofLUCB.Inreality,onecannotalwayswaitforanalgorithmtorununtilitterminatesonitsownsowenowexplorehowthealgorithmsperformifthealgorithmmustoutputanarmateverytimestepbeforetermination(thisissimilartothesettingstudiedinBubecketal.(2009)).Foreachalgorithm,ateachtimeweoutputthearmwiththehighestempiricalmean.Clearly,theprobabilitythatasub-optimalarmisoutputbyanyalgorithmshouldverycloseto1inthebeginningbuttheneventuallydecreasetoatleastthedesiredinputconfidence,andlikely,tozero.Figure3showsthe“anytime”performanceofthealgorithmsforthethreescenariosandunliketheempiricalstoppingtimesofthealgorithms,wenowobservelargedifferencesbetweenthealgorithms.Eachexperimentwasrepeated5000times.Againweseeessentiallynodifferencebetweennonadaptivesamplingandtheexponential-gapprocedure.WhileinthestoppingtimeplotsofFigure2thesuccessiveeliminationappearscompetitivewiththeUCBalgorithms,weobserveinFigure3thattheUCBalgorithmsarecollecting4.Thesufficientstatisticforlil’UCBtodecidewhicharmtosampledependsonlyonbµi,Ti(t)andTi(t)whichonlychangesforanarmifthatparticulararmispulled.Thus,itsufficestomaintainanorderedlistoftheupperconfidenceboundsinwhichdeleting,updating,andreinsertingthearmrequiresjustO(log(n))computation.ContrastthiswithaUCBprocedureinwhichtheupperconfidenceJAMIESONMALLOYNOWAKBUBECK1-sparse,H1=4nα=0.3,H1≈32nα=0.6,H1≈6n1.2Figure2:StoppingtimesofthealgorithmsforthreescenariosLIL’UCB:ANOPTIMALEXPLORATIONALGORITHMFORMULTI-ARMEDBANDITS1-sparse,H1=4nα=0.3,H1≈32nα=0.6,H1≈6n1.2n=10n=100n=1000n=10000Figure3:Ateverytime,eachalgorithmoutputsanarmîthathasthehighestempiricalmean.TheP(î6=i∗)isplottedwithrespecttothetotalnumberofpullsbythealgorithm.Theprob-lemsizes(numberofarms)increasefromtoptobottom.Theproblemscenariosfromlefttorightarethe1-sparseproblem(µ1=0.5,µi=0∀i>1),α=0.3(µi=JAMIESONMALLOYNOWAKBUBECKReferencesYasinAbbasi-Yadkori,CsabaSzepesvári,andDavidTax.Improvedalgorithmsforlinearstochasticbandits.InAdvancesinNeuralInformationProcessingSystems,pages2312–2320,2011.Jean-YvesAudibert,SébastienBubeck,andRémiMunos.BestLIL’UCB:ANOPTIMALEXPLORATIONALGORITHMFORMULTI-ARMEDBANDITSAppendixA.CondensedProofofLowerBoundWefirstre-statethemainresultofFarrell(1964).Theorem6(Farrell,1964,Theorem1).LetXii.i.d.∼N(∆,1),where∆6=0isunknown.Considertestingwhether∆>0or∆<0.LetY∈{−1,1}bethedecisionofanysuchtestbasedonTsamples(possiblyarandomnumber)andletδ∈(0,1/2).Ifsup∆6=0P(Y6=sign(∆))≤δ,thenlimsup∆→0E∆[T]∆−2loglog∆−2≥2−4δ.InthefollowingweshowaweakerresultthanwhatisshowninFarrell(1964);nonetheless,itshowstheloglogtermisnecessary.Theorem7LetXii.i.d.∼N(∆,1),where∆6=0isunknown.Considertestingwhether∆>0or∆<0.LetY∈{−1,1}beJAMIESONMALLOYNOWAKBUBECKDefinethefunctiont0(∆)=ε2∆−22loglog∆−22andletTbethestoppingtime:T:=inf(t∈LIL’UCB:ANOPTIMALEXPLORATIONALGORITHMFORMULTI-ARMEDBANDITSByMarkov,E∆[T]/t0(∆)≥P∆(T≥t0(∆)),andweconcludelim∆→0E