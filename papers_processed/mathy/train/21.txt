arXiv:1306.3917v1[stat.ML]17Jun2013OnFindingtheLargestMeanAmongManyKevinJamieson†,MatthewMalloy†∗,RobertNowak†,andSébastienBubeck‡†DepartmentofElectricalandComputerEngineering,UniversityofWisconsin-Madison‡PrincetonMannorandTsitsiklis[4]showedthatforanyprocedurethatfindsthebestarmwithprobabilityatleast1−δrequiresontheorderofHlog(1/δ)samples,whereH:=Pni=1(µ0−µi)−2.Thislowerboundshowsthatthesamplecomplexitycanbemuchgreaterthanthenumberofarms.Forexample,ifthegapbetweenµ0andµ1is1/n,thenH,andthesamplecomplexity,areatleastO(n2).On1.1ContributionsandOrganizationThepaperisorganizedasfollows.InSec.2,wepresentasingle-parametermodelforthedistributionofmeansthatspanstherangefromlineartosuperlinearsamplecomplexity.InSec.3wepresentanalgorithmInthispaperwefocusonaspecificparametricfamilythatspansthehardnessofthebestarmproblemwithasingleparameter.Consideramodelinwhichthemeansaregivenbyµi=µ0−(i/n)α(3)fori=1,...,nandsomeα≥0.Werefertothismodelasanα-parameterization.Underthismodel,∆i=(i/n)α.Theα-parameterizationspanstherangefrom“hard”problemsinwhichthegaps∆iareshrinkingquicklyasngrows,to“easy”orsparsecasesinwhichthegapsaregreaterthanaconstant(whenα=0).Theorem3inSec.4yieldsthefollowinglowerboundsonthesamplecomplexityofidentifyingthebestarm(ignoringconstantandlog(1/δ)factors):samplecomplexity≥nifα<1/2nlognifα=1/2n2αifα>1/2.(4)ThefocusofthispaperisonfindingsufficientconditionsunderwhichPni=1∆−2ilog2(∆−2i).IngeneralH≤G≤Hlog(H)butinmanycases,G=HandtheboundimpliesthatthebestarmcanbefoundusingO(H)times,wheremisfixeda-priori,andoutputsasinglearmasanestimateofthebestarm.Weshowthatallnon-adaptivemethodsmayrequiredrasticallymoresamplesthanPRISM.Thetake-awaymessageisthatthesmalladdeddifficultyToseethatTheorem5isindeedtight,itisstraightforwardtoshowthatthenon-adaptiveprocedurewhichchoosesthearmwiththelargestempiricalmeanaftersamplingeacharmthesamenumberoftimesdoesindeedmeetthelowerbound.Lettingmbethenumberoftimeseacharmissampled.ThenPbi6=i∗≤Xi6=i∗P(bµi∗≤bµi)≤Xi6=i∗(P(b[10]EyalEven-Dar,ShieMannor,andYishayMansour.Actioneliminationandstoppingconditionsforthemulti-armedbanditandreinforcementlearningproblems.TheJournalofMachineLearningResearch,7:1079–1105,2006.[11]G.Abreu.Verysimpletightboundsontheq-function.Communications,IEEETransactionson,60(9):2415–2420,2012.[12]JorgeNocedalandStephenJWright.Numericaloptimization.SpringerScienceandBusinessMedia,2006.AAppendixA.1ProofofTheorem1Proof.Itwillbeusefultoconsiderthefollowing‘slicing’ofarms:Ωs={i∈[n]:Itremainstoboundtheprobabilitythat(11)isnotsatisfiedwhile(8),(9)and(10)aresatisfied.Pi∈Aℓ∩Ωs:bµi(ℓ)≥bµiℓ−2εonphaseℓisboundedbycℓ2ℓ|Aℓ|pullswithc=cME+1.Usingtheresultsfromthepreviousstep(inparticular(12)andthestoppingtimeL)onehasthatthetotalnumberA.3ProofofTheorem4Proof.WerestrictourattentiontorewarddistributionsoftheformN(µi,1).Assumethatµi,i=0,...,n,areknowuptoapermutation,andleteacharmbeassignedameanuniformlyatrandom.Wefirstshowthatthetestwithminimumaverageprobabilityoferrorsimplypicksthelargestempiricalmeanamongallarms,i.e.,bi=argmaxibµi,wherebµi=1/mPmj=1Xi,j,andXi,jrepresentstherewardofarmionthejthplayofthatarm,andmisthetotalnumberofsamplesofeacharm.Thiscanbeseenbyconsideringthemaximuma-posteriori(MAP)estimatorofthebestarm,whichbydefinitionhasthesmallestprobablyoferror.Undertheassumptionthatthearmsareassignedmeansuniformlyatrandom,theMAPestimatorreducestothemaximumlikelihood(ML)estimator:biMAP=biML=argmaxiP(Xm0,...,Xmn|Hi),whereXmi=Xi,1,...,Xi,mandHiiseventthatarmiisthebestarm.ConsidercomparingbetweeneventsHiandHi′,i6=i′:theMLtestisP(Xm0,...,Xmn|Hi)≶i′iP(Xm0,...,Xmn|Hi′).Bytheindependenceacrossarms,itisstraightforwardtoshowthistestreducesto:P(Xmi|Hi)P(Xmi′|Hi)≶i′iP(Xmi|Hi′)P(Xmi′|Hi′)(13)ThedistributionofXmi,givenHi,issimplyP(Xmi|Hi)=1√2πexp−||Xmi−µi∗1||2/2(14)whereXmi=[Xi,1,...,Xi,m]T∈Rm.Themarginaldistributiononarmi′,giventhatarmiisthelargest,followsamixturedistribution:P(Xmi′|Hi)=1n√2πnXj=1exp−||Xmi′−µj1||2/2.(15)Combining(13),(14),and(15),afteranumberofstraightforwardmanipulations,excludedforbrevity,itcanbeshownthattheMLestimateprefersarmitoi′ifandonlyifPmℓ=1Xi,ℓ>Pmℓ=1Xi′,ℓ,orequivalently,bµi>bµi′.Theestimatewithminimumprobabilityoferrorissimplybi=argmaxibµi.Wecontinuebyboundingtheprobabilityoferrorofthemaximumlikelihoodtest.Foranyestimator,P(bi6=i∗)≥P[i6=i∗bµi∗−bµi≤0=P(bµi∗≥µi∗)P[i6=i∗bµi∗−bµi≤0bµi∗≥µi∗+P(bµi∗<µi∗)P[i6=i∗bµi∗−bµi≤0bµi∗<µi∗≥12P[i6=i∗bµi≥µi∗=121−P\i6=i∗bµi≤µi∗=121−Yi6=i∗FNqm∆2i≥121−Yi6=i∗1−112exp−m∆2i(16)≥min∆1,...,∆n:Pi1∆2i=H121−Yi6=i∗1−112exp−m∆2i(17)11whereFN(x)isthestandardGaussianCDF.Theinequalityin(16)followssinceFN(x)≤1−exp(−x2)/12forx≥0[11,Eqn.13].Thenextstepintheproofwillbeshowingthaterrorprobabilitiessmallerthanafixedconstant,(17)isminimizedwhenthegapsareequal,i.e.,when∆1=∆2=...=pn/H.Firstdefinez∈Rn+withelementszi:=1/(m∆2i).Wecanrecovertheminimumof(17)bysolvingargmaxz∈Rn+:1Tz=H/mnXi=1log1−112exp(−1/zi).(18)DefinetheLagrangianof(18)asL(z,λ)=−nXi=1log1−112expz−1i−λ(1Tz−H/m).From[12,p.321],anyzthatmaximizes(18)necessarilysatisfies∂L∂zi=z−2i12exp(z−1i)−1−λzi=0∀i(19)1Tz=H.Theabovesystemofequationsissatisfiedbypairs(z,λ)thatsatisfyzi:λ=z−3i12exp(z−1i)−1∀i(20)and1Tz=Hsimultaneously.Differentiationof(20)showsthefunctionλ(zi)ismonotonicallyincreasinginziforzi≤1/3.First,considerasolutionto(19)whichhasoneormorezi≥1/3.Thiswouldimplym∆2i≤3forsomei,andfrom(17),P(bi6=i∗)≥124exp(−3).Foranyλ,(20)issatisfiedbyatmostonezi∈(0,1/3]bythemonotonicityofthefunctiononthisrange;thisimpliesimplieseither1)thezthatmaximizes(18)hastheformz1=z2=···=zn,or2)P(bi6=i∗)≥124exp(−3).Wefocusourattentiononthecasewhenz1=···=zn(andthus∆1=···=∆n).SincePi1/∆2i=H,∆i=pn/Hforalli.(17)givesP(bi6=i∗)≥121−1−112exp−mnHn.Recallthetotalnumberofsamplesisgivenbynm.Ifmn≤H(logn+log(25δ)−1),thenforδ∈(0,e−3/24)P(bi6=i∗)≥121−1−25δ12nn(21)≥121−exp−25δ12foralln≥1(22)≥δ(23)whichcompletesNotethat{∆1,...,∆n}satisfyPni=11/∆2i=H.From(16),andbyconsideringonlythearmwiththesmallestgap,P(bi6=i)≥12