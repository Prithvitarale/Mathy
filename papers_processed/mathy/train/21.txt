arXiv:1306.3917v1[stat.ML]17Jun2013OnFindingtheLargestMeanAmongManyKevinJamiesonâ€ ,MatthewMalloyâ€ âˆ—,RobertNowakâ€ ,andSeÌbastienBubeckâ€¡â€ DepartmentofElectricalandComputerEngineering,UniversityofWisconsin-Madisonâ€¡PrincetonMannorandTsitsiklis[4]showedthatforanyprocedurethatfindsthebestarmwithprobabilityatleast1âˆ’Î´requiresontheorderofHlog(1/Î´)samples,whereH:=Pni=1(Âµ0âˆ’Âµi)âˆ’2.Thislowerboundshowsthatthesamplecomplexitycanbemuchgreaterthanthenumberofarms.Forexample,ifthegapbetweenÂµ0andÂµ1is1/n,thenH,andthesamplecomplexity,areatleastO(n2).On1.1ContributionsandOrganizationThepaperisorganizedasfollows.InSec.2,wepresentasingle-parametermodelforthedistributionofmeansthatspanstherangefromlineartosuperlinearsamplecomplexity.InSec.3wepresentanalgorithmInthispaperwefocusonaspecificparametricfamilythatspansthehardnessofthebestarmproblemwithasingleparameter.ConsideramodelinwhichthemeansaregivenbyÂµi=Âµ0âˆ’(i/n)Î±(3)fori=1,...,nandsomeÎ±â‰¥0.WerefertothismodelasanÎ±-parameterization.Underthismodel,âˆ†i=(i/n)Î±.TheÎ±-parameterizationspanstherangefromâ€œhardâ€problemsinwhichthegapsâˆ†iareshrinkingquicklyasngrows,toâ€œeasyâ€orsparsecasesinwhichthegapsaregreaterthanaconstant(whenÎ±=0).Theorem3inSec.4yieldsthefollowinglowerboundsonthesamplecomplexityofidentifyingthebestarm(ignoringconstantandlog(1/Î´)factors):samplecomplexityâ‰¥ï£±ï£´ï£´ï£´ï£²ï£´ï£´ï£´ï£³nifÎ±<1/2nlognifÎ±=1/2n2Î±ifÎ±>1/2.(4)ThefocusofthispaperisonfindingsufficientconditionsunderwhichPni=1âˆ†âˆ’2ilog2(âˆ†âˆ’2i).IngeneralHâ‰¤Gâ‰¤Hlog(H)butinmanycases,G=HandtheboundimpliesthatthebestarmcanbefoundusingO(H)times,wheremisfixeda-priori,andoutputsasinglearmasanestimateofthebestarm.Weshowthatallnon-adaptivemethodsmayrequiredrasticallymoresamplesthanPRISM.Thetake-awaymessageisthatthesmalladdeddifficultyToseethatTheorem5isindeedtight,itisstraightforwardtoshowthatthenon-adaptiveprocedurewhichchoosesthearmwiththelargestempiricalmeanaftersamplingeacharmthesamenumberoftimesdoesindeedmeetthelowerbound.Lettingmbethenumberoftimeseacharmissampled.ThenPbi6=iâˆ—â‰¤Xi6=iâˆ—P(bÂµiâˆ—â‰¤bÂµi)â‰¤Xi6=iâˆ—(P(b[10]EyalEven-Dar,ShieMannor,andYishayMansour.Actioneliminationandstoppingconditionsforthemulti-armedbanditandreinforcementlearningproblems.TheJournalofMachineLearningResearch,7:1079â€“1105,2006.[11]G.Abreu.Verysimpletightboundsontheq-function.Communications,IEEETransactionson,60(9):2415â€“2420,2012.[12]JorgeNocedalandStephenJWright.Numericaloptimization.SpringerScienceandBusinessMedia,2006.AAppendixA.1ProofofTheorem1Proof.Itwillbeusefultoconsiderthefollowingâ€˜slicingâ€™ofarms:â„¦s={iâˆˆ[n]:Itremainstoboundtheprobabilitythat(11)isnotsatisfiedwhile(8),(9)and(10)aresatisfied.PiâˆˆAâ„“âˆ©â„¦s:bÂµi(â„“)â‰¥bÂµiâ„“âˆ’2Îµonphaseâ„“isboundedbycâ„“2â„“|Aâ„“|pullswithc=cME+1.Usingtheresultsfromthepreviousstep(inparticular(12)andthestoppingtimeL)onehasthatthetotalnumberA.3ProofofTheorem4Proof.WerestrictourattentiontorewarddistributionsoftheformN(Âµi,1).AssumethatÂµi,i=0,...,n,areknowuptoapermutation,andleteacharmbeassignedameanuniformlyatrandom.Wefirstshowthatthetestwithminimumaverageprobabilityoferrorsimplypicksthelargestempiricalmeanamongallarms,i.e.,bi=argmaxibÂµi,wherebÂµi=1/mPmj=1Xi,j,andXi,jrepresentstherewardofarmionthejthplayofthatarm,andmisthetotalnumberofsamplesofeacharm.Thiscanbeseenbyconsideringthemaximuma-posteriori(MAP)estimatorofthebestarm,whichbydefinitionhasthesmallestprobablyoferror.Undertheassumptionthatthearmsareassignedmeansuniformlyatrandom,theMAPestimatorreducestothemaximumlikelihood(ML)estimator:biMAP=biML=argmaxiP(Xm0,...,Xmn|Hi),whereXmi=Xi,1,...,Xi,mandHiiseventthatarmiisthebestarm.ConsidercomparingbetweeneventsHiandHiâ€²,i6=iâ€²:theMLtestisP(Xm0,...,Xmn|Hi)â‰¶iâ€²iP(Xm0,...,Xmn|Hiâ€²).Bytheindependenceacrossarms,itisstraightforwardtoshowthistestreducesto:P(Xmi|Hi)P(Xmiâ€²|Hi)â‰¶iâ€²iP(Xmi|Hiâ€²)P(Xmiâ€²|Hiâ€²)(13)ThedistributionofXmi,givenHi,issimplyP(Xmi|Hi)=1âˆš2Ï€expâˆ’||Xmiâˆ’Âµiâˆ—1||2/2(14)whereXmi=[Xi,1,...,Xi,m]TâˆˆRm.Themarginaldistributiononarmiâ€²,giventhatarmiisthelargest,followsamixturedistribution:P(Xmiâ€²|Hi)=1nâˆš2Ï€nXj=1expâˆ’||Xmiâ€²âˆ’Âµj1||2/2.(15)Combining(13),(14),and(15),afteranumberofstraightforwardmanipulations,excludedforbrevity,itcanbeshownthattheMLestimateprefersarmitoiâ€²ifandonlyifPmâ„“=1Xi,â„“>Pmâ„“=1Xiâ€²,â„“,orequivalently,bÂµi>bÂµiâ€².Theestimatewithminimumprobabilityoferrorissimplybi=argmaxibÂµi.Wecontinuebyboundingtheprobabilityoferrorofthemaximumlikelihoodtest.Foranyestimator,P(bi6=iâˆ—)â‰¥Pï£«ï£­[i6=iâˆ—bÂµiâˆ—âˆ’bÂµiâ‰¤0ï£¶ï£¸=P(bÂµiâˆ—â‰¥Âµiâˆ—)Pï£«ï£­[i6=iâˆ—bÂµiâˆ—âˆ’bÂµiâ‰¤0bÂµiâˆ—â‰¥Âµiâˆ—ï£¶ï£¸+P(bÂµiâˆ—<Âµiâˆ—)Pï£«ï£­[i6=iâˆ—bÂµiâˆ—âˆ’bÂµiâ‰¤0bÂµiâˆ—<Âµiâˆ—ï£¶ï£¸â‰¥12Pï£«ï£­[i6=iâˆ—bÂµiâ‰¥Âµiâˆ—ï£¶ï£¸=12ï£«ï£­1âˆ’Pï£«ï£­\i6=iâˆ—bÂµiâ‰¤Âµiâˆ—ï£¶ï£¸ï£¶ï£¸=12ï£«ï£­1âˆ’Yi6=iâˆ—FNqmâˆ†2iï£¶ï£¸â‰¥12ï£«ï£­1âˆ’Yi6=iâˆ—1âˆ’112expâˆ’mâˆ†2iï£¶ï£¸(16)â‰¥minâˆ†1,...,âˆ†n:Pi1âˆ†2i=H12ï£«ï£­1âˆ’Yi6=iâˆ—1âˆ’112expâˆ’mâˆ†2iï£¶ï£¸(17)11whereFN(x)isthestandardGaussianCDF.Theinequalityin(16)followssinceFN(x)â‰¤1âˆ’exp(âˆ’x2)/12forxâ‰¥0[11,Eqn.13].Thenextstepintheproofwillbeshowingthaterrorprobabilitiessmallerthanafixedconstant,(17)isminimizedwhenthegapsareequal,i.e.,whenâˆ†1=âˆ†2=...=pn/H.FirstdefinezâˆˆRn+withelementszi:=1/(mâˆ†2i).Wecanrecovertheminimumof(17)bysolvingargmaxzâˆˆRn+:1Tz=H/mnXi=1log1âˆ’112exp(âˆ’1/zi).(18)DefinetheLagrangianof(18)asL(z,Î»)=âˆ’nXi=1log1âˆ’112expzâˆ’1iâˆ’Î»(1Tzâˆ’H/m).From[12,p.321],anyzthatmaximizes(18)necessarilysatisfiesâˆ‚Lâˆ‚zi=zâˆ’2i12exp(zâˆ’1i)âˆ’1âˆ’Î»zi=0âˆ€i(19)1Tz=H.Theabovesystemofequationsissatisfiedbypairs(z,Î»)thatsatisfyzi:Î»=zâˆ’3i12exp(zâˆ’1i)âˆ’1âˆ€i(20)and1Tz=Hsimultaneously.Differentiationof(20)showsthefunctionÎ»(zi)ismonotonicallyincreasinginziforziâ‰¤1/3.First,considerasolutionto(19)whichhasoneormoreziâ‰¥1/3.Thiswouldimplymâˆ†2iâ‰¤3forsomei,andfrom(17),P(bi6=iâˆ—)â‰¥124exp(âˆ’3).ForanyÎ»,(20)issatisfiedbyatmostoneziâˆˆ(0,1/3]bythemonotonicityofthefunctiononthisrange;thisimpliesimplieseither1)thezthatmaximizes(18)hastheformz1=z2=Â·Â·Â·=zn,or2)P(bi6=iâˆ—)â‰¥124exp(âˆ’3).Wefocusourattentiononthecasewhenz1=Â·Â·Â·=zn(andthusâˆ†1=Â·Â·Â·=âˆ†n).SincePi1/âˆ†2i=H,âˆ†i=pn/Hforalli.(17)givesP(bi6=iâˆ—)â‰¥121âˆ’1âˆ’112expâˆ’mnHn.Recallthetotalnumberofsamplesisgivenbynm.Ifmnâ‰¤H(logn+log(25Î´)âˆ’1),thenforÎ´âˆˆ(0,eâˆ’3/24)P(bi6=iâˆ—)â‰¥121âˆ’1âˆ’25Î´12nn(21)â‰¥121âˆ’expâˆ’25Î´12forallnâ‰¥1(22)â‰¥Î´(23)whichcompletesNotethat{âˆ†1,...,âˆ†n}satisfyPni=11/âˆ†2i=H.From(16),andbyconsideringonlythearmwiththesmallestgap,P(bi6=i)â‰¥12ï£«