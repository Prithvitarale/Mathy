JOURNALOFTHEAMERICANMATHEMATICALSOCIETYVolume21,Number1,January2008,Pages1–21S0894-0347(07)00573-5ArticleelectronicallypublishedonAugust9,2007EUCLIDEANDISTORTIONANDTHESPARSESTCUTSANJEEVARORA,JAMESR.LEE,ANDASSAFNAOR1.IntroductionBi-Lipschitzembeddingsofﬁnitemetricspaces,atopicoriginallystudiedingeo-metricanalysisandBanachspacetheory,becameanintegralpartoftheoreticalcomputersciencefollowingworkofLinial,London,andRabinovich[29].TheypresentedanalgorithmicversionofaresultofBourgain[8]whichshowsthatev-eryn-pointmetricspaceembedsintoL2withdistortionO(logn).Thisgeometricviewpointoﬀersawaytounderstandtheapproximationratiosachievedbylin-earprogramming(LP)andsemideﬁniteprogramming(SDP)relaxationsforcutproblems[29,6].Itsoonbecameapparentthatfurtherprogressinunderstand-ingSDPrelaxationswouldinvolveimprovingBourgain’sgeneralboundofO(logn)forn-pointmetricspacesofnegativetype.Forinstance,theapproximationratioachievedbyawell-knownSDPrelaxationforthegeneralSparsestCutproblemisknowntocoincideexactlywiththebestpossibledistortionboundachievablefortheembeddingofn-pointmetricsofnegativetypeintoL1—astrikingconnectionbetweenpuremathematicsandalgorithmdesign.Furtherprogressontheseproblemsrequirednewinsightsintothestructureofmetricspacesofnegativetypeandthedesignofmoresophisticatedandﬂexibleembeddingmethodsforﬁnitemetrics.Coincidentally,signiﬁcantprogresswasmaderecentlyonboththesefronts.Arora,RaoandVazirani[5]provedanewstructuraltheoremaboutmetricspacesofnegativetypeandusedittodesignanO(√logn)-approximationalgorithmfortheuniformcaseoftheSparsestCutprob-lem.Krauthgamer,Lee,MendelandNaor[22]introducedanewembeddingmethodcalledmeasureddescentwhichuniﬁedandstrengthenedmanyexistingembeddingtechniques,andtheyusedittosolveanumberofopenproblemsintheﬁeld.Thesebreakthroughsindeedresultedinimprovedembeddingsfornegativetypemetrics;Chawla,Gupta,andRäcke[11]usedthestructuraltheoremof[5](specif-ically,itsstrongerformduetoLee[24]),inconjunctionwithmeasureddescenttoshowthateveryn-pointmetricofnegativetypeembedsintoL2withdistor-tionO(logn)3/4.Inthepresentwork,weshowhowonecanachievedistortionReceivedbytheeditorsAugust8,2005.2000MathematicsSubjectClassiﬁcation.Primary51F99,46B07,68W25.Keywordsandphrases.Bi-Lipschitzembeddings,metricsofnegativetype,approximationalgorithms.TheﬁrstauthorwassupportedbyaDavidandLucilePackardFellowshipandNSFgrantCCR-0205594.ThesecondauthorwassupportedbyNSFgrantCCR-0121555andanNSFGraduateResearchFellowship.ThelastauthorwassupportedbyNSFgrantsCCF-06350782SANJEEVARORA,JAMESR.LEE,ANDASSAFNAORO(√logn·loglogn).Thisalmostmatchesthe35-year-oldlowerboundof√lognfromEnﬂo[14].Ourmethodsusetheresultsof[5,24,11]essentiallyasa“blackbox,”togetherwithanenhancementofthemeasureddescenttechnique.Recallthatametricspace(X,d)issaidtobeofnegativetypeif(X,√d)isisometrictoasubsetofEuclideanspace.Inparticular,itiswellknownthatL1isofnegativetype.(WealsoremindthereaderthatL2isisometricallyequivalenttoasubsetofL1.)Theparameterc2(X),knownastheEuclideandistortionofX,istheleastdistortionwithwhichXembedsintoHilbertspace,i.e.itistheminimumofdistortion(f)=fLip·f−1Lipoverallbijectionsf:X→L2.ThemathematicalinvestigationoftheproblemwestudyheregoesbacktotheworkofEnﬂo[14],whoshowedthattheEuclideandistortionoftheHammingcubeΩd={0,1}dequals√d=log2|Ωd|.Thefollowingnaturalquestionisfolkloreingeometricandfunctionalanalysis:“Isthediscreted-dimensionalhypercubethemostnon-Euclidean2d-pointsubsetofL1?”Apositiveanswertothisquestionwouldimplythatanyn-pointsubsetofL1embedsinL2withdistortionO(√logn).Infact,motivatedbyF.John’stheo-reminconvexgeometry(see[34]),JohnsonandLindenstrauss[20]askedin1983whethereveryn-pointmetricspaceembedsintoL2withdistortionO(√logn).Here,theanalogybetweenﬁnitedimensionalnormedspacesandﬁnitemetricspacesisnotcomplete:Bourgain[8]hasshownthatforanyn-pointmetricspaceX,c2(X)=O(logn),andthisresultisexistentiallyoptimal[29,6].Bynowweunder-standthatﬁnitemetricspaces(namelyexpandergraphs)canexhibitanisoperi-metricproﬁlewhichnoEuclideanspacecanachieve,andthisisthereasonfortheEUCLIDEANDISTORTIONANDTHESPARSESTCUT3actualdistortion.Asdescribedabove,combiningtheirresultwiththemeasureddescenttechniqueofKrauthgamer,Lee,MendelandNaor[22],Chawla,Gupta,andRäcke[11]haverecentlyprovedthatforanyn-pointmetricspaceXofnegativetype,c2(X)=O(logn)3/4.Itwasconjectured[31,pg.379]thatn-pointmetricsofnegativetypeembedintoL1withdistortionO(1).Recently,KhotandVish-noi[21]haveobtainedalowerboundofΩ(loglogn)δ,forsomeuniversalconstantδ>0.ThislowerboundhasbeenimprovedbyKrauthgamerandRabani[23]toΩ(loglogn).OurresultsalsosuggestthatthedimensionreductionlowerboundofBrinkmanandCharikar[9](seealso[26])istightforcertaindistortions.Theyshowthatembeddingcertainn-pointsubsetsofL1intod1withdistortionDrequiresthatd≥nΩ(1/D2).Theorem1.1,togetherwiththeoremsofJohnsonandLindenstrauss[20]andFigiel,Lindenstrauss,andMilman[16],yieldsanembeddingofeveryn-pointsubsetofL1intoO(logn)1withdistortionO(√logn·loglogn).1.1.Algorithmicapplication:TheSparsestCutproblemwithgeneraldemands.Inthissection,webrieﬂydescribeanapplicationofTheorem1.1totheSparsestCutproblemwithgeneraldemands(anditsrelationtothemulti-commodityﬂowproblem).ThisisafundamentalNP-hardcombinatorialoptimiza-tionproblem—werefertheinterestedreadertothearticles[28,2,29,6],thesur-vey[39],andChapter21ofthebook[40]foradditionalinformationonSparsestCut,anditsapplicationstothedesignofapproximationalgorithms.LetG=(V,E)beagraph(network),withacapacityC(e)≥0associatedtoeveryedgee∈E.Assumethatwearegivenkpairsofvertices(s1,t1),...,(sk,tk)∈V×VandD1,...,Dk≥1.Wethinkofthesiassources,thetiastargets,andthevalueDiasthedemandoftheterminalpair(si,ti)forsomecommodityκi.Theproblemissaidtohaveuniformdemandsifeverypairu,v∈Voccursassome(si,ti)pairwithDi=1.IntheMaxFlowproblemtheobjectiveistomaximizethefractionλofthedemandthatcanbeshippedsimultaneouslyforallthecommodities,subjecttothecapacityconstraints.Denotethismaximumbyλ∗.Atrivialupperboundonλ∗isthecutratio.GivenanysubsetS⊆V,wewriteΦ(S)=uv∈EC(uv)·|1S(u)−1S(v)|ki=1Di·|1S(si)−1S(ti)|,where1SisthecharacteristicfunctionofS.ThevalueΦ∗=minS⊆VΦ(S)istheminimumoverallcuts(partitions)ofV,oftheratiobetweenthetotalca-pacitycrossingthecutandthetotaldemandcrossingthecut.Inthecaseofasinglecommodity(i.e.k=1)theclassicalMaxFlow-MinCuttheoremstatesthatλ∗=Φ∗,butingeneralthisisnolongerthecase.Itisknown[28,29,6]thatΦ∗=O(logk)λ∗.Thisresultisperhapstheﬁrststrikingapplicationofmetricem-beddingsincombinatorialoptimization(speciﬁcally,itusesBourgain’sembeddingtheorem[8]).ComputingΦ∗isNP-hard[32].Moreover,ﬁndingacutforwhichΦ∗is(approx-imately)attainedisabasicstepinapproximationalgorithmsforseveralNP-hardproblems[28,2,39].ThebestknownalgorithmforcomputingΦ∗inthecaseofuni-formdemandsisdueto[5],whereanapproximationratioofO(√logn)isachieved.Licenseorcopyrightrestrictionsmayapplytoredistribution;seehttps://www.ams.org/journal-terms-of-use4SANJEEVARORA,JAMESR.LEE,ANDASSAFNAORInthecaseofnon-uniformdemands,anapproximationratioofO(logk)3/4isob-tainedin[11].Here,asanapplicationofTheorem1.1,weprovethefollowingtheorem:TheoremEUCLIDEANDISTORTIONANDTHESPARSESTCUT5hencedistortion(ϕ)=O(√Rlogn).Trivially,wecanchooseRsothat|R|≤n2.AslightlymoredelicateargumentyieldssuchanRwith|R|≤O(n).Unfortu-nately,wearesearchingforaboundoftheformdistortion(ϕ)≈√logn,makingthisconstructionuseless.Nevertheless,thekeytoabettergluingofthegivenensembledoeslieinthedelicateinterplaybetweenthedistributionsofdistancesinXandthenumberofpointsinvariousregionsofthespace.Thetechniqueofmeasureddescentfrom[22]reliesessentiallyontwofactsaboutﬁnitemetricspaces.First,theidentity(2)k∈Zlog|B(x,α·2k)||B(x,2k)|=O(lognlogα)foranynumberα≥2.(In[22],aﬁxedconstantvalueofαwasused,butforusthequantitativedependenceiscrucial,aswewillhaveαdependingonn.)Thisgivesasimpleboundontheratethataﬁnitemetricspacecanexpandoverallitsscalesandisimplicitlyusedinearlierworksunderthenameof“regiongrowing”[28,15].Forthepurposesofthisdescription,wewillstatethesecondfactlessconcretely.Basically,incertainsettings,onecanthinkoftheratio|B(x,6SANJEEVARORA,JAMESR.LEE,ANDASSAFNAORthecontributionof(I)in(3)isreplacedby(4)||ϕ̃2k(x)−ϕ̃2k(y)||2d(x,y)log|B(x,2k+1)||B(x,2kEUCLIDEANDISTORTIONANDTHESPARSESTCUT7Proof(sketch).Letg:Y→2besuchthatd(x,y)=||g(x)−g(y)||22forallx,y∈Y.By[33],thereexistsamapT:2→2suchthat||T(z)||2≤√∆forallz∈2and12≤||T(z)−T(z)||2min{√∆,||z−z||2}≤1for8SANJEEVARORA,JAMESR.LEE,ANDASSAFNAOR3.1.Paddeddecomposabilityandrandomzerosets.Theorem3.1istheonlywaythenegativetypepropertywillbeusedinwhatfollows.ItisthereforehelpfultointroduceitasEUCLIDEANDISTORTIONANDTHESPARSESTCUT9BythedeﬁnitionofαX,thereexistsadistributionoverpartitionsPofXintosubsetsofdiameterlessthan∆suchthatforeveryx∈Xwithprobabilityatleast1/2,πP(x)≥∆/αX.TherequiredresultnowfollowsbyconsideringtherandomzerosetZP.Weendthissectionwiththefollowingsimplelemma,whichshowsthattheexistenceofrandomzerosetsimpliestheexistenceofembeddingsintoL2whicharebi-Lipschitzonaﬁxeddistancescale.Lemma3.5(Randomzerosetsyieldsinglescaleembeddings).ForeveryﬁnitemetricspaceX,everyS⊆X,everyp∈(0,1),andeveryτ>0,thereexistsa1-Lipschitzmapping10SANJEEVARORA,JAMESR.LEE,ANDASSAFNAORLemma4.2(Extendingtoneighborhoods).LetS⊆X,τ≥0,andassumethatthereexistsa1-Lipschitzmapϕ:X→L2satisfying||ϕ(x)−ϕ(y)||2EUCLIDEANDISTORTIONANDTHESPARSESTCUT11Inwhatfollowsweshallusethefactthatforeveryτ>0thereexistsamappingGτ:L2→L2suchthatforeveryx,y∈12SANJEEVARORA,JAMESR.LEE,ANDASSAFNAORSinceweareassumingthatd(x,y)≤3τ,thisimpliesthatρ(x)=ρ(y)=1.ItfollowsthatE||Λτ,k(x)−Λτ,k(y)||2≥EUCLIDEANDISTORTIONANDTHESPARSESTCUT13Thenumberofnon-zerosummandsaboveisatmostO(logA+logB).Furthermore,eachsummandcanbeboundedasfollows.||ρm,t(x)φm(x)−ρm,t(y)φm(y)||2≤||φm(x)||2|ρm,t(x)−ρm,t(y)|+||φm(x)−φm(y)||2|ρm,t(y)|≤||ρm,t||Lip·2mB+||φm||14SANJEEVARORA,JAMESR.LEE,ANDASSAFNAORThenforeveryx,y∈Xwithx∈Jλ(τ)andd(x,y)≥τ,wehave||F(x)−F(y)||2≥(λ)τ,whereEUCLIDEANDISTORTIONANDTHESPARSESTCUT15(2)Forallx∈S2m(Kj)\S2m(Kj+1)andy∈Xsuchthatd(x,y)∈[2m,2m+1]wehave||fj(x)−fj(y)||22log|B(x,2m+3αX)||B(x,2m/[12C(logKj)ε])|·22mC2(logKj)2εlog|B(x,2m+3αX)||B(x,2m/[12C(logKj+1)ε])|·d(x,y)2C2(logKj)2ε(10)logKj+1·d(x,y)2C2(logKj)2ε(11)d(x,y)216SANJEEVARORA,JAMESR.LEE,ANDASSAFNAORProof.WeobservethatthemapsusedtoproveTheorem1.1,i.e.thoseproducedinLemma3.5andClaim4.6,areofFréchet-type.Inotherwords,thereisaprobabilityspaceEUCLIDEANDISTORTIONANDTHESPARSESTCUT17Thealgorithm.WenowgiveouralgorithmforroundingSDP(5.2).SupposethattheweightfunctionwDissupportedonlyonpairsu,vforwhichu,v∈U⊆V18SANJEEVARORA,JAMESR.LEE,ANDASSAFNAOR6.Concludingremarks•TherearetwofactorsofO(√loglogn)whichkeepourboundfrombeingoptimaluptoaconstantfactor.Onefactorof√logEUCLIDEANDISTORTIONANDTHESPARSESTCUT19η,then,asshowninthefullversionof[24],thereexistsconstantsp=p(η)andC=C(η),dependingonlyonη,suchthatζ(X;p)≤C√logn.AcknowledgementsWethankSatishRaoforusefuldiscussions.References[1]D.Achlioptas.Database-friendlyrandomprojections:Johnson-Lindenstrausswithbinarycoins.J.Comput.SystemSci.,66(4):671–687,2003.SpecialissueonPODS2001(SantaBarbara,CA).MR2005771(2004h:68027)[2]A.Agrawal,P.Klein,R.Ravi,andS.Rao.Approximationthroughmulticommodityﬂow.In31stAnnualSymposiumonFoundationsofComputerScience,pages726–737.IEEECom-puterSoc.,LosAlamitos,CA,1990.MR1150728(92j:90031)[3]S.Arora,E.Hazan,andS.Kale.O(√logn)approximationtoSPARSESTCUTinÕ(n2)time.In45thAnnualSyposiumonFoundationsofComputerScience,pages238–247.IEEEComputerSociety,2004.[4]S.Arora,J.R.Lee,andA.Naor.Fréchetembeddingsofnegativetypemetrics.Preprint,2005.[5]S.Arora,S.Rao,andU.Vazirani.Expanderﬂows,geometricembeddings,andgraphpar-titionings.In36thAnnualSymposiumontheTheoryofComputing,pages222–231,2004.MR2121604(2005j:68081)[6]Y.AumannandY.Rabani.AnO(logk)approximatemin-cutmax-ﬂowtheoremandap-proximationalgorithm.SIAMJ.Comput.,27(1):291–301(electronic),1998.MR1614825(99d:05078)[7]Y.Bartal.Probabilisticapproximationsofmetricspaceanditsalgorithmicapplication.In37thAnnualSymposiumonFoundationsofComputerScience,pages183–193,Oct.1996.MR1450616[8]J.Bourgain.OnLipschitzembeddingofﬁnitemetricspacesinHilbertspace.IsraelJ.Math.,52(1-2):46–52,1985.MR815600(87b:46017)[9]B.BrinkmanandM.Charikar.Ontheimpossibilityofdimensionreductionin1.InPro-ceedingsofthe44thAnnualIEEEConferenceonFoundationsofComputerScience,pages514–523,2003.[10]G.Calinescu,H.Karloﬀ,andY.Rabani.Approximationalgorithmsforthe0-extensionprob-lem.InProceedingsofthe12thAnnualACM-SIAMSymposiumonDiscreteAlgorithms,pages8–16,Philadelphia,PA,2001.MR1958386[11]S.Chawla,A.Gupta,andH.Räcke.Embeddingsofnegative-typemetricsandanimprovedapproximationtogeneralizedsparsestcut.InProceedingsofthe16thAnnualACM-SIAMSymposiumonDiscreteAlgorithms,pages102–111,Vancouver,2005.[12]S.Chawla,R.Krauthgamer,R.Kumar,Y.Rabani,andD.Sivakumar.Onembeddabilityofnegativetypemetricsinto1.InProceedingsofthe20thAnnualIEEEConferenceonComputationalComplexity,pages144–153,2005.[13]M.M.DezaandM.Laurent.Geometryofcutsandmetrics,volume15ofAlgorithmsandCombinatorics.Springer-Verlag,Berlin,1997.MR1460488(98g:52001)[14]P.Enﬂo.OnthenonexistenceofuniformhomeomorphismsbetweenLp-spaces.Ark.Mat.,8:103–105,1969.MR0271719(42:6600)[15]J.Fakcharoenphol,S.Rao,andK.Talwar.Atightboundonapproximatingarbitrarymetricsbytreemetrics.InProceedingsofthe35thAnnualACMSymposiumonTheoryofComputing,pages448–455,2003.MR2120458(2005j:68142)[16]T.Figiel,J.Lindenstrauss,andV.D.Milman.Thedimensionofalmostsphericalsectionsofconvexbodies.ActaMath.,139(1-2):53–94,1977.MR0445274(56:3618)[17]M.X.Goemans.Semideﬁniteprogrammingandcombinatorialoptimization.MathematicalProgramming,49:143–161,1997.MR1464765(98g:90028)[18]M.Grötschel,L.L.Lovász,andA.Schrijver.Theellipsoidmethodanditsconsequencesincombinatorialoptimization.Combinatorica,1:169–197,1981.MR625550(84a:90044)[19]J.Heinonen.Lecturesonanalysisonmetric20SANJEEVARORA,JAMESR.LEE,ANDASSAFNAOR[20]W.B.JohnsonandJ.Lindenstrauss.ExtensionsofLipschitzmappingsintoaHilbertspace.InConferenceinmodernanalysisandprobability(NewHaven,Conn.,1982),pages189–206.Amer.Math.Soc.,Providence,RI,1984.MR737400(86a:46018)[21]S.KhotandN.Vishnoi.Theuniquegamesconjecture,integralitygapforcutproblemsandembeddabilityofnegativetypemetricsinto1.InProceedingsofthe46thAnnualIEEEConferenceonFoundationsofComputerScience,pages53–62,2005.[22]R.Krauthgamer,J.R.Lee,M.Mendel,andA.Naor.Measureddescent:anewembed-dingmethodforﬁnitemetrics.Geom.Funct.Anal.,15(4):839–858,2005.MR2221152(2007f:68249)[23]R.KrauthgamerandY.Rabani.Improvedlowerboundsforembeddingsintol1.InProceed-ingsofthe17thannualACM-SIAMsymposiumonDiscretealgorithm,pages1010–1017.ACMPress,2006.[24]J.R.Lee.Ondistancescales,embeddings,andeﬃcientrelaxationsofthecutcone.InProceed-ingsofthe16thAnnualACM-SIAMSymposiumonDiscreteAlgorithms,pages92–101,Van-couver,2005.Availableathttp://www.cs.washington.edu/homes/jrl/papers/soda05-full.pdf.[25]J.R.Lee,M.Mendel,andA.Naor.MetricstructuresinL1:dimension,snowﬂakes,andaveragedistortion.EuropeanJ.Combin.,26(8):1180–1190,2005.MR2163751(2006g:46012)[26]J.R.LeeandA.Naor.EmbeddingthediamondgraphinLpanddimensionreductioninL1.Geom.Funct.Anal.,14(4):745–747,2004.MR2084978(2005g:46035)[27]J.R.LeeandA.Naor.ExtendingLipschitzfunctionsviarandommetricpartitions.Invent.Math.,160(1):59–95,2005.MR2129708(2006c:54013)[28]T.LeightonandS.Rao.Multicommoditymax-ﬂowmin-cuttheoremsandtheiruseinde-signingapproximationalgorithms.J.ACM,46(6):787–832,1999.MR1753034(2001e:05125)[29]N.Linial,E.London,andY.Rabinovich.Thegeometryofgraphsandsomeofitsalgorithmicapplications.Combinatorica,15(2):215–245,1995.MR1337355(96e:05158)[30]N.LinialandM.Saks.Lowdiametergraphdecompositions.Combinatorica,13(4):441–454,1993.MR1262920(95d:05123)[31]J.Matoušek.Lecturesondiscretegeometry,volume212ofGraduateTextsinMathematics.Springer-Verlag,NewYork,2002.MR1899299(2003f:52011)[32]D.W.MatulaandF.Shahrokhi.Themaximumconcurrentﬂowproblem.J.ACM,37(2):318–334,1990.MR1072261(91j:90029)[33]M.MendelandA.Naor.Euclideanquotientsofﬁnitemetricspaces.Adv.Math.,189(2):451–494,2004.MR2101227(2005h:54031)[34]V.D.MilmanandG.Schechtman.Asymptotictheoryofﬁnite-dimensionalnormedspaces,volume1200ofLectureNotesinMathematics.Springer-Verlag,Berlin,1986.Withanap-pendixbyM.Gromov.MR856576(87m:46038)[35]A.Naor,Y.Peres,O.Schramm,andS.Sheﬃeld.MarkovchainsinsmoothBanachspacesandGromov-hyperbolicmetricspaces.DukeMath.J.,134(1):165–197,2006.MR2239346[36]A.Naor,Y.Rabani,andA.Sinclair.Quasisymmetricembeddings,theobservablediameter,andexpansionpropertiesofgraphs.J.Funct.Anal.,227(2):273–303,2005.MR2168076(2006j:68092)[37]A.NaorandG.Schechtman.RemarksonnonlineartypeandPisier’sinequality.J.ReineAngew.Math.,552:213–236,2002.MR1940437(2003j:46010)[38]S.Rao.SmalldistortionandvolumepreservingembeddingsforplanarandEuclideanmetrics.InProceedingsofthe15thAnnualSymposiumonComputationalGeometry,pages300–306,NewYork,1999.MR1802217[39]D.B.Shmoys.Cutproblemsandtheirapplicationtodivide-and-conquer.InApproximationAlgorithmsforNP-hardProblems(D.S.Hochbaum,ed.),pages192–235.PWS,1997.[40]V.V.Vazirani.Approximationalgorithms.Springer-Verlag,Berlin,2001.MR1851303(2002h:68001)EUCLIDEANDISTORTIONANDTHESPARSESTCUT21DepartmentofComputerScience,PrincetonUniversity,356OldenStreet,Prince-ton,NewJersey08544-2087E-mailaddress:arora@cs.princeton.eduDepartmentofMathematics,UniversityofWashington,Seattle,Washington98195E-mailaddress:jrl@cs.washington.eduCourantInstituteofMathematicalSciences,