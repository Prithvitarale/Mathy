AregressionapproachforexplainingmanifoldembeddingcoordinatesMarinaMeila∗SamsonKoelleHanyuZhangDepartmentofStatisticsUniversityofWashingtonSeattle,WA98195-4322{mmp2,sjkoelle,hanyuz6}@uw.eduNovember30,2018AbstractManifoldembeddingalgorithmsmaphighdimensionaldata,downtocoordinatesinFigure1:ExplainingthecollectivecoordinatesinMolecularDynamics(MD)simulations.Insuchsimulations,amolecularconfigurationisrepresentedbytheD=3NavectorofspatiallocationsoftheNaatomscomprisingthemolecule(notshown).Left,byonemethodin[KvL15].ThemanifoldMisaRiemannianmanifoldwithRiemannianmetricinheritedfromtheambientspaceRD.Furthermore,weassumetheexistenceofasmoothembeddingmapφ:M→φ(M)⊂Rm,wheretypicallym<<D.Wecallthecoordinatesφ(ξi)inthismdimensionalambientspacetheembeddingcoordinates;letΦ=[φ(ξi)T]i=1:n∈Rn×m.Inpractice,themappingofthedataDontoφ(D)representstheoutputofanembeddingalgorithm,andweonlyhaveaccesstoMandφviaDanditsimageφ(D).Inaddition,wearegivenadictionaryofuser-definedanddomain-relatedsmoothfunctionsG={g1,...gp,withgj:RD→R}.Ourgoalistoexpresstheembeddingcoordinatefunctionsφ1...φmintermsoffunctionsinG.Moreprecisely,weassumethatφ(x)=h(gj1(x),...gjs(x))withh:O⊆Rs→Rmasmoothfunctionofsvariables,definedonaopensubsetofRscontainingtherangeofgj1,...gjs.LetS={j1,...js},andgS=[gj1(x),...gjs]T.TheproblemistodiscoverthesetS⊂[p]suchthatφ=h◦gS.WecallSthefunctionalsupportofh,ortheexplanationforthemanifoldMintermsofG.Forinstance,inthetolueneexample,thefunctionsinGareallthepossibletorsionsinthemolecule,s=1,andgS=τistheexplanationforthe1-dimensionalmanifoldtracedbytheconfigurations.IndeterminaciesIndifferentialgeometricterms,theexplanationgSisstronglyrelatedtofindingaparametrizationofM.Hence,|S|≥d.Sincethefunctionφgivenbytheembeddingalgorithmisnotunique,thefunctionhcannotbeuniquelydetermined.Moreover,wheneverg1=t(g2)wheretisasmoothmonotonicfunction,thesupportSmaynotbeuniqueeither.InSection7wegivesufficientandnecessaryconditionsunderwhichScanberecovereduniquely;intuitively,theyconsistoffunctionalindependenciesbetweenthefunctionsinG.Forinstance,itissufficienttoassumethatthatthedictionaryGisafunctionallyindependentset,i.e.thereisnog∈GthatcanbeobtainedasasmoothfunctionofotherfunctionsinG.Hence,inthispaperweresolvetheindeterminaciesw.r.t.thesupportS,andwelimitourscopetorecoveringS.WeleavetofutureworktheproblemofrecoveringinformationonhowthefunctionsgScombinetoexplainM.2Backgroundonmanifoldestimation:neighborhoodgraph,LaplacianandestimatingtangentsubspacesManifoldlearningandintrinsicgeometrySupposeweobservedatapointsξi∈RDthataresampledfromasmoothd-dimensionalsubmanifoldM⊂RD.Thetaskofmanifoldlearningistoprovideadiffeomorphismφ:M→φ(M)⊂RmwheremD.TheWhitneyEmbeddingTheorem[Lee03]guaranteestheexistenceofamapsatisfyingthispropertywithm≤2d.Hence,agoodmanifoldlearnerwillidentifyasmoothmapφ:M→Rmwithd≤m≤2dD.TheneighborhoodgraphandkernelmatrixTheneighborhoodgraphisadatastructurethatassociatestoeachdatapointξi∈DitssetofneighborsNi={i0∈[n],with||ξi0−ξi||≤rNmatrixK∈Rn×nwhoseelementsareKii0=(exp−||ξi−ξi0||2Nifi0∈Ni0otherwise.(1)Typically,theradiusrNandthebandwidthparameterNarerelatedbyrN=cNwithcasmallconstantgreaterthan1.ThisensuresthatKisclosetoitslimitwhenrN→∞whileremainingsparse,withsparsitystructureinducedbytheneighborhoodgraph.RowsofthismatrixwillbedenotedKi,Nitoemphasizethatwhenaparticularrowispassedtoanalgorithm,only|Ni|valuesneedtobepassed.Theneighborhoodgraph,localpositionmatrices,andkernelmatrixplaycrucialrolesinourmanifoldestimationtasks.EstimatingtangentspacesintheambientspaceRDThetangentsubspaceatpointξiinthedatacanbeestimatedbyWeightedLocalPrincipalComponentAnalysis,asdescribedintheLocalPCAalgorithm.TheoutputofthisalgorithmisanorthogonalmatrixTi∈RD×d,representingabasisforTξiM.ForthisalgorithmandotherswedefinetheSVDalgorithmSVD(X,d)ofasymmetricalmatrixXasoutputtingV,Λ,whereΛandVarethelargestdeigenvaluesandtheireigenvectors,respectively,anddenoteacolumnvectorofonesoflengthkby1k.Wedenote|Ni|byki.LocalPCA(localdataΞi,kernelrowKi,Ni,intrinsicdimensiond)1:Computeweightedmean¯ξi=(Ki,Ni1ki)−1Ki,NiΞi2:ComputeweightedlocaldifferencematrixZi=(Ki,Ni1ki)−1Ki,Ni(Ξi−1ki¯ξi)3:Φofthedata;theembeddingobtainedisknownastheDiffusionMap[CL06]ortheLaplacianEigenmap[BN02]ofD.Weusethisembeddingapproachforconvenience,butingeneral,anyalgorithmwhichasymptoticallygeneratesasmoothembeddingisacceptable.ThepushforwardRiemannianmetricGeometricquantitiessuchasanglesandlengthsofvectorsinthetangentbundleTM,distancesalongcurvesinM,etc.,arecapturedbyRiemanniangeometry.Weassumethat(M,id)isaRiemannianmanifold,withthemetricidinducedfromRD.Furthermore,weassociatewithφ(M)aRiemannianmetricgwhichpreservesthegeometryof(M,id).ThismetriciscalledthepushforwardRiemannianmetricandisdefinedbyhu,vig=hDφ−1(ξ)u,Dφ−1(ξ)viforallu,v∈Tφ(ξ)φ(M).(2)Intheabove,Dφ−1(ξ)mapsvectorsfromTφ(ξ)φ(M)toTξM,andh,iistheEuclideanscalarproduct.Foreachφ(ξi),theassociatedpush-forwardRiemannianmetricexpressedinthecoordinatesofRm,isasymmetric,semi-positivedefinitem×mmatrixGiofrankd.Thescalarproducthu,vigtakestheformuTGiv.ThematricesGicanbeestimatedbythealgorithmRMetricof[PM13].Thealgorithmusesonlylocalinformation,andthuscanberunefficiently.Fornotationalsimplicity,werefertothemembeddingcoordinatesofthepointsinaneighborhoodofapointiasΦi.RMetric(LaplacianrowLi,Ni,localembeddingcoordinatesΦi,intrinsicdimensiond)1:ComputecenteredlocalembeddingcoordinatesΦ̃i←Φi−φ(ξi)1Tki2:Hikk0=Li,Ni(Φ̃i,kΦ̃i,k0)fork,k0=1:m.Hi←[Hikk0]k,k0∈1:m3:ComputeVi,Λi←SVD(Hi,d)4:Gi←ViΛ−1iVTi.5:OutputGi3Flasso:sparsenon-linearfunctionalsupportrecoveryOurapproachforexplainingmanifoldcoordinatesispredicatedonthefollowinggeneralmethodfordecomposingareal-valuedfunctionfoveragivendictionaryG.Themainideaisthatwhenf=h◦g,theirdifferentialsDf,Dh,DgatanypointareinthelinearrelationshipDf=DhDg.Thisisexpressedmorepreciselyasfollows.Proposition1(LeibnizRule)Letf=h◦gSwithgS=[g1,g2,···,gs]T:RD→Rs,h:Rs→R.Allmapsareassumedtobesmooth.Thenateverypoint,∇f=∂h∂g1∇g1+∂h∂g2∇g2+...∂h∂gs∇gs,(3)or,inmatrixnotationDf=DhDgGivensamplesξ1:n∈RD,dictionaryG,andfunctionf,wewouldliketodiscoverthatfisafunctionofgSwithoutknowingh.Theusefulnessofthisdecompositionisthateveniff4ExplainingmanifoldcoordinateswithFLassoonthetan-gentbundleToexplainthecoordinatesφ1:mwiththeFLassomethodofSection3,weneed(i)toextendFLassotofunctionsdefinedonamanifoldM,and(ii)toTheFLassoobjectivefunctionisJλ(β)=12nXi=1mXk=1||yik−Xiβik||2+λ√mnpXj=1||βj||,(13)anexpressionidenticalIfwedesiredtoobtaingradxiφ(ξi)intheglobalRDcoordinates,itsufficestoexpressthecolumnsofAiasvectorsinRD(orequivalentlytoapplytheappropriatelineartransformationtoYusingCholeskydecomposition-basedsolvers.Finally,thelaststepisacalltotheGroupLasso,whichestimatesthesupportSofφ.ThecomputationtimeofeachiterationinGroupLassoisO(n2m2pd).Forlargedatasets,onesameapproachcanbeusedtodirectlyexplainthetangentsubspaceofM,independentlyofanyembedding.Second,onecouldsetupFLassoproblemsthatexplainasinglecoordinatefunction.Ingeneral,manifoldcoordinatesdonothaveindividualmeaning,soitwillnotbealwayspossibletofindagoodexplanationforasingleφk.However,Figure6showsthatfortheethanolmolecule,whosemanifoldisatorus,thereexistsacanonicalsystemofcoordinatesinwhicheachcoordinateisexplainedbyonethedomainspecificdictionaries,(2)lessobviously,descriptorslikeprincipalcurvesorLaplacianeigenfunctionsaregenerallystillnon-parametric(i.eexistininfinitedimensionalfunctionspaces),whiletheparametrizationsbydictionariesweobtain(e.gthetorsions)areinfinitedimensionalspaces.[DTCK18]tacklesarelatedproblem:choosingamongtheinfinitelymanyLaplacianeigenfunctionsdwhichprovidead-dimensionalparametrizationofthemanifold;theapproachistosolveasetofLocalLinearEmbedding[RS00]problems,eachaimingtorepresentaneigenfunctionasacombinationoftheprecedingones.7Uniquenessandrecoveryresults7.1FunctionaldependencyanduniquenessofrepresentationHerewestudytheconditionsunderwhichf=h◦gSisuniquelyrepresentedoveradictionaryGthatcontainsgS.Notsurprisingly,wewillshowthattheseareTheorem4AssumeGandgSaredefinedasinSection3,withg1:pareC`functionsinopensetU⊂RdandletS0⊂[p],S06=S,|S0ProofSinceϕisadiffeomorphism,wecanwriteuniquelyξ=ϕ(η)foreachξ∈M.Andalsoϕ−1(M)=Rd.Thentheoriginaldecompositionofφ(ξ)=h◦gSoneachnoiselevelσdefinedbynXi=1||i||2=ndσ2,(30)andinternalcolinearityν,definedasfollows.LetΣi=xTijxij0j,j0∈S=Solvingforβ̂S−β∗Sin(37),weobtainβ̂S−β∗S=(¯X̄TS¯X̄S)−1¯X̄TS¯−λẑS=Σ−1¯X̄TS¯−λẑS.(38)Afterreplacingtheabovein(36)wehavezj=−1λ¯X̄Tjh¯X̄SΣ−1¯X̄TSw−¯8Experimentalresults8.1FLassoonsyntheticdataWeillustratetheeffectivenessofFLassoforsparsefunctionalsupportrecoverywheretheoutputfunctioniscomposedofproductsofdictionaryfunctions.Insuchsituations,methodswhichonlyconsiderlinearcombinationsofFigure2:RegularizationpathofFLassoforExample1with100points.ThefirstrowshowssupportrecoveryoverarangeofλvaluesfordictionaryG1,andthesecondforG2.OntheleftareFigure3:RegularizationpathofFLassoforExample2with100points.Thefirstrowshowssupportrecoveryoverarangeofλvaluesford=8,andthesecondford=20.Toproducetheresultsontheleft,independentGaussiannoisewithσ2=0.05wasaddedtothedifferentialsofgandf,whileontherightσ2=0.1.FLassocoefficientsforthetruesupportarehighest.However,oneoftheelementsofthetruesupportdecaysABCFigure4:A)Thelearnedmanifoldontheentiredatasetcoloredbythefirstangleofrotation.B)Aradialsliceofthelearnedmanifoldcoloredbytheotherangleofrotation.C)Regularizationpathofapplyamanifoldlearningalgorithmtoidentifythelow-dimensionalmanifoldthesetrajectoriesdefine,seekanexplanationofthismanifoldintermsofbondtorsions.AmajorcomplicatingfactorinthisisthatthetrueconfigurationspaceisR3\SE(3)(the3−DspecialEuclideangroup),sinceconfigurationswhichdifferbyrotationsandtranslations(butnotmirrorimages)areequivalent.Torespectthissymmetry,weparametrizeeachconfigurationbytheanglesofthetrianglesformedbyeachcombinationofthreeatoms.Torsionsarecomputedwithrespecttotheangularrepresentation.8.3.1TolueneThetoluenemoleculehasonerotationaldegreeoffreedom.Themanifoldlearningalgorithmthereforediscoversthatthedatamanifoldisacircle.Outofafunctionaldictionaryconsistingoftheputativelysignificantdihedralangleandseveralotherdihedralangles,Figure6:RegularizationpathofFLassoformoleculardynamicssimulationethanolwith8repeatsofselecting200randompointsoutof50000usedtolearnthemanifold.References[BN02]M.BelkinandP.Niyogi.Laplacianeigenmapsandspectraltechniquesfor[ESJ+17]M.K.Elyaderani,S.Jain,J.M.Druce,S.Gonella,andJ.D.Haupt.Improvedsupportrecov-eryguaranteesforthegrouplassowithapplicationstostructuralhealthmonitoring.CoRR,abs/1708.08826,2017.[Gea12]CWGear.Parameterizationofnon-linearmanifolds.August2012.[HAvL05]Matthias