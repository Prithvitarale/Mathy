AregressionapproachforexplainingmanifoldembeddingcoordinatesMarinaMeilaâˆ—SamsonKoelleHanyuZhangDepartmentofStatisticsUniversityofWashingtonSeattle,WA98195-4322{mmp2,sjkoelle,hanyuz6}@uw.eduNovember30,2018AbstractManifoldembeddingalgorithmsmaphighdimensionaldata,downtocoordinatesinFigure1:ExplainingthecollectivecoordinatesinMolecularDynamics(MD)simulations.Insuchsimulations,amolecularconfigurationisrepresentedbytheD=3NavectorofspatiallocationsoftheNaatomscomprisingthemolecule(notshown).Left,byonemethodin[KvL15].ThemanifoldMisaRiemannianmanifoldwithRiemannianmetricinheritedfromtheambientspaceRD.Furthermore,weassumetheexistenceofasmoothembeddingmapÏ†:Mâ†’Ï†(M)âŠ‚Rm,wheretypicallym<<D.WecallthecoordinatesÏ†(Î¾i)inthismdimensionalambientspacetheembeddingcoordinates;letÎ¦=[Ï†(Î¾i)T]i=1:nâˆˆRnÃ—m.Inpractice,themappingofthedataDontoÏ†(D)representstheoutputofanembeddingalgorithm,andweonlyhaveaccesstoMandÏ†viaDanditsimageÏ†(D).Inaddition,wearegivenadictionaryofuser-definedanddomain-relatedsmoothfunctionsG={g1,...gp,withgj:RDâ†’R}.OurgoalistoexpresstheembeddingcoordinatefunctionsÏ†1...Ï†mintermsoffunctionsinG.Moreprecisely,weassumethatÏ†(x)=h(gj1(x),...gjs(x))withh:OâŠ†Rsâ†’Rmasmoothfunctionofsvariables,definedonaopensubsetofRscontainingtherangeofgj1,...gjs.LetS={j1,...js},andgS=[gj1(x),...gjs]T.TheproblemistodiscoverthesetSâŠ‚[p]suchthatÏ†=hâ—¦gS.WecallSthefunctionalsupportofh,ortheexplanationforthemanifoldMintermsofG.Forinstance,inthetolueneexample,thefunctionsinGareallthepossibletorsionsinthemolecule,s=1,andgS=Ï„istheexplanationforthe1-dimensionalmanifoldtracedbytheconfigurations.IndeterminaciesIndifferentialgeometricterms,theexplanationgSisstronglyrelatedtofindingaparametrizationofM.Hence,|S|â‰¥d.SincethefunctionÏ†givenbytheembeddingalgorithmisnotunique,thefunctionhcannotbeuniquelydetermined.Moreover,wheneverg1=t(g2)wheretisasmoothmonotonicfunction,thesupportSmaynotbeuniqueeither.InSection7wegivesufficientandnecessaryconditionsunderwhichScanberecovereduniquely;intuitively,theyconsistoffunctionalindependenciesbetweenthefunctionsinG.Forinstance,itissufficienttoassumethatthatthedictionaryGisafunctionallyindependentset,i.e.thereisnogâˆˆGthatcanbeobtainedasasmoothfunctionofotherfunctionsinG.Hence,inthispaperweresolvetheindeterminaciesw.r.t.thesupportS,andwelimitourscopetorecoveringS.WeleavetofutureworktheproblemofrecoveringinformationonhowthefunctionsgScombinetoexplainM.2Backgroundonmanifoldestimation:neighborhoodgraph,LaplacianandestimatingtangentsubspacesManifoldlearningandintrinsicgeometrySupposeweobservedatapointsÎ¾iâˆˆRDthataresampledfromasmoothd-dimensionalsubmanifoldMâŠ‚RD.ThetaskofmanifoldlearningistoprovideadiffeomorphismÏ†:Mâ†’Ï†(M)âŠ‚RmwheremD.TheWhitneyEmbeddingTheorem[Lee03]guaranteestheexistenceofamapsatisfyingthispropertywithmâ‰¤2d.Hence,agoodmanifoldlearnerwillidentifyasmoothmapÏ†:Mâ†’Rmwithdâ‰¤mâ‰¤2dD.TheneighborhoodgraphandkernelmatrixTheneighborhoodgraphisadatastructurethatassociatestoeachdatapointÎ¾iâˆˆDitssetofneighborsNi={i0âˆˆ[n],with||Î¾i0âˆ’Î¾i||â‰¤rNmatrixKâˆˆRnÃ—nwhoseelementsareKii0=(expâˆ’||Î¾iâˆ’Î¾i0||2Nifi0âˆˆNi0otherwise.(1)Typically,theradiusrNandthebandwidthparameterNarerelatedbyrN=cNwithcasmallconstantgreaterthan1.ThisensuresthatKisclosetoitslimitwhenrNâ†’âˆžwhileremainingsparse,withsparsitystructureinducedbytheneighborhoodgraph.RowsofthismatrixwillbedenotedKi,Nitoemphasizethatwhenaparticularrowispassedtoanalgorithm,only|Ni|valuesneedtobepassed.Theneighborhoodgraph,localpositionmatrices,andkernelmatrixplaycrucialrolesinourmanifoldestimationtasks.EstimatingtangentspacesintheambientspaceRDThetangentsubspaceatpointÎ¾iinthedatacanbeestimatedbyWeightedLocalPrincipalComponentAnalysis,asdescribedintheLocalPCAalgorithm.TheoutputofthisalgorithmisanorthogonalmatrixTiâˆˆRDÃ—d,representingabasisforTÎ¾iM.ForthisalgorithmandotherswedefinetheSVDalgorithmSVD(X,d)ofasymmetricalmatrixXasoutputtingV,Î›,whereÎ›andVarethelargestdeigenvaluesandtheireigenvectors,respectively,anddenoteacolumnvectorofonesoflengthkby1k.Wedenote|Ni|byki.LocalPCA(localdataÎži,kernelrowKi,Ni,intrinsicdimensiond)1:ComputeweightedmeanÂ¯Î¾i=(Ki,Ni1ki)âˆ’1Ki,NiÎži2:ComputeweightedlocaldifferencematrixZi=(Ki,Ni1ki)âˆ’1Ki,Ni(Îžiâˆ’1kiÂ¯Î¾i)3:Î¦ofthedata;theembeddingobtainedisknownastheDiffusionMap[CL06]ortheLaplacianEigenmap[BN02]ofD.Weusethisembeddingapproachforconvenience,butingeneral,anyalgorithmwhichasymptoticallygeneratesasmoothembeddingisacceptable.ThepushforwardRiemannianmetricGeometricquantitiessuchasanglesandlengthsofvectorsinthetangentbundleTM,distancesalongcurvesinM,etc.,arecapturedbyRiemanniangeometry.Weassumethat(M,id)isaRiemannianmanifold,withthemetricidinducedfromRD.Furthermore,weassociatewithÏ†(M)aRiemannianmetricgwhichpreservesthegeometryof(M,id).ThismetriciscalledthepushforwardRiemannianmetricandisdefinedbyhu,vig=hDÏ†âˆ’1(Î¾)u,DÏ†âˆ’1(Î¾)viforallu,vâˆˆTÏ†(Î¾)Ï†(M).(2)Intheabove,DÏ†âˆ’1(Î¾)mapsvectorsfromTÏ†(Î¾)Ï†(M)toTÎ¾M,andh,iistheEuclideanscalarproduct.ForeachÏ†(Î¾i),theassociatedpush-forwardRiemannianmetricexpressedinthecoordinatesofRm,isasymmetric,semi-positivedefinitemÃ—mmatrixGiofrankd.Thescalarproducthu,vigtakestheformuTGiv.ThematricesGicanbeestimatedbythealgorithmRMetricof[PM13].Thealgorithmusesonlylocalinformation,andthuscanberunefficiently.Fornotationalsimplicity,werefertothemembeddingcoordinatesofthepointsinaneighborhoodofapointiasÎ¦i.RMetric(LaplacianrowLi,Ni,localembeddingcoordinatesÎ¦i,intrinsicdimensiond)1:ComputecenteredlocalembeddingcoordinatesÎ¦Ìƒiâ†Î¦iâˆ’Ï†(Î¾i)1Tki2:Hikk0=Li,Ni(Î¦Ìƒi,kÎ¦Ìƒi,k0)fork,k0=1:m.Hiâ†[Hikk0]k,k0âˆˆ1:m3:ComputeVi,Î›iâ†SVD(Hi,d)4:Giâ†ViÎ›âˆ’1iVTi.5:OutputGi3Flasso:sparsenon-linearfunctionalsupportrecoveryOurapproachforexplainingmanifoldcoordinatesispredicatedonthefollowinggeneralmethodfordecomposingareal-valuedfunctionfoveragivendictionaryG.Themainideaisthatwhenf=hâ—¦g,theirdifferentialsDf,Dh,DgatanypointareinthelinearrelationshipDf=DhDg.Thisisexpressedmorepreciselyasfollows.Proposition1(LeibnizRule)Letf=hâ—¦gSwithgS=[g1,g2,Â·Â·Â·,gs]T:RDâ†’Rs,h:Rsâ†’R.Allmapsareassumedtobesmooth.Thenateverypoint,âˆ‡f=âˆ‚hâˆ‚g1âˆ‡g1+âˆ‚hâˆ‚g2âˆ‡g2+...âˆ‚hâˆ‚gsâˆ‡gs,(3)or,inmatrixnotationDf=DhDgGivensamplesÎ¾1:nâˆˆRD,dictionaryG,andfunctionf,wewouldliketodiscoverthatfisafunctionofgSwithoutknowingh.Theusefulnessofthisdecompositionisthateveniff4ExplainingmanifoldcoordinateswithFLassoonthetan-gentbundleToexplainthecoordinatesÏ†1:mwiththeFLassomethodofSection3,weneed(i)toextendFLassotofunctionsdefinedonamanifoldM,and(ii)toTheFLassoobjectivefunctionisJÎ»(Î²)=12nXi=1mXk=1||yikâˆ’XiÎ²ik||2+Î»âˆšmnpXj=1||Î²j||,(13)anexpressionidenticalIfwedesiredtoobtaingradxiÏ†(Î¾i)intheglobalRDcoordinates,itsufficestoexpressthecolumnsofAiasvectorsinRD(orequivalentlytoapplytheappropriatelineartransformationtoYusingCholeskydecomposition-basedsolvers.Finally,thelaststepisacalltotheGroupLasso,whichestimatesthesupportSofÏ†.ThecomputationtimeofeachiterationinGroupLassoisO(n2m2pd).Forlargedatasets,onesameapproachcanbeusedtodirectlyexplainthetangentsubspaceofM,independentlyofanyembedding.Second,onecouldsetupFLassoproblemsthatexplainasinglecoordinatefunction.Ingeneral,manifoldcoordinatesdonothaveindividualmeaning,soitwillnotbealwayspossibletofindagoodexplanationforasingleÏ†k.However,Figure6showsthatfortheethanolmolecule,whosemanifoldisatorus,thereexistsacanonicalsystemofcoordinatesinwhicheachcoordinateisexplainedbyonethedomainspecificdictionaries,(2)lessobviously,descriptorslikeprincipalcurvesorLaplacianeigenfunctionsaregenerallystillnon-parametric(i.eexistininfinitedimensionalfunctionspaces),whiletheparametrizationsbydictionariesweobtain(e.gthetorsions)areinfinitedimensionalspaces.[DTCK18]tacklesarelatedproblem:choosingamongtheinfinitelymanyLaplacianeigenfunctionsdwhichprovidead-dimensionalparametrizationofthemanifold;theapproachistosolveasetofLocalLinearEmbedding[RS00]problems,eachaimingtorepresentaneigenfunctionasacombinationoftheprecedingones.7Uniquenessandrecoveryresults7.1FunctionaldependencyanduniquenessofrepresentationHerewestudytheconditionsunderwhichf=hâ—¦gSisuniquelyrepresentedoveradictionaryGthatcontainsgS.Notsurprisingly,wewillshowthattheseareTheorem4AssumeGandgSaredefinedasinSection3,withg1:pareC`functionsinopensetUâŠ‚RdandletS0âŠ‚[p],S06=S,|S0ProofSinceÏ•isadiffeomorphism,wecanwriteuniquelyÎ¾=Ï•(Î·)foreachÎ¾âˆˆM.AndalsoÏ•âˆ’1(M)=Rd.ThentheoriginaldecompositionofÏ†(Î¾)=hâ—¦gSoneachnoiselevelÏƒdefinedbynXi=1||i||2=ndÏƒ2,(30)andinternalcolinearityÎ½,definedasfollows.LetÎ£i=xTijxij0j,j0âˆˆS=SolvingforÎ²Ì‚Sâˆ’Î²âˆ—Sin(37),weobtainÎ²Ì‚Sâˆ’Î²âˆ—S=(Â¯XÌ„TSÂ¯XÌ„S)âˆ’1Â¯XÌ„TSÂ¯âˆ’Î»zÌ‚S=Î£âˆ’1Â¯XÌ„TSÂ¯âˆ’Î»zÌ‚S.(38)Afterreplacingtheabovein(36)wehavezj=âˆ’1Î»Â¯XÌ„TjhÂ¯XÌ„SÎ£âˆ’1Â¯XÌ„TSwâˆ’Â¯8Experimentalresults8.1FLassoonsyntheticdataWeillustratetheeffectivenessofFLassoforsparsefunctionalsupportrecoverywheretheoutputfunctioniscomposedofproductsofdictionaryfunctions.Insuchsituations,methodswhichonlyconsiderlinearcombinationsofFigure2:RegularizationpathofFLassoforExample1with100points.ThefirstrowshowssupportrecoveryoverarangeofÎ»valuesfordictionaryG1,andthesecondforG2.OntheleftareFigure3:RegularizationpathofFLassoforExample2with100points.ThefirstrowshowssupportrecoveryoverarangeofÎ»valuesford=8,andthesecondford=20.Toproducetheresultsontheleft,independentGaussiannoisewithÏƒ2=0.05wasaddedtothedifferentialsofgandf,whileontherightÏƒ2=0.1.FLassocoefficientsforthetruesupportarehighest.However,oneoftheelementsofthetruesupportdecaysABCFigure4:A)Thelearnedmanifoldontheentiredatasetcoloredbythefirstangleofrotation.B)Aradialsliceofthelearnedmanifoldcoloredbytheotherangleofrotation.C)Regularizationpathofapplyamanifoldlearningalgorithmtoidentifythelow-dimensionalmanifoldthesetrajectoriesdefine,seekanexplanationofthismanifoldintermsofbondtorsions.AmajorcomplicatingfactorinthisisthatthetrueconfigurationspaceisR3\SE(3)(the3âˆ’DspecialEuclideangroup),sinceconfigurationswhichdifferbyrotationsandtranslations(butnotmirrorimages)areequivalent.Torespectthissymmetry,weparametrizeeachconfigurationbytheanglesofthetrianglesformedbyeachcombinationofthreeatoms.Torsionsarecomputedwithrespecttotheangularrepresentation.8.3.1TolueneThetoluenemoleculehasonerotationaldegreeoffreedom.Themanifoldlearningalgorithmthereforediscoversthatthedatamanifoldisacircle.Outofafunctionaldictionaryconsistingoftheputativelysignificantdihedralangleandseveralotherdihedralangles,Figure6:RegularizationpathofFLassoformoleculardynamicssimulationethanolwith8repeatsofselecting200randompointsoutof50000usedtolearnthemanifold.References[BN02]M.BelkinandP.Niyogi.Laplacianeigenmapsandspectraltechniquesfor[ESJ+17]M.K.Elyaderani,S.Jain,J.M.Druce,S.Gonella,andJ.D.Haupt.Improvedsupportrecov-eryguaranteesforthegrouplassowithapplicationstostructuralhealthmonitoring.CoRR,abs/1708.08826,2017.[Gea12]CWGear.Parameterizationofnon-linearmanifolds.August2012.[HAvL05]Matthias