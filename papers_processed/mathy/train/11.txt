UniversityofPennsylvaniaScholarlyCommonsStatisticsPapersWhartonFacultyResearch2008StochasticLinearOptimizationUnderBanditFeedbackVarshaDaniUniversityofChicagoThomasP.HayesToyotaTechnologicalInstituteShamM.KakadeUniversityofPennsylvaniaFollowthisandadditionalworksat:http://repository.upenn.edu/statistics_papersStochasticLinearOptimizationUnderBanditFeedbackAbstractIntheclassicalstochastick-armedbanditproblem,ineachofasequenceofTrounds,adecisionmakerchoosesoneofkarmsandincursacostchosenfromanunknowndistributionassociatedwiththatarm.Thegoalistominimizeregret,definedasthedifferencebetweenthecostincurredbythealgorithmandtheoptimalcost.Inthelinearoptimizationversionofthisproblem(firstconsideredbyAuer[2002]),weviewthearmsasvectorsinRn,andrequirethatthecostsbelinearfunctionsofthechosenvector.Asbefore,itisassumedthatthecostfunctionsaresampledindependentlyfromanunknowndistribution.Inthissetting,thegoalistofindalgorithmswhoserunningtimeandregretbehavewellasfunctionsofthenumberofroundsTandthedimensionalityn(ratherthanthenumberofarms,k,whichmaybeexponentialinnoreveninfinite).Wegiveanearlycompletecharacterizationofthisproblemintermsofbothupperandlowerboundsfortheregret.Incertainspecialcases(suchaswhenthedecisionregionisapolytope),theregretispolylog(T).Ingeneralthough,theoptimalregretisΘ∗(√T)—ourlowerboundsruleoutthepossibilityofobtainingpolylog(T)ratesingeneral.Wepresenttwovariantsofanalgorithmbasedontheideaof“upperconfidencebounds.”Thefirst,duetoAuer[2002],butnotfullyanalyzed,obtainsregretwhosedependenceonnandTarebothessentiallyoptimal,butwhichmaybecomputationallyintractablewhenthedecisionsetisapolytope.Thesecondversioncanbeefficientlyimplementedwhenthedecisionsetisapolytope(givenasanintersectionofhalf-spaces),butgivesupafactorof√nintheregretbound.Ourresultsalsoextendtothesettingwherethesetsampledfromπ.Onlythelossf(x)isrevealedtothelearner(andnotthefunctionf(·)).Weassumethattheexpectedlossisafixedlinearfunction,i.e.thatE[f(x)]=µ·x,wheretheexpectationiswithrespecttofsampledfromπ(technically,wemakeaslightlyweakerassumption,preciselystatedinthenextsection).ThegoalistominimizethetotallossoverTsteps.Asisstandard,successismeasuredbytheregret—thedifferencebetweentheperformanceofthelearnerandthatoftheoptimalalgorithmwhichhasknowledgeofπ.Notethattheoptimalalgorithmheresimplychoosesthebestdecisionwithrespecttothelinearmeanvectorµ.Perhapsthemostimportantandnaturalexampleinthisparadigmisthe(stochastic)onlinelinearprogrammingprob-lem.Here,Disspecifiedbylinearinequalityconstraints.Ifthemeanµwereknown,thenthisissimplyalinearpro-grammingproblem.Instead,ateachround,thelearneronlyobservesnoisyfeedbackofthechosendecision,withrespecttotheunderlyinglinearcostfunction.1.1SummaryofOurResultsandRelatedWorkAuer[2002]providesthefirstanalysisofthisproblem.ThispaperbuildsandimprovesupontheworkofAuer[2002]inanumberofways.ArelatedmodelwasconsideredbyAbeandLong[1999],wherethedecisionsetsareallowedtovaryasafunctionofthetime.Ourresultscanbeextendedtothismoregeneralmodel,whichwediscussinSection7.WhileAuer[2002]providesanelegantdeterministical-gorithm,basedonupperconfidenceboundsofµ,ananalysisoftheperformanceofthisalgorithmwasnotprovided,duetorathersubtleindependenceissues(thoughitwasconjecturedthatthissimplealgorithmwassufficient).Instead,amorecomplicatedmasteralgorithmwasanalyzed—thismasteralgorithmcalledthesimplerupperconfidencealgorithmasasubroutine.Inthiswork,wedirectlyanalyzethesimplerup-perconfidencealgorithm.Unfortunately,implementingthisalgorithmincertaincases(whenDislargeorinfinite)maybeinefficient.However,wealsoprovideamodificationtothisalgorithm(thatusesadifferentconfidenceregionbasedontheL1-norm),whichmaybeimplementedefficientlyforthecasewhenDisan(infinite)convexset,givencertainor-acleoptimizationaccesstoD.TheanalysisofAuer[2002]achievesaregretboundofO∗((log|D|)3/2poly(n)√T)wherenisdimensionofthedecisionspace,Tisthetimehorizon,and|D|isthenumberoffeasibledecisions.Forthesimplerupperconfidencealgo-rithm,weshowthatitenjoysaboundofO∗(n√T),whichdoesnotdependonthecardinalityofthedecisionregion,|D|.Whilethisalgorithmmaybeinefficientinsomecases,wealsoprovideanefficientalgorithm(thatusesaslightlydifferentconfidenceregion),whichachievesaslightlyworseboundofO∗(n3/2√T).UsingtheresultinAuer[2002],onecanalsoderiveaboundoftheformO(poly(n)√T)forin-finitedecisionsetsbyappealingtoanaive(inefficient)cov-eringargument(wherethealgorithmisrunonanappropri-atelyfinecoverofD).However,thisargumentresultsinalesssharpboundintermsofn1,thoughabetterreductionto1UsingAuer[2002],onecanderivethelesssharpboundofO∗(n5/2√T)forarbitrarycompactdecisionsetswithtwoobser-vations.First,throughacoveringargument,weneedonlyconsiderAuer[2002]maybepossible.Forthecaseoffinitedecisionsets,suchastheK-armbanditcase,aregretthatisonlylogarithmicinthetimehori-zonisachievable.Inparticular,inadifferentlineofwork,Aueretal.[2002]showedthattheoptimalregretfortheK-armbanditcasewascharacterizedasK∆logT,where∆isthe“gap”betweentheperformanceofthebestarmandthesecondbestarm.Thisresultisstatedintermsoftheproblemdependentconstant∆,soonecanviewitastheasymptoticregretforagivenproblem.Infact,historically,thereislonglineofworkintheK-armbanditliterature(e.g.[LaiandRobbins.,1985,Agrawal,1995])concernedwithobtainingoptimalratesforafixedproblem,whichareoftenlogarith-micinTwhenstatedintermsofsomeproblemdependentconstant.Hence,inoursetting,inthecasewhere|D|isfinite,weknowthatalogratewhichmeasurestheerrorofbµtasanapproximationtothetruemean,µ,underthenorminducedbyAt.Wewillshowthat,withprobabilitygreaterthan1−δ,Zt≤βtforalltforeitheralgorithm.ForConfidenceBall2,thisdirectlyimpliesthatµ∈B2t.ForConfidenceBall1,notethat||A1/2t(bµt−µ)||1≤√n||A1/2t(bµt−µ)||2=pnZtsoifZt≤βtthenµ∈B1t.ThenextlemmaboundsthegrowthofZt.Lemma12Forallt,Zt≤n+2t−1Xτ=1ητx†τ(bµτ−µ)1+w2τ+t−1Xτ=1η2τw2τ1+w2τ.Proof:Fornotationalconvenience,define:Yt=At(bµt−µ)Wehavethefollowingrelations:Zt=Y†tA−1tYtYt=Xτ<tητxτ−µYt+1=Yt+ηtxtwhichareimmediatefromthedefinitionsofAt,bµt,andηt.NowexaminingthegrowthofZt,wehave:Zt+1=Y†t+1A−1t+1Yt+1=(Yt+ηtxt)†A−1t+1(Yt+ηtxt)=Y†tA−1t+1Yt+2ηtx†tA−1t+1Yt+η2tx†tA−1t+1xt(1)ApplyingthematrixinversionlemmatoA−1t+1,wenotethat:A−1t+1=(At+xtx†t)−1=A−1t−A−1txtx†tA−1t1+x†tA−1txt=A−1t−A−1txtx†tA−1t1+w2tWecanusethistoboundthethreetermsof(1)asfollows.Forthefirstterm,Y†tA−1t+1Yt=Y†tA−1tYt−(Y†tA−1txt)21+w2t≤Zt.Forthesecondterm,2ηtx†tA−1t+1Yt=2ηtx†tA−1tYt−2ηtx†tA−1txtx†tA−1tYt1+w2t=2ηtx†tA−1tYt−2ηtw2tx†tA−1tYt1+w2t=2ηtx†tA−1tYt1+w2t=2ηtx†t(bµt−6LowerBoundAnalysisRecallnisevenandthatDn=(S1)n/2istheCartesianproductofn/2circles,i.e.Dn={(x1,...,xn):x21+x22=x23+x24=···=x2n−1+x2n=1}.Underthecostvectorµ∈Dn/n,onecanseethattheprobabilityofobservingaparticularloss`inthenextroundequalsPr(`t=`|µ,xt)=1+`µ·xt2.(3)since`thassupport{−1,1}andmeanµ·xt.Notetheprob-abilitythat`t=1isboundedbetween1/4and3/4.Also,theoptimaldecisionisx∗=−nµ∈Dn,whichachievesanexpectedlossofµ·x∗=−1/2.Fixanindex1≤i≤n/2,andconsiderR(i)T,thecontri-butiontothetotalregretfromthechoiceofx(i)=(x2i−1,x2i),i.e.,thecomponentfromthei’thcircle.Moreprecisely,R(i)T=TXt=1(µ(i)·x(i)t+1n)=TXt=1r(i)Twhereµ(i)=(µ2i−1,µ2i)andr(i)Tistheinstantaneousre-gret.Clearly,wehaveRT=Pn/2i=1R(i)T.Thus,theproofofTheorem3reducestoprovingalowerboundE(R(i)T)=Ω(√T).Letusconditionontheeventthatthei’thcomponentofµ,namely(µ2i−1,µ2i),isoneoftwovectors,ν1,ν2∈S1/n,suchthatkν1−ν2k=ε(whereε≤2/n).Wefurtherconditionontheexactvaluesoftheothern/2−1componentsofµ,thusleavingonlytwopossibilitiesforµ,whichwecallµ1andµ2.Wedenoteε=kν1−ν2k=kµ1−µ2k.Notethatµisuniformover{µ1,µ2}inthisevent.Ultimately,wewillchooseεasafunctionTandn.Tomakethisconditioningprecise,considerthefollow-ingtwo-stagesamplingprocedureforµ,wherewefirstsam-pleµ1andµ2andthensampleµuniformlyatrandomover{µ1,µ2}—wedothissamplingsuchthatthemarginaldis-tributionoverµisstilluniformoverDn/n.Moreprecisely,firstsampleν1andν2suchthat||ν1−ν2||=εandsuchthatthemarginaldistributionsProb(ν1)andProb(ν2)arebothuniformoverS1/n.Independently,sampletheremain-ingcomponentsµ(j),wherej6=i,uniformlyatrandomoverS1/n.Thisprovidesuswithµ1andµ2(whichonlydifferinthei-thcomponent).Finally,wesampleµuniformlyatrandomover{µ1,µ2}.Bythetowerpropertyofconditionalexpectations(Fubini’stheorem),E(r(i)t)=EEµ(r(i)t|Ht,{µ1,µ2})wheretheinnerexpectationisoverµwhichliesin{µ1,µ2}.OurnextLemma,roughlyspeaking,provesthatdeci-sionsxtthatprovidemoreinformationaboutthevalueofµ,necessarilyproducemoreinstantaneousregret.More-over,theresultholdsevenifthealgorithmwereallowedtomagicallyknowthevaluesofµ1,µ2.Thisplacesthealgo-rithmdesigneronthehornsofadilemma:giveupondis-tinguishingthecasesµ=µ1andµ=µ2,orplayhigh-regretdecisionstotrytoacquiretheinformation.AsweshallseeintheproofofTheorem3,eitherway,weendupwithE(R(i)T=Ω(√T):intheformercase,withcertainty,andinthelattercase,withhighprobability.Letbt:=Pr(µ=µ1|Ht)−Pr(µ=µ2|Ht)bethebiastowardsµ1attimet.Notethatb0=0,andthatthesequence(bt)isamartingalewithrespectto(Ht).OurLemmagivesalowerboundonregretintermsofthemartingaledifferencesbt+1−bt.Wehavenotattemptedtooptimizetheconstants.Lemma15Forεasdefinedabove,forallt≥1,foranyse-quenceofdecisionsx1,...,xtandoutcomes`1,...,`t−1,`t,theregretfromroundtsatisfiesEµ(r(i)t|Ht,{µ1,µ2})≥7nε2256+|bt+1−bt|218nε21{|bt|≤1/2}.Proof:Letpt=Pr(µ=µ1|Ht).Thenbt=2pt−1.ByBayes’ruleandequation3,wehavethat:pt+1=Pr(`t|µ=µ1)ptPr(`t|Ht)=pt(1+`t(µ1·xt))pt(1+`t(µ1·xt))+(1−pt)(1+`t(µ2·xt))=pt(1+`t(µ1·xt))1+pt`t(µ1·xt)+(1−pt)`t(µ2·xt)Hencebt+1−bt=2(pt+1−pt)=2pt(1+`t(µ1·xt))−pt−p2t`t(µ1·xt)−pt(1−pt)`t(µ2·xt)1+pt`t(µ1·xt)+(1−pt)`t(µ2·xt)=2pt(1−pt)`t(µ1−µ2)·xt1+pt`tµ1·xt+(1−pt)`tµ2·xt.Since|µi·xt|≤kµikkxtk=q12npn2=1/2,thede-nominatoroftheaboveexpressionisatleast1/2.Sincept(1−pt)≤1/4,itfollowsthat|bt+1−bt|≤|`t||(µ1−µ2)·xt|=|`t||(ν1−ν2)·x(i)t|=ε|α|,(4)whereαmaybedefinedasfollows.Letv1betheunitvectorinthedirectionofν1−ν2,andletv2betheunitvectorinthedirectionofν1+ν2.Notethatv1,v2isanorthonormalbasisfortheplane,sincekν1k=kν2k.Decomposex(i)t=αv1+βv2,andE(µ(i)|Ht,{µ1,µ2})=γv1+δv2.Bydefinitionofbt,E(µ(i)|Ht,{µ1,µ2})=ν1+ν22+btν