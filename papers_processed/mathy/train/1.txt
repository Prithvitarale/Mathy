FairAlgorithmsforInfiniteandContextualBanditsMatthewJoseph∗1MichaelKearns†1JamieMorgenstern‡1SethNeel§2AaronRoth¶11ComputerandInformationScience,UniversityofPennsylvania2StatisticsDepartment,TheWhartonSchool,UniversityofPennsylvaniaAbstractWestudyfairnessinlinearbanditproblems.StartingfromthenotionofmeritocraticfairnessintroducedinJosephetal.[2016],wecarryoutamorerefinedanalysisofamoregeneralproblem,achievingbetterperformanceguaranteeswithfewermodellingassumptionsonthenumberandstructureofavailablechoicesaswellasthenumberselected.Wealsoanalyzethepreviously-unstudiedquestionoffairnessininfinitelinearbanditproblems,obtaininginstance-dependentregretupperboundsaswellaslowerboundsdemonstratingthatthisinstance-dependenceisnecessary.Theresultisaframeworkformeritocratichireexactlyone(ratherthanmorallqualifiedapplicants)introducinganunrealisticelementofcompetitionandunfairnessbothbetweenapplicantsandbetweengroups.Theaforementionedassumptionsareunrealisticinmanypracticalsettings;ourworkshowstheyarealsounnecessary.#selectedeachround#optionseachroundTechniqueNotesRegretExactlyj≤k≤kPlayallofchainsindescendingorder,randomizingoverlastchainasnecessarytopickexactlyjRequiresrandomnessÕdkj√significantlymoregeneralandrealisticsetting.Inthefinitecaseweallowforavariablenumberofindividualsineachroundfromavariablenumberofgroupsandalsoallowselectionofavariablenumberofindividualsineachround,•Ifπtisadiscretedistribution:Forgt(x)=πt(x)(theprobabilitymassfunction)gt(x)≥gt(x0).•Ifπtisacontinuousdistribution:Forgt(x)=ft(x)(theprobabilitydensityfunction)gt(x)≥gt(x0).•Ifπtcanbewrittenasamixturedistribution:Piαiπti,Piαi=1,suchthateachconstituentWepausetocompareourboundfor1-bandittothatfoundinJosephetal.[2016].Theirworksupposesthateachofkgroupshasanindependentd-dimensionallinearfunctiongoverningitsrewardandprovidesafairalgorithmregretupperbody.Weprovefairnessandboundregretbyanalyzingtherateatwhichrandomexplorationshrinksourconfidenceintervalsandrelatingittothefrequencyofexploitation,afunctionof∆gap.Webeginbyformallydefining∆gapparameterhowchoicesetgeometrycanaffecttheperformanceoffairalgorithms.ThelowerboundemploysaBayesianargumentresemblingthatinJosephetal.[2016]butwithanovel“chaining”argumentsuitedtoinfiniteactionsets.Wepresenttheresultford=2forsimplicity;theprooftechniqueholdsinanydimensiond≥2.Theorem3.ForalltletCt=[−1,1]d,β∈[−1,1]d,andyt=hxt,βi+ηt,whereηt∼U[−1,1].LetAbeanyfairalgorithm.Thenforeverygap∆gap,thereisadistributionoverinstanceswithgapΩ(∆gap)suchthatanyfairalgorithmhasregretRegret(T)=Ω̃(1/∆gap)withprobability1−δ.Weasketchofthecentralideasintheproof,relegatingafullprooftotheSupplement.WestartwiththefactthatanyfairalgorithmAisrequiredtobefairforanyvalueβofthelinearparameter.6ZeroGap:ImpossibilityResultSection4presentsanalgorithmforwhichthesublinearregretboundhasdependence1/∆2gapontheinstancegap.Section5exhibitsanchoicesetCwithaΩ̃(1/∆gap)dependenceontheReferencesYasinAbbasi-Yadkori,DávidPál,andCsabaSzepesvári.Improvedalgorithmsforlinearstochasticbandits.InAdvancesinNeuralInformationProcessingSystems,pages2312–2320,2011.NaokiAbe,AlanWBiermann,andPhilipMLong.Reinforcementlearningwithimmediaterewardsandlinearhypotheses.Algorithmica,37(4):263–293,2003.VenkatachalamAnantharam,PravinVaraiya,andJeanWalrand.Asymptoticallyefficientallocationrulesforthemultiarmedbanditproblemwithmultipleplays–parti:I.i.d.rewards.IEEETransactionsonAutomaticControl,AC-32(Nov):968–976,1987.PeterAuer.Usingconfidenceboundsforexploitation-explorationtrade-offs.JournalofMachineLearningResearch,3(Nov):397–422,2002.RichardBerk,HodaHeidari,ShahinJabbari,MichaelKearns,andAaronRoth.Fairnessincriminaljusticeriskassessments:Thestateoftheart.arXivpreprintarXiv:1703.09207,2017.AlexandraChouldechova.Fairpredictionwithdisparateimpact:Astudyofbiasinrecidivismpredictioninstruments.arXivpreprintarXiv:1703.00056,2017.SamCorbett-Davies,EmmaPierson,AviFeller,SharadGoel,andAzizHuq.Algorithmicdecisionmakingandthecostoffairness.arXivpreprintarXiv:1701.08230,2017.VarshaDani,ThomasPHayes,andShamMKakade.Stochasticlinearoptimizationunderbanditfeedback.InCOLT,pages355–366,7Appendix7.1Sub-GaussianDefinitionSub-GaussianrandomvariableshavemomentgeneratingfunctionsboundedbytheGaussianmomentgeneratingfunction,andhencecanbecontrolledviaChernoffbounds.Definition3.ArandomvariableXwithµ=E[X]isR||XtTηt||(V̄t)−1≤pdlog(1+t/dγ)−2logδ=rdlog(1+t/γ)+2log1δ≤r2dlog(1+t/γ)+2dlog1δ=s2dlog1δ(1+t/dγ)≤s2dlog1δ(1+t/γ)=s2dlog1+t/γδ.Usingthisresultandcombiningtheinequalitieswegetthatoverallroundst≥0withprobability1−δ|xt,i·β̂t−β|≤||xt,i||(V̄t)−1s2dlog1+t/γδ+√γ!(2)andthereforetheclaimthattheconfidenceintervalsarevalidholds.RegretboundforRidgeFair1Wenowproceedwithupper-boundingtheregretofRidgeFair1.Withprobability1−δ,theconfidenceintervalsarevalid.WewillconditiononthateventfortheR(T)≤Xtrt,ît≤XtXj∈St2wt,jConditioningonw.p.1−δvalidconfidenceintervals=2Xt|St|·Ehwt,îtiWhenuniformlyselectingît∈St;notethisholdsw.p.1conditionedonvalidCI≤2k·XtEhwt,îti=2k·E"Xtwt,ît#BylinearityofRegretboundforRidgeFair≤kTheregretboundforthiscasereducestolower-boundingtheamountofrewardincurredbyplayingarmswithnegativereward.AnyindividualselectedbyRidgeFair≤kiswithinthesumofthewidthsoftheFinally,sinceFairGapreliesonconstructedconfidenceintervalstoguideitschoiceofactions,itscorrectness(bothintermsofitsregretguaranteeanditsfairness)reliesonthecorrectnessofthoseconfidenceintervals,statedinthefollowinglemma.ItsproofreliesonanaturalargumentusingmatrixChernoffboundstoboundthecontributionofnoisetoFairGap’sestimationofβ̂tand,consequently,theaccuracyofitsconfidenceintervals.Lemma3.GivensequenceofactionsetsC=(C1,...,CT)whereeachCthasnonzeroLebesguemeasureandiscontainedinaballofradiusr,withprobabilityatleast1−δ,ineveryroundteveryconfidenceinterval[hβ̂t,xi−wt,hβ̂tTodoso,wefirstnotethatforany1≤i≤tandanyx∈Ciwehaveλmax(xTx)≤r2bytheGershgorincircletheorem,whichstatesthatasquareThus,theregretintotalisatmostLXt=12r2+δT≤16r6R2ln(2T/δ)κ2λ2∆2gap+δTwhereL=8r4R2ln(2t/δ)κ2λ2∆2gapandδ≤1/(T1+c)thenimpliestheclaim.7.4EfficientApproximateVersionofSection4InthissectionwedescribeanefficientimplementationofFairGapusingapproximatefairness.RecallthatFairGaprequiressomemethodofsamplinguniformlyatrandomfromagivenconvexbodyCt,aproblemthathasattractedextensiveattentionoverthepastfewdecades(seeVempala[2005]forasurveyofresults).Forourpurposes,theprimarycontributionofthisliteratureisthatonecannotdobetterthanapproximatelyLemma6.LetC=(C1,...,CT)beasequenceofactionsetswhereeachactionset,inadditiontosatisfyingtheassumptionsofTheorem4,isanintersectionofpolynomiallymanyhalfspacesandcontainsaballofradiusr0.Thenthroughtroundsofexploration||Pπ1,...,πt∼FairGap−Pπ1,...,πt∼ApproxFairGap(/t)||TV<whereeachPrepresentsdistributionsoverpossibleexplorationhistoriesgeneratedbyFairGapandApproxFairGap(/t)respectively.ProofofLemma6.Byconstruction,duringexplorationeachπioutputbyApproxFairGap()hasadistri-butionwithin/tofauniformdistributionintotalvariationdistance.Sincethesesamplesareindependent,eachdistributionoverπ1,...,πtformsaproductdistribution,andtheadditivityoftotalvariationdistanceoverproductdistributionsimpliestheclaim.CombiningtheresultsaboveletsusprovethatApproxFairGapisfair,efficient,andobtainsasimilarregretboundasFairGap.Theorem5.ConsideranactionsetC7.5ProofsfromSection5ProofofTheorem3.LetAbeafairalgorithm.Foranyinputδ,Aisround-fairforallt≥1withprobability1−δ.Sincethisholdsforanyβwithprobabilityatleast1−δ,thenitnecessarilyholdswithprobabilityatleast1−δoveranypriorτonβwithsupportcontainedintheunitrectangle.Ourfirstlemmagivesanalternativewaytoviewtheframeworkwhichdrawsβ∼τandwherethelastequalityfollowsfromthefactthatηt+1∼U[0,2].Theprobabilitythatthelowerboundisgreaterthan−issimilarlyPyt0−1−xt0WenowconditiononF∩EtoshowthatwithhighprobabilityRegret(T)=Ω̃(1):PRegret(T)≥Ω̃1≥PRegret(T)≥Ω̃Ifk=1,thenbydiagonalequivalencexisequivalenttox0=(1−α,−1+2α/)=(z1,1+2α/).Butbyverticalequivalence,y∈Hx0,andsoy∈Hx,bytransitivity.Fortheinductivestep,constructx0=(z1+α,z2−2α/).Then1−x01=1−z1−α=(k−1)α.Hencebyinductionx0∈Hx.Butsincex0isdiagonallyequivalenttoy=(z1,z2),theny∈Hxasdesired.Sinceywasarbitrarilychosen,Hx=Ct.SeeFigure5foravisualizationoftheseequivalences.NowwehavethatG2+∈Sx0,t,sinceifβ∈S0t,+thenforallz∈G2+,β·z>β·x0,andhencez∈Sx0,t=Sx,t.ThesamelogicshowsthatG2+⊂Sx01,t=Sx,t.Sincewecankeeprecursivelychainingsegmentsoffixedlength4toSx,t,andS1:procedureRidgeFairm(δ,T,k,γ≥1,ExactBool)2:fort≥1,1≤i≤kdo3:LetXt,Yt=designmatrix,observedpayoffsbeforeroundt4:LetC1:procedureFairGap(δ,C,λ)2:fort≥1do3:if2rln(2dt/δ)/λ≥tthen4:Playx̂t∼UARCt5:UpdatedesignmatricesXt+1,Yt+16:else7:Letδ=min(δ,1/t1+c)8:Letβ̂t=(XtTXt)−1XtTYt.Leastsquaresestimator9:Letκ=1−rp2ln(2dt/δ)/tλ10:Letwt=r2·R·2√ln(2tδ)kλ√t.Confidenceintervalwidth11:Let(x1,x2)=TopTwo(Ct,β̂t).Findtwoext.pts.maximizinghx,β̂ti12:LetU1=[hβ̂t,x1i−wt,hβ̂t,x1i+wt]13:LetU2=[hβ̂t,x2i−wt,hβ̂t,x2i+wt]14:ifU1∩U2=∅then15:LetFoundMax={x}16:Playx̂t=x.Playx̂tonceconfidenceintervalsseparate17:else18:Playx̂t∼UARCt19:UpdatedesignmatricesXt+1,Yt+1Figure4:FairGap,afairno-regretalgorithmforinfinite,changingactionsets.xy(1−α,−1+2α)(1,−1)(z1,z2)k·αFigure5:Apathconnecting(1,−1)toanarbitrarypoint(z1,z2):redsegmentsareverticallyFigure6:AmustplayUARfromD=S1.|Gt|=;|S0t,−|=|St,−|=34;|S0t,+|=|St,+|=|G1,+Figure7:Cumulative