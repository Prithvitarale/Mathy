FairAlgorithmsforInfiniteandContextualBanditsMatthewJosephâˆ—1MichaelKearnsâ€ 1JamieMorgensternâ€¡1SethNeelÂ§2AaronRothÂ¶11ComputerandInformationScience,UniversityofPennsylvania2StatisticsDepartment,TheWhartonSchool,UniversityofPennsylvaniaAbstractWestudyfairnessinlinearbanditproblems.StartingfromthenotionofmeritocraticfairnessintroducedinJosephetal.[2016],wecarryoutamorerefinedanalysisofamoregeneralproblem,achievingbetterperformanceguaranteeswithfewermodellingassumptionsonthenumberandstructureofavailablechoicesaswellasthenumberselected.Wealsoanalyzethepreviously-unstudiedquestionoffairnessininfinitelinearbanditproblems,obtaininginstance-dependentregretupperboundsaswellaslowerboundsdemonstratingthatthisinstance-dependenceisnecessary.Theresultisaframeworkformeritocratichireexactlyone(ratherthanmorallqualifiedapplicants)introducinganunrealisticelementofcompetitionandunfairnessbothbetweenapplicantsandbetweengroups.Theaforementionedassumptionsareunrealisticinmanypracticalsettings;ourworkshowstheyarealsounnecessary.#selectedeachround#optionseachroundTechniqueNotesRegretExactlyjâ‰¤kâ‰¤kPlayallofchainsindescendingorder,randomizingoverlastchainasnecessarytopickexactlyjRequiresrandomnessOÌƒdkjâˆšsignificantlymoregeneralandrealisticsetting.Inthefinitecaseweallowforavariablenumberofindividualsineachroundfromavariablenumberofgroupsandalsoallowselectionofavariablenumberofindividualsineachround,â€¢IfÏ€tisadiscretedistribution:Forgt(x)=Ï€t(x)(theprobabilitymassfunction)gt(x)â‰¥gt(x0).â€¢IfÏ€tisacontinuousdistribution:Forgt(x)=ft(x)(theprobabilitydensityfunction)gt(x)â‰¥gt(x0).â€¢IfÏ€tcanbewrittenasamixturedistribution:PiÎ±iÏ€ti,PiÎ±i=1,suchthateachconstituentWepausetocompareourboundfor1-bandittothatfoundinJosephetal.[2016].Theirworksupposesthateachofkgroupshasanindependentd-dimensionallinearfunctiongoverningitsrewardandprovidesafairalgorithmregretupperbody.Weprovefairnessandboundregretbyanalyzingtherateatwhichrandomexplorationshrinksourconfidenceintervalsandrelatingittothefrequencyofexploitation,afunctionofâˆ†gap.Webeginbyformallydefiningâˆ†gapparameterhowchoicesetgeometrycanaffecttheperformanceoffairalgorithms.ThelowerboundemploysaBayesianargumentresemblingthatinJosephetal.[2016]butwithanovelâ€œchainingâ€argumentsuitedtoinfiniteactionsets.Wepresenttheresultford=2forsimplicity;theprooftechniqueholdsinanydimensiondâ‰¥2.Theorem3.ForalltletCt=[âˆ’1,1]d,Î²âˆˆ[âˆ’1,1]d,andyt=hxt,Î²i+Î·t,whereÎ·tâˆ¼U[âˆ’1,1].LetAbeanyfairalgorithm.Thenforeverygapâˆ†gap,thereisadistributionoverinstanceswithgapâ„¦(âˆ†gap)suchthatanyfairalgorithmhasregretRegret(T)=â„¦Ìƒ(1/âˆ†gap)withprobability1âˆ’Î´.Weasketchofthecentralideasintheproof,relegatingafullprooftotheSupplement.WestartwiththefactthatanyfairalgorithmAisrequiredtobefairforanyvalueÎ²ofthelinearparameter.6ZeroGap:ImpossibilityResultSection4presentsanalgorithmforwhichthesublinearregretboundhasdependence1/âˆ†2gapontheinstancegap.Section5exhibitsanchoicesetCwithaâ„¦Ìƒ(1/âˆ†gap)dependenceontheReferencesYasinAbbasi-Yadkori,DÃ¡vidPÃ¡l,andCsabaSzepesvÃ¡ri.Improvedalgorithmsforlinearstochasticbandits.InAdvancesinNeuralInformationProcessingSystems,pages2312â€“2320,2011.NaokiAbe,AlanWBiermann,andPhilipMLong.Reinforcementlearningwithimmediaterewardsandlinearhypotheses.Algorithmica,37(4):263â€“293,2003.VenkatachalamAnantharam,PravinVaraiya,andJeanWalrand.Asymptoticallyefficientallocationrulesforthemultiarmedbanditproblemwithmultipleplaysâ€“parti:I.i.d.rewards.IEEETransactionsonAutomaticControl,AC-32(Nov):968â€“976,1987.PeterAuer.Usingconfidenceboundsforexploitation-explorationtrade-offs.JournalofMachineLearningResearch,3(Nov):397â€“422,2002.RichardBerk,HodaHeidari,ShahinJabbari,MichaelKearns,andAaronRoth.Fairnessincriminaljusticeriskassessments:Thestateoftheart.arXivpreprintarXiv:1703.09207,2017.AlexandraChouldechova.Fairpredictionwithdisparateimpact:Astudyofbiasinrecidivismpredictioninstruments.arXivpreprintarXiv:1703.00056,2017.SamCorbett-Davies,EmmaPierson,AviFeller,SharadGoel,andAzizHuq.Algorithmicdecisionmakingandthecostoffairness.arXivpreprintarXiv:1701.08230,2017.VarshaDani,ThomasPHayes,andShamMKakade.Stochasticlinearoptimizationunderbanditfeedback.InCOLT,pages355â€“366,7Appendix7.1Sub-GaussianDefinitionSub-GaussianrandomvariableshavemomentgeneratingfunctionsboundedbytheGaussianmomentgeneratingfunction,andhencecanbecontrolledviaChernoffbounds.Definition3.ArandomvariableXwithÂµ=E[X]isR||XtTÎ·t||(VÌ„t)âˆ’1â‰¤pdlog(1+t/dÎ³)âˆ’2logÎ´=rdlog(1+t/Î³)+2log1Î´â‰¤r2dlog(1+t/Î³)+2dlog1Î´=s2dlog1Î´(1+t/dÎ³)â‰¤s2dlog1Î´(1+t/Î³)=s2dlog1+t/Î³Î´.Usingthisresultandcombiningtheinequalitieswegetthatoverallroundstâ‰¥0withprobability1âˆ’Î´|xt,iÂ·Î²Ì‚tâˆ’Î²|â‰¤||xt,i||(VÌ„t)âˆ’1s2dlog1+t/Î³Î´+âˆšÎ³!(2)andthereforetheclaimthattheconfidenceintervalsarevalidholds.RegretboundforRidgeFair1Wenowproceedwithupper-boundingtheregretofRidgeFair1.Withprobability1âˆ’Î´,theconfidenceintervalsarevalid.WewillconditiononthateventfortheR(T)â‰¤Xtrt,iÌ‚tâ‰¤XtXjâˆˆSt2wt,jConditioningonw.p.1âˆ’Î´validconfidenceintervals=2Xt|St|Â·Ehwt,iÌ‚tiWhenuniformlyselectingiÌ‚tâˆˆSt;notethisholdsw.p.1conditionedonvalidCIâ‰¤2kÂ·XtEhwt,iÌ‚ti=2kÂ·E"Xtwt,iÌ‚t#BylinearityofRegretboundforRidgeFairâ‰¤kTheregretboundforthiscasereducestolower-boundingtheamountofrewardincurredbyplayingarmswithnegativereward.AnyindividualselectedbyRidgeFairâ‰¤kiswithinthesumofthewidthsoftheFinally,sinceFairGapreliesonconstructedconfidenceintervalstoguideitschoiceofactions,itscorrectness(bothintermsofitsregretguaranteeanditsfairness)reliesonthecorrectnessofthoseconfidenceintervals,statedinthefollowinglemma.ItsproofreliesonanaturalargumentusingmatrixChernoffboundstoboundthecontributionofnoisetoFairGapâ€™sestimationofÎ²Ì‚tand,consequently,theaccuracyofitsconfidenceintervals.Lemma3.GivensequenceofactionsetsC=(C1,...,CT)whereeachCthasnonzeroLebesguemeasureandiscontainedinaballofradiusr,withprobabilityatleast1âˆ’Î´,ineveryroundteveryconfidenceinterval[hÎ²Ì‚t,xiâˆ’wt,hÎ²Ì‚tTodoso,wefirstnotethatforany1â‰¤iâ‰¤tandanyxâˆˆCiwehaveÎ»max(xTx)â‰¤r2bytheGershgorincircletheorem,whichstatesthatasquareThus,theregretintotalisatmostLXt=12r2+Î´Tâ‰¤16r6R2ln(2T/Î´)Îº2Î»2âˆ†2gap+Î´TwhereL=8r4R2ln(2t/Î´)Îº2Î»2âˆ†2gapandÎ´â‰¤1/(T1+c)thenimpliestheclaim.7.4EfficientApproximateVersionofSection4InthissectionwedescribeanefficientimplementationofFairGapusingapproximatefairness.RecallthatFairGaprequiressomemethodofsamplinguniformlyatrandomfromagivenconvexbodyCt,aproblemthathasattractedextensiveattentionoverthepastfewdecades(seeVempala[2005]forasurveyofresults).Forourpurposes,theprimarycontributionofthisliteratureisthatonecannotdobetterthanapproximatelyLemma6.LetC=(C1,...,CT)beasequenceofactionsetswhereeachactionset,inadditiontosatisfyingtheassumptionsofTheorem4,isanintersectionofpolynomiallymanyhalfspacesandcontainsaballofradiusr0.Thenthroughtroundsofexploration||PÏ€1,...,Ï€tâˆ¼FairGapâˆ’PÏ€1,...,Ï€tâˆ¼ApproxFairGap(/t)||TV<whereeachPrepresentsdistributionsoverpossibleexplorationhistoriesgeneratedbyFairGapandApproxFairGap(/t)respectively.ProofofLemma6.Byconstruction,duringexplorationeachÏ€ioutputbyApproxFairGap()hasadistri-butionwithin/tofauniformdistributionintotalvariationdistance.Sincethesesamplesareindependent,eachdistributionoverÏ€1,...,Ï€tformsaproductdistribution,andtheadditivityoftotalvariationdistanceoverproductdistributionsimpliestheclaim.CombiningtheresultsaboveletsusprovethatApproxFairGapisfair,efficient,andobtainsasimilarregretboundasFairGap.Theorem5.ConsideranactionsetC7.5ProofsfromSection5ProofofTheorem3.LetAbeafairalgorithm.ForanyinputÎ´,Aisround-fairforalltâ‰¥1withprobability1âˆ’Î´.SincethisholdsforanyÎ²withprobabilityatleast1âˆ’Î´,thenitnecessarilyholdswithprobabilityatleast1âˆ’Î´overanypriorÏ„onÎ²withsupportcontainedintheunitrectangle.OurfirstlemmagivesanalternativewaytoviewtheframeworkwhichdrawsÎ²âˆ¼Ï„andwherethelastequalityfollowsfromthefactthatÎ·t+1âˆ¼U[0,2].Theprobabilitythatthelowerboundisgreaterthanâˆ’issimilarlyPyt0âˆ’1âˆ’xt0WenowconditiononFâˆ©EtoshowthatwithhighprobabilityRegret(T)=â„¦Ìƒ(1):PRegret(T)â‰¥â„¦Ìƒ1â‰¥PRegret(T)â‰¥â„¦ÌƒIfk=1,thenbydiagonalequivalencexisequivalenttox0=(1âˆ’Î±,âˆ’1+2Î±/)=(z1,1+2Î±/).Butbyverticalequivalence,yâˆˆHx0,andsoyâˆˆHx,bytransitivity.Fortheinductivestep,constructx0=(z1+Î±,z2âˆ’2Î±/).Then1âˆ’x01=1âˆ’z1âˆ’Î±=(kâˆ’1)Î±.Hencebyinductionx0âˆˆHx.Butsincex0isdiagonallyequivalenttoy=(z1,z2),thenyâˆˆHxasdesired.Sinceywasarbitrarilychosen,Hx=Ct.SeeFigure5foravisualizationoftheseequivalences.NowwehavethatG2+âˆˆSx0,t,sinceifÎ²âˆˆS0t,+thenforallzâˆˆG2+,Î²Â·z>Î²Â·x0,andhencezâˆˆSx0,t=Sx,t.ThesamelogicshowsthatG2+âŠ‚Sx01,t=Sx,t.Sincewecankeeprecursivelychainingsegmentsoffixedlength4toSx,t,andS1:procedureRidgeFairm(Î´,T,k,Î³â‰¥1,ExactBool)2:fortâ‰¥1,1â‰¤iâ‰¤kdo3:LetXt,Yt=designmatrix,observedpayoffsbeforeroundt4:LetC1:procedureFairGap(Î´,C,Î»)2:fortâ‰¥1do3:if2rln(2dt/Î´)/Î»â‰¥tthen4:PlayxÌ‚tâˆ¼UARCt5:UpdatedesignmatricesXt+1,Yt+16:else7:LetÎ´=min(Î´,1/t1+c)8:LetÎ²Ì‚t=(XtTXt)âˆ’1XtTYt.Leastsquaresestimator9:LetÎº=1âˆ’rp2ln(2dt/Î´)/tÎ»10:Letwt=r2Â·RÂ·2âˆšln(2tÎ´)kÎ»âˆšt.Confidenceintervalwidth11:Let(x1,x2)=TopTwo(Ct,Î²Ì‚t).Findtwoext.pts.maximizinghx,Î²Ì‚ti12:LetU1=[hÎ²Ì‚t,x1iâˆ’wt,hÎ²Ì‚t,x1i+wt]13:LetU2=[hÎ²Ì‚t,x2iâˆ’wt,hÎ²Ì‚t,x2i+wt]14:ifU1âˆ©U2=âˆ…then15:LetFoundMax={x}16:PlayxÌ‚t=x.PlayxÌ‚tonceconfidenceintervalsseparate17:else18:PlayxÌ‚tâˆ¼UARCt19:UpdatedesignmatricesXt+1,Yt+1Figure4:FairGap,afairno-regretalgorithmforinfinite,changingactionsets.xy(1âˆ’Î±,âˆ’1+2Î±)(1,âˆ’1)(z1,z2)kÂ·Î±Figure5:Apathconnecting(1,âˆ’1)toanarbitrarypoint(z1,z2):redsegmentsareverticallyFigure6:AmustplayUARfromD=S1.|Gt|=;|S0t,âˆ’|=|St,âˆ’|=34;|S0t,+|=|St,+|=|G1,+Figure7:Cumulative