Boundedgeometries,fractals,andlow-distortionembeddingsAnupamGupta‚àóRobertKrauthgamer‚Ä†JamesR.Lee‚Ä°AbstractThedoublingconstantofametricspace(X,d)isthesmallestvalueŒªsuchthateveryballinXcanbecoveredbyŒªballsofhalftheradius.ThedoublingdimensionofXisthendefinedasdim(X)=log2Œª.Ametric(orsequenceofmetrics)iscalleddoublingpreciselywhenitsdoublingdi-mensionisbounded.ThisisarobustclassofmetricspacesthisnotionmorethoroughlyinSection1.3.Notonlyaredoublingmetricsinterestingobjectsintheirownright,buttheyarealsoofpracticalconcern.Growthrestrictionsareverynaturalandarethoughttooccurinreal-worldphenomenasuchaspeer-to-peernetworks(seee.g.[30])anddataanalysis(e.g.,whentheinputdatare-sidesonalow-dimensionalmanifold,cf.[34]).Infact,variousalgorithmscanbetailoredtorunefficientlyoncer-tainclassesofgrowth-restrictedmetrics,asdemonstratedin[8,31,16,17].Themetricsconsideredthereareeitherequivalenttoorasubclassofthosemetricswhicharedou-bling;seeSection1.3.1.1ResultsandtechniquesWeareconcernedwiththebroadrolesof‚Äúvolume‚Äùand‚Äústructure‚Äùindeterminingtheembeddabilityofamet-ric.Forinstance,inSection2,weshowthateverydou-blingtreemetricadmitsaconstantdistortionembeddinginto`O(1)p(i.e.,constantdimensional`pspace)foranyp‚àà[1,‚àû].Thisexhibitsaverynaturalclassofmet-ricspaceswhichembedinto`2withO(1)distortion,butnotisometrically.Asdiscussedbefore,sometreemet-ricsrequire‚Ñ¶(‚àöloglogn)distortiontoembedinto`2[5],whileweprovethatsomedoublingmetricsrequiredistor-tion‚Ñ¶(‚àölogn)(seeSection5).Thusitispreciselythesynthesisofthesetwopropertiesthatyieldsanenormousimprovementinembeddability.ThatthesemetricscanbeembeddedusingonlyO(1)dimensionsisperhapsevenmoresurprising(seethedis-cussioninSection2),andaswewillsoonsee,provesaspecialcaseofaconjectureofAssouad.Ourembeddingmakesuseofanovelpartitioningalgorithmfordoublingtrees.Thepartitionisdescribedconvenientlybyacoloringoftheedges.Ouralgorithmeitherfindsagoodcoloringorasubmetricwhichisacounterexampletothedoublingas-sumption.ToachieveanembeddingintoO(1)dimensions,wemustreusecolors.Wedothisbydefininganotionofad-jacencybetweenpaths,andarguingthattheresultinggraph(whoseverticesarepaths)hasboundedchromaticnumber.InSection3,weconstructlow-diameterdecompositionsforgeneralmetricswhoseparametersdependsmoothlyonthedoublingdimension.Suchdecompositionsarethemaintoolinmanyembeddingresults,aswellasanumberofotherapplications.Toconstructthesedecompositions,weadaptaprobabilistictechniqueof[7].Forapplicationsofthedecompositionlaterinthepaper,itisimportantthattheprobabilityspacethatwesamplefrombeverycompactlydefined(e.g.,ofsizeO(1)forthecaseofdoublingmetrics).Forthispurpose,weusesomeideasfrom[18],inconjunc-tionwithLovaÃÅszLocalLemma,inordertoexploitcertainlocalitypropertiesofourdecomposition.Ouruseofthelo-callemmahere,andelsewhereinthepaper,canbemadealgorithmicusingstandardtechniques.InSection4,wedeviseanumberofembeddings,somewhichrelyheavilyontheclusteringofSection3.First,wegiveaBourgain-styleembeddingwhichshowsthatev-erygeneraldoublingmetric(X,d)embedsinto`pwithdis-tortionO((logn)min(12,1p))foranyp‚àà[1,‚àû).Insteadofformingcoordinatesbytakingthedistancetoarbitrarysub-setsofX,weinsteaduseonlysubsetsofappropriatelysizednetsinX(seeSection1.2forthedefinitionofanet).Usingthisembedding,alongwithanotherapplicationofthelocallemma,weshowthateverydoublingmetriccanbeembed-dedwith1+distortioninto`O(logn)‚àû.SeeSection6foranapplicationtodistancelabelingschemes.Unfortunately,althoughfairlysimple,thedistortionofthisBourgain-styleembeddingdegradesbadly(exponen-tially)withdim(X).BasedontheclusteringofSection3,andanembeddingtechniqueofRao[32],weshowthateveryn-pointmetric(X,d)embedsinto`pwithdistortionatmostOdim(X)¬∑(logn)min(12,1p).Thisprovidesasmoothupperboundonthedistortionofgeneralmetricsintermsoftheirdimension.InthecaseofEuclideanembeddings,forinstance,itbeatsBourgain‚Äôsgeneralupperboundaslongasdim(X)=o(‚àölogn).In[2],itisprovedthatif(X,d)isadoublingmetric,thenforany0<Œ±<1,(X,dŒ±)embedsinto`k2withdistortionD,wherekandDdependonlyonthedoublingdimensionofX.Here,(X,dŒ±)isthemetricwithalldistancesraisedtothepowerŒ±(thisiscalledasnowflakedversionofX).Unfortunately,thedependenceofkandDondim(X)isexponential.InSection4,usingaslighttwistontheaboveembeddingtechnique,wegiveanalgorithmicversionofAssouad‚Äôsproof,anddrasticallyimprovethedependenceofkandDtonear-linearAssouadalsoconjecturedthattheaboveresultholdsevenwhenŒ±=1.AlthoughSemmes[33]disprovedthisconjecture,wehaveshownthatitholdswhenever(X,d)isadoublingtreemetric.InSection5,weexhibitafamilyofseries-paralleldou-blingmetricswhichrequires‚Ñ¶(‚àölogn)distortiontoem-bedinto`2,whichshowsthattheupperboundofSection4istight.Thisfamilyisbasedontheconstructionofafrac-talduetoLaakso[20].(Itwasbroughttoourattentionthatasimilaranalysiswasobtainedindependentlyin[21],butwithoutanexplicitdependenceonn.Inaddition,theprooftechniquesaresubtlydifferent.)Finally,inSection6,wementionsomealgorithmicap-plicationsofourresults,andpointoutaveryintriguingopenquestionregardingtherolesofvolumeandstructureindi-mensionalityreductioninEuclideanspaces.1.2PreliminariesHeretailsonmetricspaces.Let(X,dX)and(Y,dY)betwomet-ricspaces,1andconsideraninjectivemapf:X‚ÜíY.Wedefinecontraction(f)=supa,b‚ààXdX(a,b)dY(f(a),f(b)),expansion(f)=supa,b‚ààXdY(f(a),f(b))dX(a,b).Thedistortionoffisdefinedbydist(f)=expansion(f)¬∑contraction(f)=||f||Lip¬∑||f‚àí1||Lip.ThedistortionwithwhichXembedsintoYistheinfimumofdist(f)overallinjectivemapsf:X‚ÜíY.Asusual,wedefinecp(X)astheleastdistortionwithwhichXembedsintosome`pspace.LetG=(V,E)beasimpleundirectedgraphwithnon-negativeedgelengths.TheedgelengthsonGinduceanaturalmetricdG(u,v)givenbythelengthofashortestpathbetweenuandvinG.Ifwehavetwomapsf1:X‚ÜíY1andf2:X‚ÜíY2,wedefinetheirdirectisthesmallestvalueŒ≤suchthat|B(v,r)|‚â§Œ≤rforallv‚ààV,r>0.ItiseasytoseethatsinceGisunweightedandconnected,|B(v,r)|‚â•r,hence|B(v,2r)|‚â§2Œ≤r‚â§2Œ≤|B(v,r)|,whichimpliesthatdim(G)‚â§4dimKR(G)‚â§4(logŒ≤(G)+1).2TreesInthissectionweproveAssouad‚Äôsconjecturefortrees,showingthateverydoublingtreecanbeembeddedwithconstantdistortionintoconstantdimensional`pspaceforeveryp‚àà[1,‚àû],wherebothconstantsdependonlyonthedoublingconstantofthetree.Notmanyfamiliesofmetricsareknowntohavesuchpowerfulembeddings,anditmaybesurprisingthattwoseeminglyorthogonalconstraintsareneededforsucharesult.However,asmentionedinthein-troduction,aconstantdistortionEuclideanembeddingcan-notbeachievedifeitheroftheconstraintsisdropped.Fur-thermore,thetreerequirementcannotberelaxedeithertopologically(i.e.,tographsexcludingafixedminor)orgraph-theoretically(i.e.,toboundedtreewidthgraphs),asevenseries-parallelgraphsmightrequire‚Ñ¶(‚àölogn)distor-tioninanyEuclideanembedding(seeSection5).Thefactthattheseresultscanbeextendedtoconstantdimensionisevenmoresurprising,especiallysincerecentresultsofBrinkmanandCharikar[6](seealsoclaimœáisproper.Indeed,thealgorithmmaintainsthein-variantthatthecolorededgesformaconnectedsubtreeofTcontainingtheroot.Itfollowsthattheedgescoloredinanysingleexecutionofstep4formamonotonepath.Sinceweuseanewcoloreachtimearound,theclaimfollows.NowassumethatœáisnotŒ±-good.Thenthereexistver-ticesu,vwithuanancestorofvandD=d(u,v)=|Puv|withthefollowingproperty:ifu=w0,w1,...,w`=varethecolor-transitionverticesonPuv,i.e.,thesubpathPwjwj+1isamaximalmonochromaticsegmentforeachj,thend(wbelowshowsthatthealgorithmcanbeimplementedwiththesefewcolors,andLemma2.8provesthatthecoloringthealgorithmproducesisŒ±/4-reasonable.Wewillmakeuseofthefollowingproposition.Proposition2.6.Alonganyroot-leafpath,theedgesthatarecolorediniterationihavetotallengthatmost2ri.Inparticular,`(p)‚â§2riforeverypathp‚ààPi.ProofofProposition2.6.Wecanassumei>1;theclaimistrivialfori=1since2r1>diam(T).Foraleafv,letSi,vbethesubsetofedgesalongPvthatareactuallycolorediniterationi.Considertheedge(x,y)ofSi,vfarthestfromtheroot,withy‚ààYi\Yi‚àí1.Sincey6‚ààYi‚àí1,thereexistsy0‚ààYi‚àí1withd(y,y0)‚â§ri‚àí1=2ri,andfurthermore,Si,v‚äÜPy\Py0.ItfollowsthatSi,viscontainedinthepathbetweenyandlca(y,y0),andthusitslengthisatmostd(y,lca(y,y0))‚â§d(y,y0)‚â§2ri.Lemma2.7.Step9ofalgorithmBounded-D&Dcanbedonegreedilywith|C|=Œª3log(68/Œ±).ProofofLemma2.7.Theproofideaisverysimple:Foreachpathp‚ààPi,itsufficestoshowthatthenumberofpathsthatareadjacenttopandwerepermanentlycoloredbeforepislessthan|C|‚àí1,andhencewecancolorpgreed-ily.Wewill,infact,showsomethingslightlystronger:Weshowthatthenumberofpathsp0‚ààP‚àóiwithp‚Üîp0isatmost|C|‚àí1.Letz‚ààpbeAlgorithmBOUNDED-D&D:(Initiallyalltheedgesareuncolored.)1.setk=dlog2diam(T)eandY0=‚àÖ.2.fori=1,...,kdo3.setri=2k‚àíiandletYi‚äáYi‚àí1beri-netofT.4.foreverypointy‚ààYi\Yi‚àí1(inanarbitraryorder)do5.temporarilycoloralltheuncolorededgesinPywithasinglenewcolor.6.letPibethesetoftemporarilycoloredpaths.7.letP‚àói=Pi‚à™{allpathscoloredwithacolorfromC}.8.remarkpathsp1,p2‚ààP‚àóiareadjacent,writtenp1‚Üîp2,ifd(p1,p2)‚â§16Œ±ri.9.recolorthe(temporarilycolored)pathsinPiwithcolorsfromCsuchthatœá(p1)6=œá(p2)forallp1,p2‚ààP‚àóiwithp1‚Üîp2.Figure2.3.Frugaledge-coloringofthetreeT2.Padding:Pr¬µ[œÄP(x)‚â•Œµr]‚â•12forallx‚ààX.Suchdecompositionshavebeengivenearlierforgeneralmetrics,where1/Œµ=O(log|X|).Weshowthatsuchde-compositionsexistwhereŒµdependsonlyonthedoublingdimensionofX.Theprobabilistictechniqueweuseisin-spiredbytheanalysisof[7].Theorem3.2.Let(X,d)beafinitemetricspace.Thenforeveryr>0thereexistsan(r,Œµ)-paddedprobabilisticdecompositionofXwith1/Œµ‚â§64dim(X).Proof.Foreaseofnotation,weconstructa(4r,Œµ)-paddeddecomposition.LetNbeanr-netofX.LetœÉbearan-dompermutationonN,andchoosearadiusRuniformlyatrandomfrom(r,2r].Foreachy‚ààN,defineaclusterCy=x‚ààX:x‚ààB(y,R)andœÉ(y)<œÉ(z)forallz‚ààNwithx‚ààB(z,R).Clearly,diam(Cy)‚â§4r.Finally,letP={Cy}y‚ààNandnoteitisapartitionofXbecauseNisanr-netandR‚â•r.Nowfixapointx‚ààXandsomet‚àà[0,r].LetW=B(x,2r+t)‚à©N,andnotethatm=|W|‚â§8dim(T)byProposition1.1.Arrangethepointsw1,...,wm‚ààWinorderofincreasingdistancefromx,andletIkbetheinter-val[d(x,wk)‚àít,d(x,wk)+t].LetussaythatB(x,t)iscutbyaclusterCwkifCwk‚à©B(x,t)6=‚àÖbutB(x,t)*Cwk.Finally,writeEkfortheeventthatwkistheminimalele-mentinW(accordingtoœÉ)forwhichCwk‚à©B(x,t)6=‚àÖandCwkcutsB(x,t).Then,Pr[B(x,t)iscut]‚â§mXk=1Pr[Ek]=mXk=1Pr[R‚ààIk]¬∑Pr[Ek|R‚ààIk]‚â§mXk=12tr¬∑1k‚â§2tr(1+lnm),andthelatterquantityisatmost8trdim(X).Finally,notethatwhenB(x,t)isnotcut,wehaveœÄP(x)‚â•t.Settingt=4r64dimC(X),weseethatPr[œÄP(x)‚â•t]‚â•12asdesired.3.2LocalityanddimensionDecompositionslikethatgivenbyTheorem3.2haveseennumerousapplicationsinrecentyears.Often,onewantsasmalldistribution,i.e.amulti-setofmpartitionsD=[P1,...,Pm]suchthattheuniformdistributiononDsatis-fiescondition(2)ofDefinition3.1.Usually,thisisaccomplishedbychoosingm=Œò(logn)independentpartitionsaccordingto¬µ;aChernoffboundthenyieldsthedesiredresult.Here,weshowthatm=O(dim(X)logdim(X))partitionssuffice.TheideaistousetheLovaÃÅszLocalLemmaalongwithsomeideasbor-rowedfrom[18]toexploitthelocalityofthepaddedde-composition.Theorem3.3.Forametricspace(X,d),let1/Œµ=512dim(X).Thenforanyr‚â•0,thereexistsamulti-setD=[P1,...,Pm]ofm=O(dim(X)logdim(X))parti-tionssuchthat1.ForeveryC‚ààSmi=1Pi,diam(C)‚â§r.2.If¬µistheuniformdistributiononDthenforallx‚ààX,Pr¬µ[œÄP(x)‚â•Œµr]‚â•12.ProofofTheorem3.3.Letr>0befixedandlet¬µbeasinTheorem3.2(notethat¬µdependsonr).LetP1,...,PmbepartitionsofXchosenaccordingto¬µ(forsomemtobechosenlater).Forx‚ààX,letYxbethenumberofPiforwhichœÄPi(x)‚â§2Œµr.Theprobabilityofthelattereventisatmost18accordingClaim3.4.IfNisanŒµr-netinXthenPrhVy‚ààNEmyi>0.NoticethattheaboveclaimsufficestoprovetheTheo-rem.Indeed,ifœÄP(y)‚â•2Œµrforeveryy‚ààN,thenbythetriangleinequality,œÄP(x)‚â•Œµrforeveryx‚ààX.Inprovingtheclaim,wewillrequirethefollowingsym-metricformoftheLovaÃÅszLocalLemma(see,e.g.,[1]).Lemma3.5(LovaÃÅszLocalLemma).LetA1,...,Anbeeventsinanarbitraryprobabilityspace.SupposethateachAiismutuallyindependentofallbutatmostdothereventsAj,andsupposethatPr[Ai]‚â§pforall1‚â§i‚â§n.Ifep(d+1)‚â§1thenPr[‚àßni=1Ai]>0.WenowclaimthatEmyismutuallyindependentofalleventsEmy0forwhichd(y,y0)>4r.Toseethis,notethateveryclusterformedunder¬µ(accordingtoTheorem3.2)hasdiameteratmostr,thusnosuchclustercansimultane-ouslycutB(y,r)andB(y0,r);theclaimedindependencefollows.Itfollowsthatwecanupperboundthenumberofeventsthatarenon-mutuallyindependentofEmybyd=|B(y,4r)‚à©N|‚â§dim(X)O(dim(X))(byProposition1.1).NowifPr[Emy]‚â§1e(d+1),thenthelocallemmaimpliesClaim3.4.Butthisiseasilyaccomplishedbychoosingsomem=O(dim(X)logdim(X)).4Upperboundsfordoublingmetrics4.1Bourgain-styleembeddingsvianetsHere,wegiveasimpleproofthatdoublingmetricsem-bedintoEuclideanspacewithO(‚àölogn)distortion.ThisisbasedonBourgain‚Äôsproofforgeneralmetrics,withtheaddedtwistthatwetakedistancesfromsubsetsofnets,ratherthansubsetsoftheentiremetric.Afullproofisde-ferredtothefullversion.Theorem4.1.Foranyn-pointdoublingmetric(X,d),thedistortionrequiredtoembedXinto`2isc2(X)=O(‚àölogn).Proof(sketch).Theideaoftheembeddingisasfollows.Foreveryscale2k,k‚ààZ,weconstructamapœïk:X‚Üí`2givenbyœïk(x)=p1/2|Yk|(d(x,A))A‚ààYk,whereYkisthesetofallsubsetsofsome2k-netinX.Thefinalmapisbasicallythenormalizeddirectsumofallsuchmaps,i.e.‚äïk2‚àí12|Yk|œïk,thoughstandardconsiderationsmustbemadetoachieveadistortionwhichdependsonlyonnandnottheaspectratioofX.Itturnsoutthatthedependenceofthedistortionondim(X)intheabovetheoremisexponential,anditsworst-caseperformanceismuchworsethanBourgain‚ÄôsO(logn)bound.Wewillremedythisinthenextsection,usingthedecompositiontheoremsofSection3.Byadaptingtheanalysisoftheaboveproofwecanprovethefollowingtheorem.InordertoreducethedimensiontoO(logn),weboundthedistortionamongpointsincertainnetsusingtheLovaÃÅszLocalLemma,anddeducefromthataboundonthedistortionamongallpoints.The1+dis-tortionisachievedbysuitablymodifyingvariousconstantsintheproof.Theorem4.2.Foranyfixed>0,everydoublingmetric(1+)-embedsinto`O(logn)‚àû.4.2EmbeddingsviaclusteringInthissection,weobtainembeddingsthatdegradegrace-fullywiththedoublingdimension;thesearebasedonthedecompositiontheoremsofSection3.ThenexttheoremusesanembeddingtechniqueduetoRao[32].Ouranalysisrequiresconsiderablymoreeffortsincewemustkeeptightcontrolonthedimensionofourembedding(thisimprovesthedimensionofthehostspacebyafactorof‚Ñ¶(logn),say,fordoublingmetrics,andisessentialforSection4.2.1).Theorem4.3.Foranymetric(X,d)andanyp‚àà[1,‚àû),cp(X)=Odim(X)¬∑(logn)min(12,1p).Proof(outline).Let(X,d)beanarbitrarymetricandfixavaluer‚â•0.Wediscussthecasep=2;theproofforothervaluesofpissimilar.WeproduceamapŒ¶r:X‚ÜíRkwithk=O(dim(X)logdim(X))asfollows.LetP1,...,Pmbethemulti-setofdecompositionsguaranteedbyTheorem3.3.Fixsomei‚àà{1,...,m},andforeveryclusterC‚ààPi,chooseavaluesgn(C)‚àà{‚àí1,+1}uniformlyatrandom.FollowingRao[32](seealso[28,Ch.15]),definethemapœïi:X‚ÜíRbyœïi(x)=XC‚ààPisgn(C)¬∑d(x,X\C).Finally,setŒ¶r=1‚àömœï1‚äï¬∑¬∑¬∑‚äïœïm.LetŒµbeasinTheorem3.3,letNrbeanŒµr64-net,andsetSr={{x,y}‚ààN2r:d(x,y)>r}.For{x,y}‚ààSr,letEx,ybetheeventthat||Œ¶r(x)‚àíŒ¶r(y)||<18Œµr.Thefollowinglemmaisdeferredtothefullversion.Lemma4.4.PrhV{x,y}‚ààSrEx,yi>0.Inotherwords,thereexistsamapŒ¶rsuchthatforall{x,y}‚ààSr,||Œ¶r(x)‚àíŒ¶r(y)||‚â•184.2.1Assouad‚ÄôsTheoremRecallthatfor0<Œ±‚â§1,(X,dŒ±)isthemetricthatarisesfromametric(X,d)byraisingalldistancestothepowerŒ±.Inhisseminalpaper[2],Assouadprovedthefollowing(per-hapssurprising)result:Foranydoublingmetric,andeveryfixed0<Œ±<1,thereexistconstantskandD(depend-ingonlyonthedoublingconstantofX)suchthat(X,dŒ±)embedsinto`k2withdistortionatmostD.AlthoughAssouad‚Äôsproofiseasilyconvertedtoanal-gorithm,theparameterskandDgrowexponentiallywithdim(X).WepresentanalgorithmicversionbasedontheformationofcoordinatesinSection4.2andatrickofAs-souad[2]toavoidinteractionbetweenscales.ThevalueskandDthatweachievearebothnearlylinearindim(X).Theorem4.5.Let(X,d)beanarbitrarymetric,andfixavalue0<Œ±<1.Thenthereexistvaluesk=O(dim(X)logdim(X))andD=anO(dim(T))-approximationforthe0-extensionproblemwhere(T,d)isthemetriconterminals.Dimensionalityreduction.Inprevioussections,westud-iedthedistortionofgeneralmetricsintermsoftheirdou-blingdimension.Here,letusconsiderann-pointsetX‚äÜ`n2withdim(X)=O(1).TheJohnson-Lindenstraussflat-teninglemma[15]tellsusthatthereisa1+embeddingofXinto`O(‚àí2logn2).Weposethefollowingintriguingquestionwhichwasaskedindependentlyin[21].Question1.Caneverydoublingsubmetricof`2beO(1)-embeddedinto`O(1)2?Itcanbeshownthatnolinearprojectioncanachievesucharesult(asin[15]),butthereareanumberreasonstobelievethatitsresolutionmightbepositive;thesearedis-cussedinthefullversion.Acknowledgments.WethankYairBartal,ManorMendel,AssafNaor,andOdedSchrammforsomeenlighteningdiscussions,andStephenSemmesforusefulpointerstotheliterature.References[1]N.AlonandJ.H.Spencer.Theprobabilisticmethod.Wiley-Interscience,NewYork,secondedition,2000.[2]P.Assouad.PlongementslipschitziensdansRn.Bull.Soc.Math.France,111(4):429‚Äì448,1983.[3]Y.AumannandY.Rabani.AnO(logk)approximatemin-cutmax-flowtheoremandapproximationalgorithm.SIAMJ.Comput.,27(1):291‚Äì301,1998.[4]J.Bourgain.OnLipschitzembeddingoffinitemetricspacesinHilbertspace.IsraelJ.Math.,52(1-2):46‚Äì52,1985.[5]J.Bourgain.ThemetricalinterpretationofsuperreflexivityinBanachspaces.IsraelJ.Math.,56(2):222‚Äì230,1986.[6]B.BrinkmanandM.Charikar.Ontheimpossibilityofdimensionre-duction