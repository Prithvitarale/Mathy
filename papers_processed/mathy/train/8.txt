SelectingtheindependentcoordinatesofmanifoldswithlargeaspectratiosYu-ChiaChenDepartmentofElectrical&ComputerEngineeringUniversityofWashingtonSeattle,WA98195yuchaz@uw.eduMarinaMeilăDepartmentofStatisticsUniversityofWashingtonSeattle,WA98195mmp2@uw.eduAbstractManymanifoldexamplesofsuccessfulselectiononrealandsyntheticdata.TheexperimentsalsodemonstratethatusersofmanifoldlearningforotherthantoydatamustbeawareoftheIESproblemandhavetoolsforhandlingit.Notationstable,proofs,aitsSingularValueDecompositionΣ(i),U(i)∈Rm×d.ThelatterrepresentsanorthogonalbasisofTφ(x)(φ(M)).Algorithm1:RMETRICInput:EmbeddingY∈Rn×m,LaplacianL,intrinsicdimensiond1forallareneeded.I.e.,thereexistsasetS⊂[m],sothatφSisalsoasmoothembedding.Wefollow[DTCK18]incallingsuchasetSindependent.ItisnotknownhowtofindanindependentSanalyticallyforagivenM,exceptinspecialcasessuchasthestrip.Inthispaper,weproposeafinitesampleandalgorithmicsolution,andwesupportitwithasymptotictheoreticalanalysis.TheIESProblemWearegivendataX,andtheoutputofanembeddingalgorithmnal.Hence,Volnorm(S,i)awayfrom0indicatesanon-singularφSati,andweusetheaveragelogVolnorm(S,i),whichpenalizesvaluesnear0highly,astherankqualityR(S)ofS.HigherfrequencyφSmapswithhighR(S)mayexist,beingeithersmooth,suchastheembeddingsofthestripmentionedpreviously,orcontainingknotsinvolvingonlysmallfractionofpoints,suchasφφ1,0,φ1,1inFigure1a.Tochoosethelowestfrequency,slowestvaryingsmoothmap,aregular-izationtermconsistingoftheeigenvaluesλk,k∈S,ofthegraphLaplacianLisadded,obtainingthecriterionL(S;ζ)=1nnXi=1logqdet(US(i)>US(i))|{z}R1(S)=1nPni=1R1(S;i)−1nnXi=1dXk=1logkuSk(i)k2|{z}R2(S)=1nPni=1R2(S;i)−ζXk∈Sλk(2)4.2SearchalgorithmAlgorithm2:INDEIGENSEARCHInput:DataX,bandwithε,intrinsicdimensiond,embeddingdimensions,regularizerζ1Y∈Rn×m,L,λ∈Rm←DIFFMAP(X,ε)2U(i),···,U(n)←RMETRIC(Y,L,d)3forS∈{S0⊆[m]:|S0|=s,1∈S0}do4R1(S)←0;R2(S)←05fori=1,···,ndo6US(i)←U(i)[S,:]7R1(S)+=12n·logdetUS(i)>US(i)8R2(S)+=1n·Pdk=1logkuSk(i)k29end10L(S;ζ)=R1(S)−R2(S)−ζPk∈Sλk11end12S∗=argmaxSL(S;ζ)Return:IndependenteigencoordinatessetS∗Withthiscriterion,theIESproblemturnsintoasubsetselectionproblemparametrizedbyζS∗(ζ)=argmaxS⊆[m];|S|=s;1∈SL(S;ζ)(3)Notethatweforcethefirstcoordinateφ1toalwaysbechosen,sincethiscoordinatecannotbefunctionallydependentonpre-viousones,and,inthecaseofDM,italsohaslowestfrequency.NotealsothatR1andR2arebothsubmodularsetfunction(proofinSupplementC.1).Forlargesandd,algorithmsforoptimizingoverthedifferenceofsubmodularfunctionscanbeused(e.g.,see[IB12]).Fortheexperi-mentsinthispaper,wehavem=20andd,s=2∼4,whichenablesustouseex-haustivesearchtohandle(3).TheexactsearchalgorithmissummarizedinAlgo-rithm2INDEIGENSEARCH.AgreedyvariantisalsoproposedandanalyzedinSupplementD.4.3RegularizationpathandchoosingζAccordingto(2),theoptimalsubsetS∗dependsontheparameterζ.Theregularizationpath`(ζ)=maxS⊆[m];|S|=s;1∈SL(S;ζ)istheupperenvelopeofmultiplelines(eachcorrespondtoasetS)withslopes−Pk∈SλkandinterceptsR(S).Thelargerζis,themorethelowerfrequencysubsetpenaltyprevails,andforsufficientlylargeζthealgorithmwilloutput[s].Inthesupervisedlearningframework,theregularizationparametersareoftenchosenbycrossvalidation.Hereweproposeasecondcriterion,thateffectivelylimitshowmuchR(S)maybeignored,oralternatively,boundsζbyadatadependentquantity.Definetheleave-one-outregretofpointiasfollowsD(S,i)=R(Si∗;[n]\{i})−R(S;[n]\{i})withSi∗=argmaxS⊆[m];|S|=s;1∈SR(S;i)(4)Intheabove,wedenoteR(S;T)=1|T|Pi∈TR1(S;i)−R2(S;i)forsomesubsetT⊆[n].ThequantityD(S,i)in(4)measuresthegaininRifalltheotherpoints[n]\{i}choosetheoptimalsubsetSi∗.IftheregretD(S,i)islargerthanzero,itindicatesthatthealternativechoicemightbebettercomparedtooriginalchoiceS.Notethatthemeanvalueforalli,i.e.,1nPiD(S,i)dependsalsoonthevariabilityoftheoptimalchoiceofpointsi,Si∗.Therefore,itmightnotfa-voranS,ifSisoptimalforeveryi∈[n].Instead,weproposeAlgorithm3:REGUPARAMSEARCHInput:Thresholdparameterα1forζ=ζmax→0do.ζmaxshouldbesufficientlylargesuchthatS∗(ζmax)=[s]2S←S∗(ζ);S∗←NULL;ζ00←NULL3fori∈[n]do4D(S,i)←R(Si∗;[n]\{i})−R(S;[n]\{i})fromequation(4)5end6ifPERCENTILE({D(S,i)}ni=1,α)≤0ofthesubsetsandinspectingthehistogramofunpenalizedVolnormonthecombinedsetagain.IfspikesinsmallVolnormregiondiminished,onecanconcludethatalargercardinalitysize|S|isneededforsuchmanifold.WeillustratetheideaonswissrollwithholedatasetinFigure2a.Figure2bistheoptimalsubsetofcoordinatesS∗={1,8}selectedbytheproposedalgorithmthatbestparameterizetheunderlyingmanifold.Figure2dsuggestsoneshouldeliminateS0={1,2}becauseD(S0,i)≥0forallthepointsbyREGUPARAMSEARCH.However,asshowninFigure2b,thoughithaslowfrequencyandhavingrank2formostoftheplaces,set{1,8}mightnotbesuitablefordataanalysisfortheverythinarmsinleftsideoftheembedding.Figure2eisthehistogramsofthepoint-wiseunpenalizedVolnormondifferentsubsets.PurpleandyellowcurvescorrespondtothehistogramoftoptworankedsubsetsSfromINDEIGENSEARCH.BothcurvesshowaconcentrationofmassesinsmallVolnormregion.Thehistogramofpoint-wiseunpenalizedVolnormon{1,8,10}(redcurve),whichistheunionoftheaforementionedtwosubsets,showslessconcentrationinthesmallVolnormregionandimpliesthat|S|=3mightbeabetterchoicefordataanalysis.Figure2fshowstheembeddingwithcoordinateS={1,8,10},whichrepresentsatwodimensionalstripembeddedinthreedimensionalspace.ThethinarcinFigure2bturnsouttobeacollapsedtwodimensionalmanifoldviaprojection,asshownintheupperrightpartofFigure2fandleftpartofFigure2c.HerewehavetorestatethattheembeddinginFigure2b,althoughisadegeneratedembedding,isstillthebestsetonecanchoosefors=2suchthattheembeddingvariesslowestandhasrank2.However,choosings=3mightbebetterfordataanalysis.6RasKullbach-LeiblerdivergenceInthissectionweanalyzeRinitspopulationversion,andshowthatitisreminiscentofaKullbach-LeiblerdivergencebetweenunnormalizedmeasuresonφS(M).Thepopulationversionofthereg-ularizationtermtakestheformofawell-knownsmoothnesspenaltyontheembeddingcoordinatesφS.VolumeelementandtheRiemannianmetricConsideraRiemannianmanifold(M,g)mappedbyasmoothembeddingφSinto(φS(M),g∗φS),φS:M→Rs,whereg∗φSisthepush-forwardmetricdefinedin(1).ARiemannianmetricginducesaRiemannianmeasureonM,withvolumeelement√detg.DenotenowbyµM,respectivelyµφS(M)theRiemannianmeasurescorrespondingtothemetricsinducedonM,φS(M)bytheambientspacesRD,Rs;letgbetheformermetric.Lemma2.LetS,φ,φS,HS(x),US(x),Σ(x)bedefinedasinSection4andLemma1.Forsim-plicity,wedenotebyHS(y)≡HS(φ−1S(y)),andsimilarlyforUS(y),Σ(y).AssumethatφSisasmoothembedding.Then,foranymeasurablefunctionf:M→R,ZMf(x)dµM(x)=ZφS(M)f(φ−1S(y))jS(y)dµφS(M)(y),(5)withjS(y)=1/Vol(US(y)Σ1/2S(y)).(6)Proof.Letµ∗φS(M)denotetheRiemannianmeasureinducedbyg∗φS.Since(M,g)and(φS(M),g∗φS)areisometricbydefinition,RMf(x)dµM(x)=RφS(M)f(φ−1S(y))dµ∗φS(M)(y)=RφS(M)f(φ−1S(y))pdetg∗φS(y)dµφS(M)(y)followsfromthechangeofvariableformula.Itre-mainstofindtheexpressionofjS(y)=pdetg∗φS(y).ThematrixUS(y)(notethatUS(y)isnotorthogonal)canbewrittenasUS(y)=VQS(y)(7)whereV∈Rs×disanorthogonalmatrixandQS(y)∈Rd×disuppertriangular.Then,HS(y)=US(y)Σ(y)US(y)>=VS(y)(QS(y)Σ(y)QS(y)>)|{z}H̃S(y)VS(y)>IntheaboveH̃S(y)istheco-metricexpressedinthenewcoordinatesysteminducedbyVS(y).Hence,inthesamebasis,g∗φSisexpressedbyG̃S(y)=H̃S(y)−1=(QS(y)Σ(y)QS(y)>)−1.(9)Thevolumeelement,whichisinvarianttothechosencoordinatesystem,isdetQS(y)Σ(y)QS(y)>−1/2=dYk=1σk(y)−1/2qS,kk(y)−1.(10)From(7),itfollowsalsothatdetQS(y)Σ(y)QS(y)>−1/2=1/VolUS(y)Σ(y)1/2(11)AsymptoticlimitofRWenowstudythefirsttermofourcriterioninthelimitofinfinitesamplesize.WeOriginaldataXEmbeddingφS∗RegularizationpathD110−2100102104ζ{1,2}{1,7}−202D(S,i)D710−1010−710−410−1102ζ{1,2,3}{1,2,4}{1,4,5}−101D(S,i)D1310−210−1100101102ζ{1,2,3,4}{1,2,3,5}{1,2,5,10}{1,5,6,10}−2024D(S,i)Figure3:Experimentalresultforsyntheticdatasets.Rowscorrespondtodifferentsyntheticdatasets(pleaserefertoTableS2).OptimalsubsetS∗isselectedbyINDEIGENSEARCH.NotethatD(·k·)isaKullbach-Leiblerdivergence,wherethe(a)Embeddingφ[3](b)L({1,i,j})(c)φS1=φ{1,4,6}(d)φS2=φ{1,5,7}(e)L({1,2})=−1.24(f)L({1,3})=−0.39(g)Subsetφ{1,2,5}byLLR(h)rkvs.φkFigure4:Firstrow:Choloromethanedataset;secondrow:SDSSdatasetin(e),(f)and(g),(h)showtheexamplewhenLLRfailed.(c)and(d)areembeddingswithtoptworankedsubsetsS1andS2,coloredbythedistancesbetweenCandtwodifferentCl–,respectively.(e)and(f)areembeddingsofφ{1,2}(suboptimalset)andφ{1,3}(maximizerofL),respectively(valuesshownincaption).SyntheticmanifoldsTheresultsofsyntheticmanifoldsareinFigure3.(i)Manifoldwiths=d.Thefirstsyntheticdatasetweconsidered,D1,isatwodimensionalstripwithaspectratioW/H=2π.Leftpanelofthetoprowshowsthescatterplotofsuchdataset.FromthetheoreticalanalysisinSection3,thecoordinatesetthatcorrespondstoslowestvaryinguniqueeigendirectionisS={1,dW/He}={1,7}.Middlepanel,withS∗={1,7}selectedbyINDEIGENSEARCHwithζcho-senbyREGUPARAMSEARCH,confirmsthis.Therightpanelshowstheboxplotof{D(S,i)}ni=1.Accordingtotheproposedprocedure,weeliminateS0={1,2}sinceD(S0,i)≥0foralmostallthepoints.(ii)Manifoldwiths>d.TheseconddataD7isdisplayedintheleftpanelofthesecondrow.Duetothemechanismweusedtogeneratethedata,theresultanttorusisnon-uniformlydis-tributedalongthezaxis.MiddlepanelistheembeddingoftheoptimalcoordinatesetS∗={1,4,5}selectedbyINDEIGENSEARCH.Notethatthemiddleregion(inred)isindeedatwodimensionalnarrowtubewhenzoomedin.Therightpanelindicatesthatboth{1,2,3}and{1,2,4}(medianisaroundzero)shouldberemoved.Theoptimalregularizationparameterisζ∗≈7.TheresultofthethirddatasetD13,threetorus,isinthethirdrowofthefigure.WedisplayedonlyprojectionsofthepenultimateandthelastcoordinateoforiginaldataXandembeddingφS∗(whichis{5,10})coloredbyα1of(S7)intheleftandmiddlepaneltoconservespace.Afullcombinationsofcoor-dinatescanbefoundinFigureS5.Therightpanelimpliesoneshouldeliminatetheset{1,2,3,4}and{1,2,3,5}sincebothofthemhavemorethan75%ofthepointssuchthatD(S,i)≥0.Thefirstremainingsubsetis{1,2,5,10},whichyieldsanoptimalregularizationparameterζ∗≈5.Moleculardynamicsdataset[FTP16]InSN2reactionmoleculardynamicsofchloromethane[FTP16]dataset,twochlorideatomssubstitutewitheachotherindifferentconfigurations/pointsxiasdescribedinthefollowingchemicalequationCH3Cl+Cl–←−→CH3Cl+Cl–.Thedatasetexhibitssomekindofclusteringstructurewithasparseconnectionbetweentwoclusterswhichrepresentsthetimewhenthesubstitutionhappened.Thedatasethassizen≈30,000andambientdimensionD=40,withtheintrinsicdimensionestimatebeˆd=2TheembeddingwithcoordinatesetS=[3]isshowninFigure4a.Thefirstthreeeigenvectorsparameterizethesamedirections,whichyieldsaonedimensionalmanifoldinthefigure.Topview(S=[2])ofthefigureisau-shapedstructuresimilartotheyellowcurveinFigure1a.TheheatmapofL({1,i,j})fordifferentcombinationsofcoordinatesinFigure4bconfirmsthatLforS=[3]islowandthatφ1,φ2andφ3givealowrankmapping.TheheatmapalsoshowshighLvaluesforS1={1,4,6}orS2={1,5,7},whichcorrespondtothetoptworankedsubsets.TheembeddingswithS1,S2areinFigures4cand4d,respectively.Inthiscase,weGalaxyspectrafromtheSloanDigitalSkysurvey(SDSS)2[AAMA+09],preprocessedasin[MMVZ16].Wedisplayasampleofn=50,000pointsfromthefirst0.3millionpointswhichcorrespondtoclosergalaxies.Figures4eandChrisFuforprovidingthemoleculardynamicsdataandformanyhoursofbrainstormingandadvice.References[AAMA+09]KevorkNAbazajian,JenniferKAdelman-McCarthy,MarcelAAgüeros,SaharSAllam,CarlosAllendePrieto,DeokkeunAn,KurtSJAnderson,ScottFAnderson,JamesAnnis,NetaABahcall,etal.Theseventhdatareleaseofthesloandigitalskysurvey.TheAstrophysicalJournalSupplementSeries,182(2):543,2009.[Bat14]JonathanBates.Theembeddingdimensionoflaplacianeigenfunctionmaps.AppliedandComputationalHarmonicAnalysis,37(3):516–530,2014.[BN07]MikhailBelkinandParthaNiyogi.Convergenceoflaplacianeigenmaps.InB.Schölkopf,J.C.Platt,andT.Hoffman,editors,AdvancesinNeuralInformationProcessingSystems19,pages129–136.MITPress,2007.[CL06]R.R.CoifmanandS.Lafon.Diffusionmaps.AppliedandComputationalHarmonicAnalysis,30(1):5–30,[MHM18]LelandMcInnes,JohnHealy,andJamesMelville.Umap:Uniformmanifoldapprox-imationandprojectionfordimensionreduction.arXivpreprintarXiv:1802.03426,2018.[MMVZ16]JamesMcQueen,MarinaMeilă,JacobVanderPlas,andZhongyueZhang.Mega-man:Scalablemanifoldlearninginpython.JournalSupplementtoSelectingtheindependentcoordinatesofmanifoldswithlargeaspectratiosANotationaltableTableS1:NotationaltableMatrixoperationMMatrixmiVectorrepresentsthei-throwofMmT:,jVectorrepresentsthej-thcolumnofMmijScalarrepresentsij-thelementofM[M]ijScalar,alternativenotationformijM[α,β]SubmatrixofMofindexsetsα,βvColumnvectorviScalarrepresentsi-thelementofvectorv[v]iScalar,alternativenotationforviScalarsnNumberofsamplesDAmbientdimensionmDimensionofdiffusionembeddings(Minimum)embeddingdimensiondIntrinsicdimensionVectors&MatricesXDatamatrixxiPointiinambientspaceYDiffusioncoordinatesyiPointiindiffusioncoordinatesφCExtratheoremsC.1SubmodularityoftheobjectivefunctionsTheoremS1.ForarankdtangentspacematrixU∈Rm×d,ifanysubmatrixUS,withindexsetS⊆[m]and|S|=s≥DGreedysearchAlgorithmS4:GREEDYINDEIGENSEARCHInput:Orthogonalbasis{U(i)}ni=1,eigenvaluesλ,intrinsicdimensiond,regularizationparameterζ1SolveS∗←argmaxS⊆[m];|S|=d;1∈SL(S;ζ).2fors=d+1→mdo3k∗=argmaxk∈[m]\S∗L(S∗∪{k};ζ)4S∗←S∗∪{k∗}.Recordorder5endReturn:IndependentcoordinatesS∗Inspiredbythegreedyversionofsubmodularmaximization[NWF78],agreedyheuristichasbeenproposed,asinAlgorithmS4.ThealgorithmstartsfromanobservationthattheoptimalvalueoftheS0=argmaxS;d≤|S|<sL(S;ζ)willoftentimebeasubsetoftheoptimalS∗of(3).SincetheappropriatecardinalityofthesetSisunknown,wecansimplyscanfrom|S|=dtom.Theorderofthereturnedelementsindicatesthesignificanceofthecorrespondingcoordinate.EComputationalcomplexityanalysisE.1TheproposedalgorithmsForcomputationcomplexityanalysis,weassume(a)(b)FigureS2:UMAPembeddingsof2Dlongstripewithdifferentinitializationsandchoicesofhyper-parameters.RowsfromtoptobottomcorrespondtoUMAPembeddinginitializedwithDMwhichcoordinateschosenbyINDEIGENSEARCH,naı̈veDMandrandominitialization,respectively.Columnsrepresentdifferentchoicesof(a)pointsseparationand(b)numberofneighbors.103104105Samplesizen100102104Time(s)ExactGreedyLLRFigureS1:RuntimesofdifferentIESalgorithmserrorM2betweengroundtruthdatasetandtheembeddingshownoneachsubplotsalsoconfirmourstatement.NotethatitispossibletounrollthealgorithmicartifactwithmoreepochsinthesamplingstepsofUMAP.(3to5timesmoreiterationsareneededinthisexample.)However,duetotheef-ficiencyofperformingINDEIGENSEARCH,itisbeneficialtoinitializewiththeembeddingselectedbyINDEIGENSEARCH.GAdditionalexperiments&detailsoftheuseddatasetsInthispaper,atotalof13differentsyntheticmanifoldsareconsidered.TableS2summarizedthesyntheticmanifoldsconstructedanditsabbreviations(fromD1toD13).EmbeddingresultsforthesyntheticmanifoldsareinFiguresS3,S4andS5.TherankingofthefirstfewcandidatesetsSfromINDEIGENSEARCH,GREEDYINDEIGENSEARCHandLLRCOORDSEARCHcanbefoundinTableS3.Thetableshowstheoptimalsubsetsreturnbythreedifferentalgorithmsareoftentimethesame,withexceptionforD7hightorusasdiscussedinSection7.TableS2:Abbreviationsfordifferentsyntheticmanifoldsinthispaper.Theabbreviationwithaster-iskrepresentssuchdatasetisdiscussedinmainmanuscript.Manifoldwiths=dD∗1Twodimensionalstrip(aspectratio2π)D22Dstripwithcavity(aspectratio2π)D3SwissrollD4SwissrollwithcavityD5GaussianmanifoldD6ThreedimensionalcubeManifoldwiths>dD∗7HightorusD8WidetorusD9z-asymmetrizedhightorusD10x-asymmetrizedhightorusD11z-asymmetrizedwidetorusD12x-asymmetrizedwidetorusD∗13Three-torusG.1Additionalexperimentsonsyntheticmanifoldswiths=dBelowsummarizedthedetailsofgeneratingthedatasets.TableS3:Resultsreturnedfromdifferentalgorithmsondifferentsyntheticdatasets.ExactsearchGreedyrankLLRrank12345D1[1,7][1,8][1,9][1,10][1,12][1,7,6,4,3,2,5][1,7,14,16,11,18,6]D2[1,4][1,8][1,9][1,10][1,12][1,4,8,6,5,3,2][1,4,8,5,17,11,14]D3[1,9][1,10][1,11][1,13][1,18][1,9,5,2,3,4,6][1,9,19,16,12,10,4]D4[1,8][1,10][1,11][1,14][1,15][1,8,3,2,4,10,5][1,8,11,10,19,16,4]D5[1,6][1,8][1,10][1,11][1,13][1,6,2,8,3,10,4][1,6,19,8,18,14,12]D6[1,2,8][1,2,11][1,4,8][1,2,17][1,2,13][1,2,8,3,4,6,5][1,2,8,10,3,13,6]D7[1,4,5][1,4,8][1,5,7][1,7,12][1,7,8][1,5,4,3,6,2,8][1,2,5,4,15,6,10]D8[1,2,7][1,4,7][1,3,7][1,2,9][1,5,7][1,7,2,4,3,13,5][1,2,7,13,12,15,14]D9[1,3,4][1,3,7][1,4,6][1,3,10][1,7,9][1,3,4,2,9,7,6][1,3,4,2,19,8,7]D10[1,2,4][1,3,4][1,4,5][1,6,9][1,6,14][1,4,2,3,5,6,8][1,4,2,3,8,5,6]D11[1,2,5][1,4,8][1,4,5][1,8,9][1,2,8][1,5,2,4,8,3,9][1,2,5,8,10,9,11]D12[1,2,5][1,4,5][1,2,7][1,3,5][1,2,8][1,5,2,3,4,6,8][1,5,2,6,10,9,1.D∗1:pointsfromthisdatasetaresampleduniformlyfromxi∼UNIF([−2,2]×[−4π,4π]).2.D2:pointsarefirstsampleduniformlyfrom[−2,2]×[−4π,4π].Pointsi(a)(b)10−410−2100102104ζ{1,2}{1,4}−202D(S,i)(c)(d)(e)10−1010−710−410−1102ζ{1,2}{1,3}{1,9}−202D(S,i)(f)(g)(h)10−1010−710−410−1102ζ{1,2}{1,6}−202D(S,i)(i)(j)(k)10−1010−710−410−1102ζ{1,2,3}{1,2,8}−4−202D(S,i)(l)FigureS3:Syntheticmanifoldswithminimumembeddingdimensionsequalsintrinsicdimensiond.Rowsfromtoptobottomrepresenttwodimensionalstripwithcavity(aspectratioW/H=2π),swissroll,gaussianmanifoldandthreedimensionalcubedataset,respectively.ColumnsfromlefttorightaretheoriginaldataX,embeddingφS∗withoptimalcoordinatesetsS∗chosenbyINDEIGENSEARCHandtheregularizationpath,respectively.FigureS6:M2andˆdvs.rankingofD13Theparameterizationofthethreetorusisx1=a1sinα1x2=(a2+a1cosα1)sinα2x3=(a3+(a2+a1cosαG.3VerificationofthechosensubsetsonsyntheticmanifoldsUnlike2Dstrip,thecloseformsolutionoftheoptimalsetisoftentimesunknowningeneral.Inthissection,weverifythecorrectnessofthechosensubsetbyreportingthefullprocrustesdistance(disparityscore)M2[Dry16],whichisdefinedtobethenormalizedsumofsquareofthepoint-wisedifferencebetweentheprocrustestransformedgroundtruthdataXtrue∈Rn×kandthetestdataXtest∈Rn×k.Namely,M2(a)(b)10−310−210−1100101102103ζ{1,2,3}{1,2,4}{1,2,7}−0.50.00.5D(S,i)(c)(d)(e)10−1010−710−410−1102ζ{1,2,3}{1,3,4}−10D(S,i)(f)(g)(h)10−1010−710−410−1102ζ{1,2,3}{1,2,4}−0.50.0D(S,i)(i)(j)(k)10−1010−710−410−1102ζ{1,2,3}{1,2,5}−0.50.00.5D(S,i)(l)(m)(n)10−1010−710−410−1102ζ{1,2,3}{1,2,5}−0.50.00.5D(S,i)(o)FigureS4:Syntheticmanifoldswithminimumembeddingdimensionsgreaterthanintrinsicdimen-siond.Rowsfromtoptobottomrepresentwidetorus,z-asymmetrizedhightorus,x-asymmetrizedhightorus,z-asymmetrizedwidetorusandx-asymmetrizedwidetorus,respectively.ColumnsfromlefttorightaretheoriginaldataX,embeddingφS∗withoptimalcoordinatesetsS∗(a)(b)FigureS5:Experimentonthree-torusdataset.(a)OriginaldataXofthreetorus.(b)EmbeddingφS∗withoptimalcoordinatesetsS∗chosenbyINDEIGENSEARCH.Rowsforboth(a)and(b)(a)D1(b)D2(c)D3(d)D4(e)D5(f)D6(g)D7(h)D8(i)D9(j)D10(k)D11(l)D12FigureS7:Verificationofthecorrectnessofthechosensetsinsynthetic