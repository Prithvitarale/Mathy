ClosingtheLearning-PlanningLoopwithPredictiveStateRepresentations(ExtendedAbstract)ByronBootsMachineLearningDepartmentCarnegieMellonUniversityPittsburgh,PA15213beb@cs.cmu.eduSajidM.Siddiqi∗RoboticsInstituteCarnegieMellonUniversityPittsburgh,PA15213siddiqi@google.comGeoffreyJ.GordonMachineLearningDepartmentCarnegieMellonUniversityPittsburgh,PA15213ggordon@cs.cmu.eduABSTRACTAcentralprobleminartificialintelligenceistoplantomaximizefuturerewardunderuncertaintyinapartiallyobservableenviron-ment.ModelsofsuchenvironmentsincludePartiallyObservableMarkovDecisionProcesses(POMDPs)[4]aswellastheirgeneral-izations,PredictiveStateRepresentations(PSRs)[9]andObserv-ableOperatorModels(OOMs)[7].POMDPsmodelthestateoftheworldasalatentvariable;incontrast,PSRsandOOMsrepre-sentstatebytrackingoccurrenceprobabilitiesofasetoffutureevents(calledtestsorcharacteristicevents)conditionedonpastevents(calledhistoriesorindicativeevents).Unfortunately,exactplanningalgorithmssuchasvalueiteration[14]areintractableformostrealisticPOMDPsduetothecurseofhistoryandthecurseofdimensionality[11].However,PSRsandOOMsholdthepromiseofmitigatingbothofthesecurses:first,manysuccessfulapprox-imateplanningtechniquesdesignedtoaddresstheseproblemsinPOMDPscaneasilybeadaptedtoPSRsandOOMs[8,6].Second,PSRsandOOMsareoftenmorecompactthantheircorrespondingPOMDPs(i.e.,needfewerstatedimensions),mitigatingthecurseofdimensionality.Finally,sincetestsandhistoriesareobservablequantities,ithasbeensuggestedthatPSRsandOOMsshouldbeeasiertolearnthanPOMDPs;withasuccessfullearningalgorithm,wecanlookforamodelwhichignoresallbutthemostimportantcomponentsofstate,reducingdimensionalitystillfurther.Inthispaperwetakeanimportantsteptowardrealizingtheabovehopes.Inparticular,weproposeanddemonstrateafastandstatis-ticallyconsistentspectralalgorithmwhichlearnstheparametersofaPSRdirectlyfromsequencesofaction-observationpairs.Wethenclosetheloopfromobservationstoactionsbyplanninginthelearnedmodelandrecoveringapolicywhichisnear-optimalintheoriginalenvironment.Closingtheloopisamuchmorestringenttestthansimplycheckingshort-termpredictionaccuracy,sincethequalityofanoptimizedpolicydependsstronglyontheaccuracyofthemodel:inaccuratemodelstypicallyleadtouselessplans.CategoriesandSubjectDescriptorsI.2.6[ComputingMethodologies]:ArtificialIntelligence∗nowatGooglePittsburghCiteas:ClosingtheLearning-PlanningLoopwithPredictiveStateRepre-sentations(ExtendedAbstract),ByronBoots,SajidM.SiddiqiandGeoffreyJ.Gordon,Proc.of9thInt.Conf.onAutonomousAgentsandMul-tiagentSystems(AAMAS2010),vanderHoek,Kaminka,Lespérance,LuckandSen(eds.),May,10–14,2010,Toronto,Canada,pp.XXX-XXX.Copyrightc2010,InternationalFoundationforAutonomousAgentsandMultiagentSystems(www.ifaamas.org).Allrightsreserved.GeneralTermsAlgorithms,TheoryKeywordsMachineLearning,PredictiveStateRepresentations,PlanningClosingtheLearning-PlanningLoopwithPSRsWeproposeanovelalgorithmforlearningavariantofPSRs[12]directlyfromexecutiontraces.Ouralgorithmiscloselyrelatedtosubspaceidentificationforlineardynamicalsystems(LDSs)[15]andspectralalgorithmsforHiddenMarkovModels(HMMs)[5]andreduced-rankHMMs[13].Wethenusethealgorithmtolearnamodelofasimulatedhigh-dimensional,vision-basedmobilerobotplanningtask,andcomputeapolicybyapproximatepoint-basedplanninginthelearnedmodel[6].Finally,weshowthatthelearnedstatespacecompactlycapturestheessentialfeaturesoftheenviron-ment,allowsaccurateprediction,andenablessuccessfulandeffi-cientplanning.Bycomparison,previousPOMDPlearnerssuchasExpectation-Maximization(EM)[1]donotavoidlocalminimaorscaletolargestatespaces;recentextensionsofapproximateplanningtechniquesforPSRshaveonlybeenappliedtomodelsconstructedbyhand[8,6];and,althoughmanylearningalgorithmshavebeenproposedforPSRs(e.g.[16,3])andOOMs(e.g.[10]),nonehavebeenshowntolearnmodelsthatareaccurateenoughforlookaheadplanning.Asaresult,therehavebeenfewsuccessfulattemptsatclosingtheloop.OurlearningalgorithmstartsfromPH,PT,H,andPT,ao,H,ma-tricesofprobabilitiesofone-,two-,andthree-tuplesofobserva-tionsconditionedonpresentandfutureactions.(Foradditionaldetailssee[2].)Weshowthat,foraPSRwithtrueparametersm1,m∞,andMao(theinitialstate,thenormalizationvector,andatransitionmatrixforeachaction-observationpair),thematricesPT,HandPT,ao,Harelow-rank,andcanbefactoredusingsmallermatricesoftestpredictionsRandS:PT,H=RSdiag(PH)(1a)PT,ao,H=RMaoSdiag(PH)(1b)NextweprovethatthetruePSRparametersmayberecovered,uptoalineartransform,fromtheabovematricesandanadditionalmatrixUthatobeystheconditionthatUTRisinvertible:b1≡UTPT,H1k=(UTR)m1(2a)bT∞≡PTH(UTPT,H)†=mT∞(UTR)−1(2b)Bao≡UTLearnedSubspaceValueFunctionPoliciesExecutedinLearnedSubspace−8−4048x10−3−404x10−3−8−4048x10−3−404x10−3−8−40