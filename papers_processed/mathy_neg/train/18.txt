PublishedasaconferencepaperatICLR2020THECURIOUSCASEOFNEURALTEXTDeGENERATIONAriHoltzman†‡JanBuys§†LiDu†MaxwellForbes†‡YejinChoi†‡†PaulG.AllenSchoolofComputerScience&Engineering,UniversityofWashington‡AllenInstituteforArtificialIntelligence§DepartmentofComputerScience,UniversityofCapeTown{ahai,dul2,mbforbes,yejin}@cs.washington.edu,jbuys@cs.uct.ac.zaABSTRACTDespiteconsiderableadvancesinneurallanguagemodeling,itremainsanopenquestionwhatthebestdecodingstrategyisfortextgenerationfromalanguagemodel(e.g.togenerateastory).Thecounter-intuitiveempiricalobservationisthateventhoughtheuseoflikelihoodastrainingobjectiveleadstohighqualitymodelsforabroadrangeoflanguageunderstandingtasks,maximization-baseddecodingmethodssuchasbeamsearchleadtodegeneration—outputtextthatisbland,incoherent,orgetsstuckinrepetitiveloops.ToaddressthisweproposeNucleusSampling,asimplebuteffectivemethodtodrawconsiderablyhigherqualitytextoutofneurallanguagemodelsthanPublishedasaconferencepaperatICLR2020tainedfromthemodelrelyonrandomnessinthedecodingmethod,inparticularthroughtop-ksam-plingthatsamplesthenextwordfromthetopkmostPublishedasaconferencepaperatICLR20202BACKGROUND2.1TEXTGENERATIONDECODINGSTRATEGIESAnumberofrecentworkshavealludedtothedisadvantagesofgenerationbymaximization,whichtendtogenerateoutputwithhighgrammaticalitybutlowdiversity(Kulikovetal.,2019;Holtzmanetal.,2018;Fanetal.,2018).GenerativeAdversarialNetworks(GANs)havebeenaprominentresearchdirection(Yuetal.,2017;Xuetal.,2018),butrecentworkhasshownthatPublishedasaconferencepaperatICLR2020dsfsadfdAnunprecedentednumberofmostlyyoungwhaleshavebecomestrandedontheWestAustraliancoastsince2008.PoornutritionhasledtoariseinthenumberofstrandedhumpbackwhalesontheWestAustraliancoast,veterinaryresearchershavesaid.CarlyHolyoake,fromMurdochUniversity,attheAustralianVeterinaryAssociation'sannualconferenceinPerthonWednesday,saidanunprecedentednumberofmostlyyoungwhaleshadbecomestrandedonthecoastsince2008.PublishedasaconferencepaperatICLR2020probability0.40.50.60.70.80.91Idon’tknow.Figure4:Theprobabilityofarepeatedphraseincreaseswitheachrepetition,creatingapositivefeedbackloop.Wefoundthiseffecttoholdforthevastmajorityofphraseswetested,regardlessofphraselengthorifthephrasesweresampledrandomlyratherthantakenfromhumantext.Figure5:Theprobabilitymassassignedtopartialhumansentences.FlatdistributionsPublishedasaconferencepaperatICLR2020sub-optimalacrossvaryingcontexts.AsillustratedontheleftofFigure5,insomecontextstheheadofthenextworddistributioncanbeflatacrosstensPublishedasaconferencepaperatICLR2020MethodPerplexitySelf-BLEU4ZipfCoefficientRepetition%HUSEHuman12.380.310.930.28-Greedy1.500.501.0073.66-Beam,b=161.480.440.9428.94-PublishedasaconferencepaperatICLR2020Figure7:Arank-frequencyplotofthedistributionaldifferencesbetweenn-gramfrequenciesofhumanandmachinetext.SamplingandNucleusSamplingarebyfartheclosesttoPublishedasaconferencepaperatICLR2020Figure9:Wevisualizehowoftendifferentdecodingmethodsget“stuck”inloopswithinthefirst200tokens.Aphrase(minimumlength2)isconsideredarepetitionPublishedasaconferencepaperatICLR2020decodingscheme.WeuseaKNNclassifiertocomputeHUSE,asintheoriginalpaper,withk=13neighbors,whichwefoundledtothehigherPublishedasaconferencepaperatICLR2020AngelaFan,MikeLewis,andYannDauphin.Hierarchicalneuralstorygeneration.InProceedingsofthe56thAnnualMeetingoftheAssociationforComputationalLinguistics(Volume1:LongPublishedasaconferencepaperatICLR2020TianxiaoShen,TaoLei,ReginaBarzilay,andTommiJaakkola.Styletransferfromnon-paralleltextbycross-alignment.InAdvancesinneuralinformationprocessingsystems,pp.6830–6841,2017.FelixPublishedasaconferencepaperatICLR2020ABEAMWIDTHEFFECTFigure10:ThetotalnumberoftrigramsproducedbyBeamSearchwithvaryingbeamwidths,withgold(human)dataforPublishedasaconferencepaperatICLR2020BEXAMPLEGENERATIONSWeincludeasetofexamplesforfurtherqualitativecomparison.dsfsadfdTopCustomerQuestionsSampling,t=0.9WebTextWebTextBeamSearch,b=16PureSamplingPublishedasaconferencepaperatICLR2020dsfsadfdSowhat'snewinmylife?09/11/18-Justgotbackfromvacation.IjustgotbackfromamuchneededandreallygreatninedayvacationtomyremoteArizonaproperty.Itwasareallyrestfulandrelaxingvisit.IgotalotaccomplishedwhileIwasthere,butstillfoundtimetojustgoofoffandhavefuntoo.Igottodosomeastronomy,eventhoughtheweatherwasprettycloudymostofthetime.Hereisa50minuteexposureofM101.Itturnedoutprettygood.Justgotbackfromvacation.07/12/18-HappybirthdaytoSwingu,whoisnearly5yearsold.IwouldliketosayhitohimontheroadaswellaswhenIridewithhim.Youcannotgotoworkwithoutfeelingphysicallysickorpsychologicallyexhaustedbecauseyoucanbarelybreathe.Evenifyourideonrollercoasterevenonce,itiseasytorecoverfromthephysicalsideofit.Justgotbackfromvacation.09/03/18-Aftermorethan40years,ImighthaveanapartmentinVirginiaBeach.Aftermorethan40years,ImighthaveanapartmentinVirginiaBeach.08/20/18-GoingforahikeatMountEerieinNortheastVirginiaSpringGoingforahikeatMountEerieinNortheastVirginiaSpringJustgotbackfromvacation.09/07/18-Happy9thbirthdaytome!Happy9thbirthdaytome!09/01/18-Sofwiddenalso!Sofwiddenalso!08/25/18-Happybirthdaytome!Happybirthdaytome!08/17/18-Nightshift!☐☐Nightshift!☐☐08/17/18-Luckyme!Luckyme!01/05/19-VisitedTheSubaruCanadaHeritage15thStarformyvehicleresearch.Thatwasawonderfulexperience.Thanksagainforyourknowledgeandsupport.05/23/19-IwasthrilledtoreceivemySubaruLegacycharacter!Itfitsmeperfectlyandmakesmefeellikeakidagain!06/15/19-Justregainedmylicenceformydifferentcoloured2016WRX/STI...Justgotbackfromvacation.09/10/18-Justgotbackfromvacation.Justgotbackfromvacation.09/09/18-Justgotbackfromvacation.Justgotbackfromvacation.09/08/18-Justgotbackfromvacation.Justgotbackfromvacation.Sampling,t=0.9WebTextWebTextBeamSearch,b=16PureSamplingTop-k,k=640Top-k,k=640,t=0.7Justgotbackfromvacation.09/08/18-I'vegottenreallysick.-I'vegottenreallysick.09/07/18-MywifeandIaregettingmarriedinFebruary.-MywifeandIaregettingmarriedinFebruary.09/06/18-I'msoexcitedtogobacktocollegethisfall.-I'msoexcitedtogobacktocollegethisPublishedasaconferencepaperatICLR2020dsfsadfdUniversityofWisconsin—MadisonInlate1998,aUW-MadisongroupledbyJamesThomsonwasthefirsttoisolateandculturehumanembryonicstemcells,masterundifferentiatedcellsthatariseattheearlieststagesofdevelopmentandarecapableofbecominganyofthe220typesofcellsandtissuesinthehumanbody.ThomasJefferson,1777—1826WhoIsMikeBarnacle?Well,atthestart,thiswasclearlyaprojectdesignedtohelppeoplegetthegistofclassicartinitsmyriadways.Nowwefindourselveswithaninterestingsetofrecordingsof200BC.Whoaretheseguys?Thisone,apparently,arethedescendantsofGreekhistorianEuclid.Hefamouslyanalyzedstraightlinessoweknowthosearestraight.ColoradoStateUniversityDenverClaremontMcKennaCollegeMerrimackCollegeNewEnglandInstituteofTechnologyUConnSchoolofMedicineWisconsinSchoolofEngineeringUniversityofWisconsin—MilwaukeeUniversityofWisconsin—OshkoshUniversityofWisconsin—RacineUniversityofWisconsin—RedWingUniversityofWisconsin—StevensPointUniversityofWisconsin—StevensPointJonathanHedbergDepartmentofComparativeandAppliedEconomicsUniversityofCalifornia—BerkeleyMichaelAmanteDepartmentofEconomicsMentalHealth4240NewFlorenceRd,Henderson,WI54711(262)-335-7453MentalHealth@uiowa.eduUniversityofWisconsinMadison(atUWCampus)UniversityofWisconsin—MadisonUniversityofWisconsin—MilwaukeeUniversityofWisconsin—OshkoshSampling,t=0.9WebTextWebTextBeamSearch,b=16PureSamplingTop-k,k=640Top-k,k=40,t=0.7Nucleus,p=0.95Figure13:Moreexamplegenerationsfromaninitialtagline.Allgenerationsavailableathttps://github.com/ari-holtzman/degen16