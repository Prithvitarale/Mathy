BabyTalk:UnderstandingandGeneratingSimpleImageDescriptionsGirishKulkarniVisruthPremrajSagnikDharSimingLiYejinChoiAlexanderCBergTamaraLBergStonyBrookUniversityStonyBrookUniversity,NY11794,USA{tlberg}@cs.stonybrook.eduAbstractInput	  Image	  1)	  Object(s)/Stuﬀ	  2)	  A8ributes	  3)	  Preposi>ons	  brown	  0.32	  striped	  0.09	  furry	  .04	  wooden	  .2	  Feathered	  .04	  	  	  	  	  	  	  	  	  ...	  brown	  0.94	  striped	  0.10	  furry	  .06	  wooden	  .8	  Feathered	  .08	  	  	  	  	  	  	  	  	  ...	  brown	  0.01	  striped	  0.16	  furry	  .26	  wooden	  .2	  feathered	  .06	  	  	  	  	  Obj1	  Obj2	  Prep1	  A,r1	  Stuﬀ1	  A,r2	  A,r3	  Prep2	  Prep3	  Obj1	  Obj2	  Prep1	  A,r1	  Stuﬀ1	  A,r2	  A,r3	  Prep2	  Prep3	  Z3	  Z2	  Z1	  Figure3.CRFforanexampleimagewith2objectdetectionsand1stufftheamountoflabeledimagedatathatwouldberequiredisdaunting.Insteadwelearnthesefromlargetextcollec-tions.Byobservingintexthowpeopledescribeobjects,attributesandprepositionsbetweenobjectsweThis	  is	  a	  photograph	  of	  one	  sky,	  one	  road	  and	  one	  bus.	  The	  blue	  sky	  is	  above	  the	  gray	  road.	  The	  gray	  road	  is	  near	  the	  shiny	  bus.	  The	  shiny	  bus	  is	  near	  the	  blue	  sky.	  	  There	  are	  two	  aeroplanes.	  The	  ﬁrst	  shiny	  aeroplane	  is	  near	  the	  second	  shiny	  aeroplane.	  	  There	  are	  one	  cow	  and	  one	  sky.	  The	  golden	  cow	  is	  by	  the	  blue	  sky.	  	  This	  is	  a	  picture	  of	  one	  sky,	  one	  road	  and	  one	  sheep.	  The	  gray	  sky	  is	  over	  the	  gray	  road.	  The	  gray	  sheep	  is	  by	  the	  gray	  road.	  	  Here	  we	  see	  two	  persons,	  one	  sky	  and	  one	  aeroplane.	  The	  ﬁrst	  black	  person	  is	  by	  the	  blue	  sky.	  The	  blue	  sky	  is	  near	  the	  shiny	  aeroplane.	  The	  second	  black	  person	  is	  by	  the	  blue	  sky.	  The	  shiny	  aeroplane	  is	  by	  the	  ﬁrst	  black	  person,	  and	  by	  the	  second	  black	  person.	  	  There	  are	  one	  dining	  table,	  one	  chair	  and	  two	  windows.	  The	  wooden	  dining	  table	  is	  by	  the	  wooden	  chair,	  and	  against	  the	  ﬁrst	  window,	  and	  against	  the	  second	  white	  window.	  The	  wooden	  Templated	  Genera-on:	  This	  is	  a	  photograph	  of	  one	  furry	  sheep.	  Simple	  Decoding:	  the	  furry	  sheep	  it.	  Templated	  Genera-on:	  Here	  Here	  we	  see	  one	  po*edplant.	  	  Missing	  detec+ons:	  This	  is	  a	  picture	  of	  one	  dog.	  	  This	  is	  a	  photograph	  of	  two	  sheeps	  and	  one	  grass.	  The	  ﬁrst	  black	  sheep	  is	  by	  the	  green	  grass,	  and	  by	  the	  second	  black	  sheep.	  The	  second	  black	  sheep	  is	  by	  the	  green	  grass.	  	  Incorrect	  a1ributes:	  This	  is	  a	  photograph	  of	  two	  horses	  and	  one	  grass.	  The	  ﬁrst	  feathered	  horse	  is	  within	  the	  green	  grass,	  and	  by	  the	  second	  feathered	  horse.	  The	  second	  feathered	  horse	  is	  within	  the	  green	  grass.	  	  There	  are	  two	  cows	  and	  one	  person.	  The	  ﬁrst	  brown	  cow	  is	  against	  the	  brown	  person,	  and	  near	  the	  second	  cow.	  The	  brown	  person	  is	  beside	  the	  second	  cow.	  	  Coun+ng	  is	  hard!	  This	  is	  a	  picture	  of	  four	  persons.	  The	  ﬁrst	  colorful	  person	  is	  by	  the	  second	  pink	  person,	  and	  by	  the	  third	  colorful	  person.	  The	  second	  pink	  person	  is	  by	  the	  third	  colorful	  person,	  and	  by	  the	  fourth	  person.	  	  Incorrect	  detec+ons:	  There	  are	  one	  road	  and	  one	  cat.	  The	  furry	  road	  is	  in	  the	  furry	  cat.	  	  This	  is	  a	  picture	  of	  one	  tree,	  one	  road	  and	  one	  person.	  The	  rusty	  tree	  is	  under	  the	  red	  road.	  The	  colorful	  person	  is	  near	  the	  rusty	  tree,	  and	  under	  the	  red	  road.	  	  Just	  all	  wrong!	  There	  are	  one	  po*ed	  plant,	  one	  tree,	  one	  dog	  and	  one	  road.	  The	  gray	  po*ed	  plant	  is	  beneath	  the	  tree.	  The	  tree	  is	  near	  the	  black	  dog.	  The	  road	  is	  near	  the	  black	  dog.	  The	  black	  dog	  is	  near	  the	  gray	  po*ed	  plant.	  	  This	  is	  a	  photograph	  of	  one	  person	  and	  one	  sky.	  The	  white	  person	  is	  by	  the	  blue	  sky.	  	  Figure6.Resultsofsentencegenerationusingourmethodwithtemplatebasedsentencegeneration.Theseare“bad”resultsasjudgedbyhumanannotators.Methodw/ow/synonymHuman0.500.51Languagemodel-basedgeneration0.250.30Template-basedgeneration0.150.18Meaningrepresentation(triples)0.200.30Table1.AutomaticEvaluation:BLEUscoremeasuredat1AutomaticEvaluation:BLEU[20]isawidelyusedmetricforautomaticevaluationofmachinetranslationthatmea-suresthen-gramprecisionofmachinegeneratedsentenceswithrespecttohumangeneratedsentences.Becauseourtaskcanbeviewedasmachinetranslationfromimagestotext,BLEUmayseemlikeareasonablechoiceatfirstglance.Uponacloselookhowever,onecanseethatthereisinherentlylargervariabilityingeneratingsentencesfromimagesthantranslatingasentencefromonelanguagetoan-other.Forinstance,fromtheimageshowninFigure1,oursystemcorrectlyrecognizesobjectssuchas“chair”,“greengrass”,“pottedplant”,noneofwhichismentionedinthehumangenerateddescriptionavailableintheUIUCPAS-CALsentencedataset.Asaresult,BLEUwillinevitablypenalizemanycorrectlygeneratedsentences.Nevertheless,wereportBLEUscoreasastandardevaluationmethod,andquantifyitsshortcomingsforfutureresearch.ThefirstcolumninTable1showsBLEUscorewhenmeasuredwithexactmatchforeachword,andthesecondshowsBLEUwhenwegivefullcreditsforsynonyms.Forcontext,wealsocomputetheBLEUscorebetweenhuman-generatedsentences;weaveragetheBLEUscorebetweeneachhuman-generatedsentencetothesetofothersoverallimages.Finally,wecomputeBLEUscoreoftheCRFout-putswithrespecttothehuman-generatedsentences.HumanEvaluation:EvaluationbyBLEUscorefacilitatesefficientcomparisonsamongdifferentapproaches,butdoesMethodScoreQualityofimageparsing2.85Languagemodel-basedgeneration2.77Template-basedgeneration3.49Table2.HumanEvaluation:possiblescoresare4(perfectwithouterror),3(goodwithsomeerrors),2(manyerrors),1(failure)Methodk=1k=2k=3k=4+Qualityofimageparsing2.902.782.823.33Languagemodel-based2.273.002.762.95Template-basedgeneration3.833.503.433.61Table3.HumanEvaluation:kreferstothenumberofobjectsdetectedbyCRF.Possiblescoresare4(perfectwithouterror),3(goodwithsomeerrors),2(manyerrors),1(failure)notmeasurevisionoutputqualitydirectly,andisoblivioustocorrectnessofgrammarordiscoursequality(coherencyacrosssentences).Todirectlyquantifytheseaspects,weperformhumanjudgmentontheentiretestset.TheresultsareshowninTable2and3,wheretheimageparsingscoreevaluateshowwellwedescribeimagecontent(thetriplesoutputbytheCRF),andtheothertwoscoresevaluatetheoverallsentencequality.Overallourtemplategenerationmethoddemonstratesaveryhighaveragehumanevaluationscoreof3.49(max4)forthequalityofgeneratedsentences.Wealsodowellatpredictingimagecontent(ave2.85).NotethathumanjudgmentofthegenerationqualitydoesnotcorrelatewithBLEUscore.PerBLEU,itlooksasthoughlanguage-modelgenerationperformsbetterthantemplate-basedone,buthumanjudgmentrevealstheop-positeistrue.ThePearson’scorrelationcoefficientbe-tweenBLEUandhumanevaluationareis-0.17and0.05forlanguagemodelandtemplate-basedmethodsrespectively.Wealsomeasurehumanannotationagreementon160in-stances.Thescoresgiven7.1.QualitativeResultsThemajorityofourgeneratedsentenceslookquitegood.ExampleresultsonPASCALimagesratedas“good”areshowninfig4.Infactmostofourresultslookquitegood.Even“bad”resultsalmostalwayslookreasonableandarerelevanttotheimagecontent(fig6).Onlyforasmallminor-ityoftheimagesarethegenerateddescriptionscompletelyunrelatedtotheimagecontent(fig6,2rightmostimages).Incaseswherethegeneratedsentenceisnotquiteperfectthisisusuallyduetooneofthreeproblems:afailedobjectdetectionthatmissesanobject,adetectionthatproposesthewrongobjectcategory,oranincorrectattributeprediction.However,becauseofouruseofpowerfulvisionsystems(stateoftheartdetectorsandattributemethodologies)theresultsproducedareoftenastonishinglygood.7.2.ConclusionWehavedemonstratedasurprisinglyeffective,fullyau-tomatic,systemthatgeneratesnaturallanguagedescriptionsforimages.Thesystemworkswellandcanproduceresultsmuchmorespecifictotheimagecontentthanpreviousau-tomatedmethods.Humanevaluationvalidatesthequalityofthegeneratedsentences.Onekeytothesuccessofoursystemwasautomaticallyminingandparsinglargetextcol-lectionstoobtainstatisticalmodelsforvisuallydescriptivelanguage.TheotheristakingadvantageofstateoftheartvisionsystemsandcombiningalloftheseinaCRFtopro-duceinputforlanguagegenerationmethods.AcknowledgementsThisworksupportedinpartbyNSFFacultyEarlyCareerDevelopment(CAREER)Award#1054133.References[1]A.AkerandR.Gaizauskas.Generatingimagedescriptionsusingdependencyrelationalpatterns.InPr.ACL,pages1250–1258,2010.1601[2]K.Barnard,P.Duygulu,N.deFreitas,D.Forsyth,D.Blei,andM.Jordan.Matchingwordsandpictures.JMLR,3:1107–1135,2003.1602[3]T.Brants,A.C.Popat,P.Xu,F.J.Och,andJ.Dean.Largelanguagemodelsinmachinetranslation.InEMNLP-CoNLL,2007.1602[4]S.Channarukul,S.W.McRoy,andS.S.Ali.Doghed:atemplate-basedgeneratorformultimodaldialogsystemstar-getingheterogeneousdevices.InNAACL,2003.1602[5]M.-C.deMarneeandC.D.Manning.Stanfordtypeddepen-denciesmanual.1605[6]J.Deng,W.Dong,R.Socher,L.-J.Li,K.Li,andL.Fei-Fei.ImageNet:ALarge-ScaleHierarchicalImageDatabase.InCVPR,2009.1604,1605[7]C.Desai,D.Ramanan,andC.Fowlkes.Discriminativemod-elsformulti-classobjectlayout.InICCV,2009.1602[8]P.Duygulu,K.Barnard,N.deFreitas,andD.Forsyth.Objectrecognitionasmachinetranslation.InECCV,2002.1602[9]A.Farhadi,I.Endres,D.Hoiem,andD.A.Forsyth.Describ-ingobjectsbytheirattributes.InCVPR,2009.1602,1604,1605[10]A.Farhadi,M.Hejrati,A.Sadeghi,P.Young,C.Rashtchian,J.Hockenmaier,andD.A.Forsyth.Everypicturetellsastory:generatingsentencesforimages.InECCV,2010.1602[11]L.Fei-Fei,C.Koch,A.Iyer,andP.Perona.Whatdoweseewhenweglanceatascene.JournalofVision,4(8),2004.1601[12]P.F.Felzenszwalb,R.B.Girshick,andD.McAllester.Discriminativelytraineddeformablepartmodels,release4.http://people.cs.uchicago.edu/pff/latent-release4/.1604[13]Y.FengandM.Lapata.Howmanywordsisapictureworth?automaticcaptiongenerationfornewsimages.InPr.ACL,ACL’10,pages1239–1249,2010.1601,1602[14]V.FerrariandA.Zisserman.Learningvisualattributes.InNIPS,2007.1602[15]C.Galleguillos,A.Rabinovich,andS.J.Belongie.Objectcategorizationusingco-occurrence,locationandappearance.InCVPR,2008.1602[16]A.GuptaandL.S.Davis.Beyondnouns:Exploitingprepo-sitionsandcomparativeadjectivesforlearningvisualclassi-fiers.In