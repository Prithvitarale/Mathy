WhittleSearch:ImageSearchwithRelativeAttributeFeedbackAdrianaKovashka1DeviParikh2KristenGrauman11UniversityofTexasatAustin2ToyotaTechnologicalInstituteChicago(TTIC)1{adriana,grauman}@cs.utexas.edu2dparikh@ttic.eduAbstractWeproposeanovelmodeoffeedbackforimagesearch,whereauserdescribeswhichpropertiesofexemplarimagesshouldbeadjustedinordertomorecloselymatchhis/hermentalmodeloftheimage(s)sought.Forexample,perus-ingimageresultsforaquery“blackshoes”,theusermightstate,“Showmeshoeimageslikethese,butsportier.”Of-fline,ourapproachfirstlearnsasetofrankingfunctions,eachofwhichpredictstherelativestrengthofanameableattributeinanimage(‘sportiness’,‘furriness’,etc.).Atquerytime,thesystempresentsaninitialsetofreferenceimages,andtheuserselectsamongthemtoproviderela-tiveattributefeedback.Usingtheresultingconstraintsinthemulti-dimensionalattributespace,ourmethodupdatesitsrelevancefunctionandre-ranksthepoolofimages.Thisprocedureiteratesusingtheaccumulatedconstraintsuntilthetoprankedimagesareacceptablyclosetotheuser’sen-visionedtarget.Inthisway,ourapproachallowsausertoefficiently“whittleaway”irrelevantportionsofthevisualfeaturespace,usingsemanticlanguagetopreciselycom-municateherpreferencestothesystem.Wedemonstratethetechniqueforrefiningimagesearchforpeople,products,andscenes,andshowitoutperformstraditionalbinaryrel-evancefeedbackintermsofsearchspeedandaccuracy.1.IntroductionImagesearchentailsretrievingthoseimagesinacollec-tionthatmeetauser’sneeds,whetherusingtheusermightstate:“Iwantshoeslikethese,butmorefor-mal.”Whenbrowsingimagesofpotentialdatesonadatingwebsite,hecansay:“Iaminterestedinsomeonewholookslikethis,butwithlongerhairandmoresmiling.”Whensearchingforstockphotostofitanad,hemightsay:“Ineedascenesimilarlybrightasthisoneandmoreurbanthanthatone.”SeeFig.1.Inthisway,ratherthansimplystatewhichimagesare(ir)relevant,theuseremployssemantictermstosayhowtheyareso.Weexpectsuchfeedbackwillenablethesystemtomorecloselymatchtheuser’smentalmodelofthedesiredcontent,andwithlesstotalinteractioneffort.Briefly,theapproachworksasfollows.Offline,wefirstlearnasetofrankingfunctions,eachofwhichpredictstherelativestrengthofanameableattributeinanimage(e.g.,thedegreeof‘shininess’,‘furriness’,etc.).Atquerytime,thesystempresentsaninitialsetofreferenceim-ages,andtheuserselectsamongthemtoproviderelativeattributefeedback.Usingtheresultingconstraintsinthemulti-dimensionalattributespace,weupdatethesystem’srelevancefunction,re-rankthepoolofimages,anddisplaythetop-rankedsettotheuser.Thisprocedureiteratesusingtheaccumulatedconstraintsuntilthetoprankedimagesareacceptablyclosetotheuser’starget.WecalltheapproachWhittleSearch,sinceitallowsusersto“whittleaway”irrel-evantportionsofthevisualfeaturespaceviaprecise,intu-itivestatementsoftheirattributepreferences.WedemonstrateWhittleSearchforretrievaltaskswithpeople,product,Throughout,letP={I1,...,IN}refertothepoolofNdatabaseimagesthatarerankedbythesystemusingitscurrentscoringfunctionSt:I→R,wheretdenotestheiterationofrefinement.Thescoringfunctionistrainedus-ingallaccumulatedfeedbackfromiterations1,...,t−1,anditsuppliesanordering(possiblypartial)ontheimagesinP.Ateachiteration,thetopK<NrankedimagesTt={It1,...,ItK}⊆Paredisplayedtotheuserforfur-therfeedback,whereSt(It1)≥St(It2)≥···≥St(ItK).AuserthengivesfeedbackofhischoosingonanyoralloftheKrefinedresultsinTt.WerefertoTtinterchangeablyasthereferencesetortop-rankedset.Inthefollowing,wefirstdescribeatraditionalbinaryrelevancefeedbackmodel(Sec.3.1),sinceitwillserveasastrongbaselinetowhichtocompareourapproach.Thenweintroducetheproposednewmodeofrelativeattributefeed-back(Sec.3.2).Finally,weextendtheideatoaccommodatebothformsofinputinahybridapproach(Sec.3.3).3.1.Background:BinaryRelevanceFeedbackInabinaryrelevancefeedbackmodel,theuseridentifiesasetofrelevantimagesRandasetofirrelevantimagesR̄amongthecurrentreferencesetTt.Inthiscase,thescoringfunctionSbtisaclassifier(orsomeotherstatisticalmodel),andthebinaryfeedbackessentiallysuppliesadditionalpos-marginbetweentheranksassignedtotheclosestpairoftraininginstances,and(2)slackvariablesξij,γijontheconstraints,yieldingthefollowingobjective[9]:minimize12||wTEachoftheabovecarvesoutarelevantregionoftheM-dimensionalattributefeaturespace,whittlingawayim-agesnotmeetingtheuser’srequirements.WecombineallsuchconstraintstoadaptthescoringfunctionWeusetwometrics:(1)theultimaterankassignedtotheuser’stargetimageand(2)thecorrelationbetweenthefullrankingcomputedbyStandagroundtruthrankingthatreflectstheperceivedDataset-MethodNearFarNear+FarMidShoes-Attribute.39.29.40.38Shoes-Binary.12.05.27.06PubFig-Attributes.60.41.58.52PubFig-Binary.39.21.64.15OSR-Attributes.53.27.52.40OSR-Binary.18.18.32.11DissimilarfromMorebrightincolorthanLessopenthanQuery:“Iwantanon-openshoethatislongonthelegandcoveredinornaments.”MatchRound1Round2SimilartoSelectedfeedback