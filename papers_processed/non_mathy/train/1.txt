MachineTeachingANewParadigmforBuildingMachineLearningSystemsPatriceY.Simardpatrice@microsoft.comSaleemaAmershisamershi@microsoft.comDavidM.Chickeringdmax@microsoft.comAliciaEdelmanPeltonaliciaep@microsoft.comSoroushGhorashisorgh@microsoft.comChristopherMeekmeek@microsoft.comGonzaloRamosgoramos@microsoft.comJinaSuhjinsuh@microsoft.comJohanVerweyjoverwey@microsoft.comMoWangmowan@microsoft.comJohnWernsingjohnwer@microsoft.comMicrosoftResearch,OneMicrosoftWay,Redmond,WA98052,USAAbstractThecurrentprocessesforbuildingmachinelearningsystemsrequirepractitionerswithdeepknowledgeofmachinelearning.ThissignificantlylimitsthenumberofmachinelearningsystemsMachineTeachingproductivity,interpretability,robustness,andscalingwiththecomplexityoftheproblemorthenumberofcontributors.Manyproblemsthataffectmodelbuildingproductiv-ityarenotaddressedbytraditionalmachinelearning.OnesuchMachineTeaching6.Ifthesystemdoesnotperformwellontesttraffic,GOTOstep17.Themodelisdeployedonfulltraffic.Performanceofthemodelismonitored,andifthatperformancegoesbelowacriticallevel,themodelismodifiedbyreturningtostep1.Aniterationthroughsteps1to6typicallytakesweeks.Thesystemcanbestableatstep7formonths.Wheniteventuallybreaks,itcanbeforavarietyofreasons:theMachineTeachingdifferentruntimefunctions,dependingonwhatre-sourcesareavailable(e.g.,DSPs,GPUs,FPGAs,tightmemoryorCPUconstraints)orwhathasbeenimple-mentedandgreen-lightedfordeployment.MachinelearningalgorithmscanMachineTeachingTable1.ComparisonofdebuggingstepsinprogrammingandmachineteachingDebugginginprogrammingDebugginginmachineteaching(3)Repeat:(3)Repeat:(a)Inspect(a)Inspect(b)Editcode(b)Edit/addknowledge(e.g.,labels,features,...)(c)Compile(c)Train(d)Test(d)TestPython,JavaScript,etc.whichcanbecompiledintomachinelanguageforexecution.Forteaching,thelan-guageisameansofexpressingteacherknowledgeintoaformthatamachinelearningalgorithmcanleveragefortraining.Teacherknowledgedoesnotneedtobelimitedtoprovidinglabelsbutcanbeacombinationofschemaconstraints(e.g.,mutuallyexclusivelabelsforclassification,statetransitionconstraintsinentityextraction1),labeledexamples,andfeatures.JustasnewprograminglanguagesarebeingdevelopedMachineTeachingproblem:1.Canyouteachamachinetorecognizekitchenutensilsinanimageaswellasyoudo?2.Canyoudoitinamonth?WhenthesequestionswereaskedtoMachineTeachingformodels,features,labels,andschemasenablescom-posingtheseconstituentpartstosolvemorecomplexproblems,andthus,allowingfortheiruseinproblemdecomposition.ThefinaldevelopmentthatenablesscalingwithMachineTeachingTable2.MappingbetweenprogrammingandmachineteachingProgrammingMachineteachingCompilerMLAlgorithms(NeuralNetworks,SVMs)OperatingSystem/Services/IDEsTraining,Sampling,FeaturingServices,etc.FrameworksImageNet,word2vec,etc.ProgrammingLanguages(Fortran,Python,C#)Labels,Features,Schemas,etc.ProgrammingExpertiseTeachingExpertiseVersionControlVersionControlDevelopmentProcesses(specifications,unittesting,deployment,monitoring,etc.)TeachingProcesses(datacollection,testing,publishing,etc.)assignseachexampleascalarvalue.Weusuallyusefeaturetodenoteaconceptwhenem-phasizingitsuseinamachinelearningmodel.Forexample,theconceptcorrespondingtothepresenceorabsenceoftheword“recipe”intextexamplesmightbeausefulfeaturewhenteachingtherecipeconcept.Definition4.3(Teacher)Ateacheristhepersonwhotransfersconceptknowledgetoalearningma-chine.Toclarifythisdefinitionofateacher,themethodsofknowledgetransferneedtobedefined.Atthispoint,theyincludea)exampleselection(biased),b)label-ing,c)schemadefinition(relationshipbetweenlabels),d)featuring,ande)conceptdecomposition(wherefeaturesarerecursivelydefinedassub-models).Theteachersareexpectedtomakemistakesinalltheformsofknowledgetransfer.Theseteaching“bugs”arecom-monoccurrences.Figure1illustrateshowconcepts,labels,features,andteachersarerelated.Weassumethateveryconceptisacomputablefunctionofarepresentationofexamples.Therepresentationisassumedtoincludeallavailableinformationabouteachexample.Thehorizontalaxisrepresentsthe(infinite)spaceofexamples.Theverti-calaxisrepresentsthe(infinite)spaceofprogramsorconcepts.Incomputersciencetheory,programsandexamplescanberepresentedas(long)integers.Us-ingthatconvention,eachintegernumberonthever-ticalaxiscouldbeinterpretedasaprogram,andeachintegernumberonthehorizontalaxiscouldbeinter-pretedasanexample.Weignoretheprogramsthatdonotcompileandtheexamplesthatarenonsensical.WenowuseFigure1torefertothedifferentwaysateachercanpassinformationtoalearningsystem.Definition4.4(Selection)Selectionistheprocessbywhichteachersgainaccesstoanexamplethatex-emplifiesusefulaspectsofaconcept.Teacherscanselectspecificexamplesbyfilteringthesetofunlabeledexamples.Bychoosingthesefil-tersdeliberately,theycansystematicallyexplorethespaceanddiscoverinformationrelevanttoconcepts.Forexample,ateachermaydiscoverinsectrecipeswhilebuildingarecipeclassifierbyissuingaqueryon“sourceofproteins”.Wenotethatuniformsamplinganduncertaintysampling,whichhavenoexplicitinputfromateacher,arelikelyoflittleusefordiscoveringrareclustersofpositiveexamples.Combinationsofse-manticfiltersinvolvingtrainedmodelsareevenmorepowerful(e.g.,“nutritionproteins”andlowscorewithcurrentclassifier).Thisabilitytofindexamplescon-tainingusefulaspectsofaconceptenablestheteachertofindusefulfeaturesandprovidethelabelstotrainthem.Furthermore,theselectionchoicesthemselvescanbevaluabledocumentationoftheteachingpro-cess.Definition4.5(Label)Alabelisa(example,con-ceptvalue)paircreatedbyMachineTeachingFigure1.Representationofexamplesandconcepts.Eachcolumnrepresentsanexampleandcontainsallconceptvaluesforthatexample.Ateacherlooksinthatdirectionto“divine”alabel.TheteacherhasMachineTeachingeventhoughthelatterfeaturemightyieldbetterre-sultsonthetrainingset.Thisabilitytoestimatethevalueofafeatureoverestimateddistributionsofthetestsetisessentialtofeatureengineering,andisprob-ablythemostusefulcapabilityofateacher.Featuresselectedbytheteacherinthismannerareimmunetoover-trainingbecausetheyarecreatedindependentlyofthetrainingset.Notethecontrastto“automaticfeatureselection”,whichonlylooksattheMachineTeachingsonal,shared,“one-off”andrecurrentproblemsatascalethatwehaveneverseen.5.TeachingprocessAteachingorprogramminglanguagecanbeappliedinmanydifferentways,somemoreeffectivethanothers.Weproposethefollowingprinciplesforthelanguageandprocessofmachineteaching:UniversalteachinglanguageWedonotrelyonthepowerofspecificmachinelearningalgorithms.Theteachinginterfaceisthesameforallalgorithms.IfamachinelearningalgorithmisswappedforMachineTeachingTable3.WheretofindmachineteachersPotentialteacherQuantitiesCharacteristicsMachinelearningexpertsTensofthousandsHasprofoundunderstandingofmachinelearning.CanmodifyamachinelearningalgorithmorarchitecturetoimproveMachineTeachingrepeatwhiletrainingsetisrealizabledoifqualitycriteriaismetthenexitend//Activelyandsemanticallyexploresamplingsetusingconceptbasedfilters.Findatesterror(i.e.,anincorrectlyMachineTeachingparallelyieldsawealthofbenefits.Thispapertakesinspirationfromthreelessonsfromthehistoryofpro-gramming.Thefirstoneisproblemdecompositionandmodularity.Theyhaveallowedprogrammingtoscalewithcomplexity.Wearguethatasimilarapproachhasthesamebenefitsformachineteaching.Thesec-ondlessonisthestandardizationofprogramminglan-guages:writeonce,runeverywhere.Thispaperisnotproposingastandardmachineteachinglanguage,butweenumeratedthemostimportantmachine-learning-agnosticknowledgechannelsavailabletotheteacher.Thefinallessonistheprocessdiscipline,whichin-cludesseparationofconcernsandthebuildingofstan-dardtoolsandlibraries.Thisaddressesthesamelimi-tationstoproductivityandscalingwiththenumberofcontributorsthatplaguedprogramming(asdescribedinthe”MythicalManMonth”(BrooksJr,1995)).Wehaveproposedasetofprinciplesthatleadtoabetterteachingprocessdiscipline.Someofthetoolsofpro-gramming,suchasversioncontrol,canbeusedasis.SomeoftheseprincipleshavebeensuccessfullyappliedinservicessuchasLUIS.aiandbyproductgroupsin-sideMicrosoftsuchasBingLocal.Weareintheearlystagesofbuildingateachinginteractivedevelopmentenvironment.Onamorephilosophicalnote,largemonolithicsys-tems,asepitomizedbydeeplearning,areapopulartrendinartificialintelligence.Weseethisasaformofmachinelearningbehaviorism.Itistheideathatcom-plexconceptscanbelearnedfromalargesetof(in-put,output)pairs.Withtheaidofregularizersand/ordeeprepresentationscomputedusingunsupervisedorsemi-supervisedlearning,themonolithiclearningap-proachhasyieldedimpressiveresults.Thishasbeenthecaseinseveralfieldswherelabeleddataisabun-dant(speech,vision,machinetranslation).Themono-lithicapproach,however,haslimitationswhenlabeleddataishardtocomeby.Deeprepresentationsbuiltfromunlabeleddataoptimizewherethedatais.Raremisspellingsthataredomainspecificarelikelytobeig-noredormisinterpretediftheyappearmorefrequentlyinadifferentdomaincontext.Cornercaseswithlittleornolabelsforautonomous-drivingmaybeignoredatgreatperils.Large(amorphic)modelsarehardtointerpret.Theselimitationscanbeovercomebyin-jectingsemanticknowledgeviaactiveteaching(e.g.,labels,features,structure).Forthisreason,webelievethatbothlargemonolithicsystemsandsystemsmoreactivelysupervisedbyteachinghaveimportantrolestoplayinmachinelearning.Asabonus,theycaneasilybecombinedtocomplementeachother.7.AcknowledgementsWethankJasonWilliamsforhissupportandcontri-butionstoMachineTeaching.JasonisthecreatoroftheLUIS(LanguageUnderstandingInternetSer-vices)project,aserviceforbuildinglanguageunder-standingmodels,basedontheprinciplesmentionedinthispaper.WethankRihamMansourandtheMicrosoftCairoteamforco-building,maintaining,andimprovingthewww.LUIS.aiservice.Finally,wethankMatthewHurstandhisteamforbuildinghigh-performingwebpageentityextractorsleveragingourmachineteachingtools.TheseentityextractorsaredeployedinBingLocal.ReferencesYoshuaBengio,JérômeLouradour,RonanCollobert,andJasonWeston.2009.CurriculumLearning.InProceedingsofthe26thAnnualInternationalCon-ferenceonMachineLearning(ICML’09).ACM,NewYork,NY,USA,41–48.https://doi.org/10.1145/1553374.1553380FrederickPBrooksJr.1995.TheMythicalMan-Month:EssaysonSoftwareEngineering,Anniver-saryEdition,2/E.PearsonEducationIndia.AndrewCarlson,JustinBetteridge,BryanKisiel,BurrSettles,EstevamR.Hruschka,Jr.,andTomM.Mitchell.2010.TowardanArchitec-tureforNever-endingLanguageLearning.InPro-ceedingsoftheTwenty-FourthAAAIConferenceonArtificialIntelligence(AAAI’10).AAAIPress,1306–1313.http://dl.acm.org/citation.cfm?id=2898607.2898816ToddKulesza,SaleemaAmershi,RichCaruana,DanyelFisher,andDenisCharles.2014.Structuredlabelingforfacilitatingconceptevolutioninmachinelearning.InProceedingsoftheSIGCHIConferenceonHumanFactorsinComputingSystems.ACM,3075–3084.D.Sculley,GaryHolt,DanielGolovin,EugeneDavy-dov,ToddPhillips,DietmarEbner,VinayChaud-hary,andMichaelYoung.2014.MachineLearning:TheHighInterestCreditCardofTechnicalDebt.InSE4ML:SoftwareEngineeringforMachineLearn-ing(NIPS2014Workshop).VladimirVapnik.2013.TheNatureofStatisticalLearningTheory.